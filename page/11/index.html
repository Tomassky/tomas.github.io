<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta property="og:type" content="website">
<meta property="og:title" content="Tomas&#39;Blog">
<meta property="og:url" content="http:&#x2F;&#x2F;yoursite.com&#x2F;page&#x2F;11&#x2F;index.html">
<meta property="og:site_name" content="Tomas&#39;Blog">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/11/"/>





  <title>Tomas'Blog</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Tomas'Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/12/10/Kali%20Linux%E7%AC%94%E8%AE%B0(%E5%8D%81%E4%BA%94)%EF%BC%9A%E4%B8%BB%E6%9C%BA%E5%8F%91%E7%8E%B0--%E4%B8%89%E5%B1%82%E5%8F%91%E7%8E%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Tomas">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/photo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tomas'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/12/10/Kali%20Linux%E7%AC%94%E8%AE%B0(%E5%8D%81%E4%BA%94)%EF%BC%9A%E4%B8%BB%E6%9C%BA%E5%8F%91%E7%8E%B0--%E4%B8%89%E5%B1%82%E5%8F%91%E7%8E%B0/" itemprop="url">Kali Linux笔记(十五)：主机发现--三层发现</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-12-10T08:13:38+08:00">
                2019-12-10
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Kali/" itemprop="url" rel="index">
                    <span itemprop="name">Kali</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  880 字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  4 分钟
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <hr>
<h4 id="1-发现-三层发现（ping）"><a href="#1-发现-三层发现（ping）" class="headerlink" title="1. 发现-三层发现（ping）"></a>1. 发现-三层发现（ping）</h4><ul>
<li>优点<ul>
<li>可路由</li>
<li>速度比较快</li>
</ul>
</li>
<li>缺点<ul>
<li>速度比二层慢</li>
<li>经常被边界防火墙过滤（目标系统的过滤机制）</li>
</ul>
</li>
<li>IP、ICMP协议</li>
</ul>
<blockquote>
<pre><code>ICMP协议，网络控制管理协议，路径发现，探测，根据相应结果来反应目标主机的状态
ICMP协议，发送端的报文类型是询问报文，Type字段为8，接收端为0
网络上默认禁止ICMP的探测数据包，所以导致扫描结果不准确，存在误报，漏报，错报</code></pre></blockquote>
<ul>
<li><strong><code>🔺命令：Ping IP地址 -c 2</code></strong></li>
<li><strong><code>🔺命令：Ping -R（路由追踪） IP地址 / traceroute IP地址</code></strong></li>
<li><strong><code>🔺命令：ping  IP地址 -c 1 | grep &quot;bytes from&quot; | awk &#39;{print $4}&#39;</code></strong></li>
<li>脚本<ul>
<li><strong><code>🔺命令：./pinger.sh IP网段</code></strong>  ▲2019.12.2 iplist文档中ip地址后面有：，还无法去除</li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line">if [ &quot;$#&quot; -ne 1 ];then</span><br><span class="line">    echo &quot;Usage - ./pinger.sh [/24 network address]&quot;</span><br><span class="line">    echo &quot;Example - ./pinger.sh 192.168.100.0&quot;</span><br><span class="line">    echo &quot;Example will perform an ICMP ping scan of the 192.168.100.0/24 network&quot;</span><br><span class="line">    exit</span><br><span class="line">fi</span><br><span class="line">prefix=$(echo $1 | cut -d &quot;.&quot; -f 1-3)</span><br><span class="line">for add in $(seq 1 254);do</span><br><span class="line">  ping -c 1 $prefix.$addr | grep &quot;bytes from&quot; | awk &apos;&#123;print $4&#125;&apos;  &amp;</span><br><span class="line">done</span><br></pre></td></tr></table></figure>


<blockquote>
<pre><code>Linux/Unix数据包的TTL值默认为64
ping -R 请求离主机比较远的网卡的IP地址（同个路由器）
traceroute 请求离主机比较近的网卡的IP地址（同个路由器）</code></pre></blockquote>
<h4 id="2-发现-三层发现（Scapy）"><a href="#2-发现-三层发现（Scapy）" class="headerlink" title="2. 发现-三层发现（Scapy）"></a>2. 发现-三层发现（Scapy）</h4><ul>
<li>Scapy<ul>
<li>OSI多层堆叠手工声称ICMP包-IP/ICMP包</li>
<li>ip=IP()</li>
<li>icmp=ICMP()</li>
<li>ping=(ip/icmp)</li>
<li>ping[IP].dst=”IP地址”</li>
<li>a=sr1(ping)</li>
<li>a.dispaly</li>
<li>Ping不存在的地址：a=sr1(ip/icmp,timeout=1)</li>
<li>a=sr1(IP(dst=”IP地址”)/ICMP(),timeout=1)  //一句话实现</li>
</ul>
</li>
<li><strong><code>🔺命令：./pinger1.py IP网段&gt;iplist.txt</code></strong></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python</span><br><span class="line">import logging</span><br><span class="line">import subprocess</span><br><span class="line">logging.getLogger(&quot;scapy.runtime&quot;).setLevel(logging.ERROR)</span><br><span class="line">from scapy.all import *</span><br><span class="line"></span><br><span class="line">if len(sys.argv)!=2:</span><br><span class="line">    print &quot;Usage - ./pinger1.py [/24 network address]&quot;</span><br><span class="line">    print &quot;Example - ./pinger1.py 192.168.100.0&quot;</span><br><span class="line">    print &quot;Example will perform an ICMP ping scan of the 192.168.100.0/24 network&quot;</span><br><span class="line">    sys.exit()</span><br><span class="line"></span><br><span class="line">address=str(sys.argv[1])</span><br><span class="line">prefix=address.split(&quot;.&quot;)[0]+&quot;.&quot;+address.split(&quot;.&quot;)[1]+&quot;.&quot;+address.split(&quot;.&quot;)[2]+&quot;.&quot;</span><br><span class="line"></span><br><span class="line">for addr in range(1,254):</span><br><span class="line">     a=sr1(IP(dst=prefix+str(addr))/ICMP(),timeout=1,verbose=0)</span><br><span class="line">     if a==None:</span><br><span class="line">       pass</span><br><span class="line">     else:</span><br><span class="line">       print prefix+str(addr)</span><br></pre></td></tr></table></figure>

<ul>
<li><strong><code>🔺命令：./pinger2.py iplist.txt</code></strong></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python</span><br><span class="line">import logging</span><br><span class="line">import subprocess</span><br><span class="line">logging.getLogger(&quot;scapy.runtime&quot;).setLevel(logging.ERROR)</span><br><span class="line">from scapy.all import *</span><br><span class="line"></span><br><span class="line">if len(sys.argv)!=2:</span><br><span class="line">    print &quot;Usage - ./pinger2.py [iplist.txt]&quot;</span><br><span class="line">    print &quot;Example - ./pinger2.py iplist.txt&quot;</span><br><span class="line">    print &quot;Example will perform an ICMP ping scan of the 192.168.100.0/24 network&quot;</span><br><span class="line">    sys.exit()</span><br><span class="line"></span><br><span class="line">filename=str(sys.argv[1])</span><br><span class="line">file=open(filename,&quot;r&quot;)</span><br><span class="line"></span><br><span class="line">for addr in file:</span><br><span class="line">    a=sr1(IP(dst=addr.strip())/ICMP(),timeout=0.1,verbose=0)</span><br><span class="line">    if a==None:</span><br><span class="line">      pass</span><br><span class="line">    else:</span><br><span class="line">      print addr.strip()</span><br></pre></td></tr></table></figure>

<h4 id="3-发现-三层发现（nmap）"><a href="#3-发现-三层发现（nmap）" class="headerlink" title="3. 发现-三层发现（nmap）"></a>3. 发现-三层发现（nmap）</h4><ul>
<li><strong><code>🔺命令：nmap IP地址-254 -sn</code></strong>（同网段是发ARP包，不同网段是发ICMP包）</li>
<li><strong><code>🔺命令：nmap -iL iplist.txt -sn</code></strong></li>
</ul>
<blockquote>
<pre><code>namp -sn对于同网段是发ARP包和DNS包，不同网段是发ICMP包（请求字段为时间戳13和请求包8）、DNS包和TCP包 </code></pre></blockquote>
<h4 id="4-发现-三层发现（fping）"><a href="#4-发现-三层发现（fping）" class="headerlink" title="4. 发现-三层发现（fping）"></a>4. 发现-三层发现（fping）</h4><ul>
<li><strong><code>🔺命令：fping IP地址 -c 1</code></strong></li>
<li><strong><code>🔺命令：fping -g 起始IP地址 最后IP地址（IP地址段）-c 1</code></strong></li>
<li><strong><code>🔺命令：fping -g IP网段/24</code></strong>  ▲2019.12.2过滤输出格式不对</li>
<li><strong><code>🔺命令：fping -f iplist.txt</code></strong></li>
</ul>
<h4 id="5-发现-三层发现（Hping）"><a href="#5-发现-三层发现（Hping）" class="headerlink" title="5. 发现-三层发现（Hping）"></a>5. 发现-三层发现（Hping）</h4><ul>
<li>Hping（几乎可以完成所以IP、TCP协议包头的组合，也可对于基于TCP服务器进行压力测试）<ul>
<li>能够发生几乎所有任意TCP/IP包</li>
<li>功能强大但每次只能扫描一个目标</li>
</ul>
</li>
<li><strong><code>🔺命令：hping3 IP地址 --icmp -c 2</code></strong></li>
<li><strong><code>🔺命令：for addr in $(seq 1 254); do hping3 1.1.1.$addr --icmp -c 1 &gt;&gt; handle.txt &amp; done</code></strong></li>
<li><strong><code>🔺命令：cat handle.txt |  grep ^len</code></strong></li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/12/10/Kali%20Linux%E7%AC%94%E8%AE%B0(%E5%8D%81%E5%9B%9B)%EF%BC%9A%E4%B8%BB%E6%9C%BA%E5%8F%91%E7%8E%B0--%E4%BA%8C%E5%B1%82%E5%8F%91%E7%8E%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Tomas">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/photo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tomas'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/12/10/Kali%20Linux%E7%AC%94%E8%AE%B0(%E5%8D%81%E5%9B%9B)%EF%BC%9A%E4%B8%BB%E6%9C%BA%E5%8F%91%E7%8E%B0--%E4%BA%8C%E5%B1%82%E5%8F%91%E7%8E%B0/" itemprop="url">Kali Linux笔记(十四)：主机发现--二层发现</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-12-10T08:13:38+08:00">
                2019-12-10
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Kali/" itemprop="url" rel="index">
                    <span itemprop="name">Kali</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1.2k 字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  5 分钟
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <hr>
<h4 id="1-主动信息收集"><a href="#1-主动信息收集" class="headerlink" title="1. 主动信息收集"></a>1. 主动信息收集</h4><ul>
<li>直接与目标系统交互通信</li>
<li>无法避免留下访问的痕迹（可能被封杀，强的流量分析，强的代码审计）</li>
<li>使用受控的第三方电脑进行探测<ul>
<li>使用代理或已被控制的主机</li>
<li>做好被封杀的准本</li>
<li>使用噪声迷惑目标，淹没真实的探测流量（伪造IP发送大量垃圾信息）</li>
</ul>
</li>
<li>扫描（IP层 → 端口层 → 服务级别的扫描）<ul>
<li>发送不同的探测，根据结果判断目标状态</li>
</ul>
</li>
</ul>
<h4 id="2-发现（IP层-→-端口层-→-服务级别的扫描）"><a href="#2-发现（IP层-→-端口层-→-服务级别的扫描）" class="headerlink" title="2. 发现（IP层 → 端口层 → 服务级别的扫描）"></a>2. 发现（IP层 → 端口层 → 服务级别的扫描）</h4><ul>
<li>识别活着的主机<ul>
<li>潜在的被攻击目标（存在的漏洞来进行利用）</li>
</ul>
</li>
<li>输出一个IP地址列表（在线IP地址）</li>
<li>2、3、4层发现</li>
</ul>
<h4 id="3-发现-二层发现（arping）"><a href="#3-发现-二层发现（arping）" class="headerlink" title="3. 发现-二层发现（arping）"></a>3. 发现-二层发现（arping）</h4><ul>
<li>优点：扫描速度快、可靠</li>
<li>缺点：不可路由（只可发现本网段的主机发现）</li>
<li>Arp协议<ul>
<li>抓包</li>
</ul>
</li>
</ul>
<blockquote>
<pre><code>OSI模型
Layer1 Physical
Layer2 Data Link       ARP
Layer3 Network         IPv4,IPv6,ICMP,and IPSec
Layer4 Transport       TCP and UDP
Layer5 Session         NetBIOS,PPTP,RPC,and SOCKS
Layer6 Presentation    ASCII,JPEG,PDF,PNG,and DOCX
Layer7 Application     HTTP,FTP,and Telnet</code></pre></blockquote>
<ul>
<li><strong><code>🔺命令：arping</code></strong></li>
<li><strong><code>🔺命令：arping IP地址 -c 1</code></strong>（发送一个ARP包）</li>
<li><strong><code>🔺命令：arping IP地址 -d</code></strong>（发现重复IP地址拥有一个MAC地址，可以发现arp地址欺骗）</li>
<li><strong><code>🔺命令：arping -c 1 Ip地址 | grep &quot;bytes from&quot; | cut -d &quot; &quot; -f 5 | cut -d &quot;(&quot; -f 2 | cut -d &quot;)&quot; -f 1</code></strong></li>
<li>脚本 ▲2019.12.2新版ifconfig命令显示不同，对相应脚本进行修改<ul>
<li><strong><code>🔺命令：./arping1.sh eth0 &gt;iplist.txt</code></strong>（检查网内”存活”的计算机）</li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">#！/bin/bash</span><br><span class="line">if [ &quot;$#&quot; -ne 1 ];then</span><br><span class="line">    echo &quot;USAGE - ./arping.sh [interface]&quot;</span><br><span class="line">    echo &quot;Example - ./arping.sh eth0&quot;</span><br><span class="line">    echo &quot;Example will perform an ARP scan of the local subnet to which eth0 is assigned&quot;</span><br><span class="line">    exit</span><br><span class="line">fi</span><br><span class="line">interface=$1</span><br><span class="line">prefix=$(ifconfig $interface | grep &quot;inet&quot; | egrep -v &quot;inet6&quot; | cut -d &quot;.&quot; -f 1-3 | awk &apos;&#123;print $2&#125;&apos;)</span><br><span class="line">for addr in $(seq 1 254);do</span><br><span class="line">    arping -c 1 $prefix.$addr | grep &quot;bytes from&quot; | cut -d &quot; &quot; -f 5 | cut -d &quot;(&quot; -f 2 | cut -d &quot;)&quot; -f 1</span><br><span class="line">done</span><br></pre></td></tr></table></figure>

<ul>
<li>脚本 <ul>
<li><strong><code>🔺命令：./arping2.sh iplist.txt</code></strong>（重新检查”存活”的主机）</li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">#！/bin/bash</span><br><span class="line">if [ &quot;$#&quot; -ne 1 ];then</span><br><span class="line">    echo &quot;USAGE - ./arping.sh [iplist.txt]&quot;</span><br><span class="line">    echo &quot;Example - ./arping.sh iplist.txt&quot;</span><br><span class="line">    echo &quot;Example will perform an ARP scan of the local subnet to which eth0 is assigned&quot;</span><br><span class="line">fi</span><br><span class="line">file=$1</span><br><span class="line">for addr in $(cat $file); do</span><br><span class="line">    arping -c 1 $addr | grep &quot;bytes from&quot; | cut -d &quot; &quot; -f 5 | cut -d &quot;(&quot; -f 2 | cut -d &quot;)&quot; -f 1</span><br><span class="line">done</span><br></pre></td></tr></table></figure>

<h4 id="4-发现-二层发现（Netdiscover）"><a href="#4-发现-二层发现（Netdiscover）" class="headerlink" title="4. 发现-二层发现（Netdiscover）"></a>4. 发现-二层发现（Netdiscover）</h4><ul>
<li>Netdiscover（支持CIDR地址段显示）▲2019.12.2可抓到包，但界面不显示<ul>
<li>专门用于二层发现</li>
<li>可用于无线和交换网络环境</li>
<li>主动和被动探测</li>
</ul>
</li>
<li>主动<ul>
<li><strong><code>🔺命令：netdiscover -i eth0 -r IP地址/24</code></strong></li>
<li><strong><code>🔺命令：netdiscover -l iplist.txt</code></strong></li>
</ul>
</li>
<li>被动（把网卡制成混杂模式进行监听）<ul>
<li><strong><code>🔺命令：netdiscover -p</code></strong></li>
<li>主动arp容易触发报警</li>
</ul>
</li>
</ul>
<h4 id="5-发现-二层发现（Scapy）"><a href="#5-发现-二层发现（Scapy）" class="headerlink" title="5. 发现-二层发现（Scapy）"></a>5. 发现-二层发现（Scapy）</h4><ul>
<li>Scapy<ul>
<li>作为Python库进行调用</li>
<li>也可以作为单独的工具使用</li>
<li>抓包、分析、创建、修改、注入网络流量</li>
</ul>
</li>
<li>apt-get install python3-gnuplot（报错可安装）▲2019.12.2依然会报错，但不影响使用</li>
<li>Scapy<ul>
<li>arp=ARP（）</li>
<li>arp.pdst=”IP地址”（进行赋值）</li>
<li>answer=sr1(arp)（发生数据包）</li>
<li>answer.display() （显示数据包的结构，分层）</li>
</ul>
</li>
</ul>
<blockquote>
<pre><code>ARP().dispaly()（定制一个ARP的数据包，只需要添加属性字段，ARP的包头结构）
sr1()（发送数据包）</code></pre></blockquote>
<ul>
<li>python脚本（用Scapy写的python脚本）<ul>
<li><strong><code>🔺命令：./Arp1.py 接口</code></strong> ▲2019.12.1 strip()函数报错</li>
<li><strong><code>🔺命令：./Arp2.py iplist.txt</code></strong></li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python</span><br><span class="line">import logging</span><br><span class="line">import subprocess</span><br><span class="line">logging.getLogger(&quot;scapy.runtime&quot;).setLevel(logging.ERROR)</span><br><span class="line">from scapy.all import *</span><br><span class="line"></span><br><span class="line">if len(sys.argv)!=2:</span><br><span class="line">    print &quot;Usage - ./Arp1.py [interface]&quot;</span><br><span class="line">    print &quot;Example - ./Arp1.py eth0&quot;</span><br><span class="line">    print &quot;Example will perform an ARP scan of the local subnet to which eth0 is assigned&quot;</span><br><span class="line">    sys.exit()</span><br><span class="line"></span><br><span class="line">interface=str(sys.argv[1])</span><br><span class="line"></span><br><span class="line">ip=subprocess.check_output(&quot;ifconfig &quot;+interface+&quot; | grep &quot;inet&quot; | egrep -v &quot;inet6&quot; | cut -d &quot;.&quot; -f 1-3 | awk &apos;&#123;print $2&#125;&apos;&quot;,shell=True).strip()</span><br><span class="line">prefix=ip.split(&quot;.&quot;)[0]+&quot;.&quot;+ip.split(&quot;.&quot;)[1]+&quot;.&quot;+ip.split(&quot;.&quot;)[2]+&quot;.&quot;</span><br><span class="line">for addr in range(0,254):</span><br><span class="line">    answer=sr1(ARP(pdst=addr.strip()),timeout=0.1,verbose=1)</span><br><span class="line">    if answer==None:</span><br><span class="line">      pass</span><br><span class="line">    else:</span><br><span class="line">      print prefix+str(addr)</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python</span><br><span class="line">import logging</span><br><span class="line">import subprocess</span><br><span class="line">logging.getLogger(&quot;scapy.runtime&quot;).setLevel(logging.ERROR)</span><br><span class="line">from scapy.all import *</span><br><span class="line"></span><br><span class="line">if len(sys.argv)!=2:</span><br><span class="line">    print &quot;Usage - ./Arp2.py [iplist.txt]&quot;</span><br><span class="line">    print &quot;Example - ./Arp2.py iplist.txt&quot;</span><br><span class="line">    print &quot;Example will perform an ARP scan of the local subnet to which eth0 is assigned&quot;</span><br><span class="line">    sys.exit()</span><br><span class="line"></span><br><span class="line">filename=str(sys.argv[1])</span><br><span class="line">file=open(filename,&quot;r&quot;)</span><br><span class="line"></span><br><span class="line">for addr in file:</span><br><span class="line">    answer=sr1(ARP(pdst=addr.strip()),timeout=0.1,verbose=1)</span><br><span class="line">    if answer==None:</span><br><span class="line">      pass</span><br><span class="line">    else:</span><br><span class="line">      print addr.strip()</span><br></pre></td></tr></table></figure>

<h4 id="6-发现-二层发现（nmap）"><a href="#6-发现-二层发现（nmap）" class="headerlink" title="6. 发现-二层发现（nmap）"></a>6. 发现-二层发现（nmap）</h4><ul>
<li><strong><code>🔺命令：nmap IP地址-254（IP地址/24） -sn</code></strong> </li>
<li><strong><code>🔺命令：namp -iL（调用地址列表的文本文件） iplist.txt -sn | grep ^Namp</code></strong></li>
</ul>
<blockquote>
<pre><code>强大的NMAP软件，需要非常熟练
nmap的-sn参数，除了会ARP发现之外，还会进行DNS的反向域名解析</code></pre></blockquote>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/12/10/Kali%20Linux%E7%AC%94%E8%AE%B0(%E5%8D%81%E4%B8%83)%EF%BC%9A%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F--UDP/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Tomas">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/photo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tomas'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/12/10/Kali%20Linux%E7%AC%94%E8%AE%B0(%E5%8D%81%E4%B8%83)%EF%BC%9A%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F--UDP/" itemprop="url">Kali Linux笔记(十七)：端口扫描--UDP</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-12-10T08:13:38+08:00">
                2019-12-10
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Kali/" itemprop="url" rel="index">
                    <span itemprop="name">Kali</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  367 字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  1 分钟
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <hr>
<h4 id="1-端口扫描（UDP）"><a href="#1-端口扫描（UDP）" class="headerlink" title="1. 端口扫描（UDP）"></a>1. 端口扫描（UDP）</h4><ul>
<li>端口对应网络服务及应用端程序</li>
<li>服务端程序的漏洞通过端口攻入</li>
<li>发现开放的端口</li>
<li>更具体的攻击面</li>
<li>UDP端口<ul>
<li>假设ICMP port-unreachable 响应代表端口关闭（没有响应，即为端口开放）</li>
<li>目标系统不响应ICMP port-unreachable时，可能产生误判</li>
</ul>
</li>
<li>完整的UDP应用层请求<ul>
<li>准确性高</li>
<li>耗时巨大</li>
</ul>
</li>
</ul>
<h4 id="2-端口扫描（Scapy-UDP）"><a href="#2-端口扫描（Scapy-UDP）" class="headerlink" title="2. 端口扫描（Scapy-UDP）"></a>2. 端口扫描（Scapy-UDP）</h4><ul>
<li>Scapy UDP Scan<ul>
<li>端口关闭：ICMP port-unreachable</li>
<li>端口开放：没有回包</li>
<li>了解每一种基于UDP的应用包结构很有帮助</li>
<li>与三层相同的技术</li>
<li>误判</li>
</ul>
</li>
<li>Scapy<ul>
<li>sr1(IP(dst=”IP地址”)/UDP(dport=53),timeout=1,verbose=1)</li>
</ul>
</li>
<li><strong><code>🔺命令：./udp_scan.py IP地址 起始端口 结束端口</code></strong></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python</span><br><span class="line">import logging</span><br><span class="line">logging.getLogger(&quot;scapy.runtime&quot;).setLevel(logging.ERROR)</span><br><span class="line">from scapy.all import *</span><br><span class="line">import time</span><br><span class="line">import sys</span><br><span class="line"></span><br><span class="line">if len(sys.argv)!=4:</span><br><span class="line">    print &quot;Usage - ./udp_scan.py [Target IP] [First IP] [Last IP] &quot;</span><br><span class="line">    print &quot;Example - ./udp_scan.py 192.168.100.1 1 200&quot;</span><br><span class="line">    print &quot;Example will perform a TCP ACK scan of the 192.168.100.0/24 range&quot;</span><br><span class="line">    sys.exit()</span><br><span class="line"></span><br><span class="line">ip=sys.argv[1]</span><br><span class="line">start=int(sys.argv[2])</span><br><span class="line">end=int(sys.argv[3])</span><br><span class="line"></span><br><span class="line">for port in range(start end):</span><br><span class="line">    a=sr1(IP(dst=ip)/UDP(dport=port),timeout=5,verbose=0)</span><br><span class="line">    time.sleep(1)</span><br><span class="line">    if a==None:</span><br><span class="line">      print port</span><br><span class="line">    else:</span><br><span class="line">      pass</span><br></pre></td></tr></table></figure>

<h4 id="3-端口扫描（Nmap-UDP）"><a href="#3-端口扫描（Nmap-UDP）" class="headerlink" title="3. 端口扫描（Nmap-UDP）"></a>3. 端口扫描（Nmap-UDP）</h4><ul>
<li>Nmap</li>
<li><strong><code>🔺命令：nmap -sU（端口扫描） IP地址</code></strong><ul>
<li>默认的1000个参数（不指定端口的情况下）</li>
<li>ICMP host-unreachable</li>
</ul>
</li>
<li><strong><code>🔺命令：nmap IP地址 -sU -p（指定端口） 53</code></strong></li>
<li><strong><code>🔺命令：nmap -iL iplist.txt -sU -p（指定端口范围） 1-200</code></strong></li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/12/10/Kali%20Linux%E7%AC%94%E8%AE%B0(%E5%8D%81%E5%85%AD)%EF%BC%9A%E4%B8%BB%E6%9C%BA%E5%8F%91%E7%8E%B0--%E5%9B%9B%E5%B1%82%E5%8F%91%E7%8E%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Tomas">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/photo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tomas'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/12/10/Kali%20Linux%E7%AC%94%E8%AE%B0(%E5%8D%81%E5%85%AD)%EF%BC%9A%E4%B8%BB%E6%9C%BA%E5%8F%91%E7%8E%B0--%E5%9B%9B%E5%B1%82%E5%8F%91%E7%8E%B0/" itemprop="url">Kali Linux笔记(十六)：主机发现--四层发现</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-12-10T08:13:38+08:00">
                2019-12-10
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Kali/" itemprop="url" rel="index">
                    <span itemprop="name">Kali</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  996 字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  5 分钟
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <hr>
<h4 id="1-发现-四层发现（不对端口状态进行识别，主要是对IP是否在线进行识别）"><a href="#1-发现-四层发现（不对端口状态进行识别，主要是对IP是否在线进行识别）" class="headerlink" title="1. 发现-四层发现（不对端口状态进行识别，主要是对IP是否在线进行识别）"></a>1. 发现-四层发现（不对端口状态进行识别，主要是对IP是否在线进行识别）</h4><ul>
<li>优点<ul>
<li>可路由且结果可靠</li>
<li>不太可能被防火墙过滤</li>
<li>甚至可以发现所有端口都被过滤的主机</li>
</ul>
</li>
<li>缺点<ul>
<li>基于状态过滤的防火墙可能过滤扫描</li>
<li>全端口扫描速度慢</li>
</ul>
</li>
<li>TCP（正常过程：SYN–SYN/ACK–ACK）<ul>
<li>未经请求的ACK–RST</li>
<li>SYN–SYN/ACK、RST</li>
</ul>
</li>
<li>UDP<ul>
<li>ICMP端口不可达、一去不复返（被识别主机端口未开放UDP服务）</li>
</ul>
</li>
</ul>
<h4 id="2-发现-四层发现（Scapy-TCP）"><a href="#2-发现-四层发现（Scapy-TCP）" class="headerlink" title="2. 发现-四层发现（Scapy-TCP）"></a>2. 发现-四层发现（Scapy-TCP）</h4><ul>
<li>ACK–TCP Port–RST</li>
<li>Scapy<ul>
<li>i=IP()</li>
<li>i.dst=”IP地址”</li>
<li>t=TCP()</li>
<li>t.flags=”A”</li>
<li>r=(i/f)</li>
<li>a=sr1(r)</li>
<li>a.display()</li>
</ul>
</li>
<li>a=sr1(IP(dst=”IP地址”)/TCP(dport=80,flags=”A”),timeout=1)</li>
<li><strong><code>🔺命令：./ACK_Ping.py IP网段</code></strong></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python</span><br><span class="line">import logging</span><br><span class="line">import subprocess</span><br><span class="line">logging.getLogger(&quot;scapy.runtime&quot;).setLevel(logging.ERROR)</span><br><span class="line">from scapy.all import *</span><br><span class="line"></span><br><span class="line">if len(sys.argv)!=2:</span><br><span class="line">    print &quot;Usage - ./ACK_Ping.py [/24 network address]&quot;</span><br><span class="line">    print &quot;Example - ./ACK_Ping.py 192.168.100.0&quot;</span><br><span class="line">    print &quot;Example will perform a TCP ACK scan of the 192.168.100.0/24 range&quot;</span><br><span class="line">    sys.exit()</span><br><span class="line"></span><br><span class="line">address=str(sys.argv[1])</span><br><span class="line">prefix=address.split(&quot;.&quot;)[0]+&quot;.&quot;+address.split(&quot;.&quot;)[1]+&quot;.&quot;+address.split(&quot;.&quot;)[2]+&quot;.&quot;</span><br><span class="line"></span><br><span class="line">for addr in range(1,254):</span><br><span class="line">    response=sr1(IP(dst=prefix+str(addr))/TCP(dport=2222,flags=&apos;A&apos;),timeout=0.1,verbose=0)</span><br><span class="line">    try:</span><br><span class="line">      if int(response[TCP].flags)==4:</span><br><span class="line">        print prefix+str(addr)</span><br><span class="line">    except:</span><br><span class="line">        pass</span><br></pre></td></tr></table></figure>

<h4 id="3-发现-四层发现（Scapy-UDP）"><a href="#3-发现-四层发现（Scapy-UDP）" class="headerlink" title="3. 发现-四层发现（Scapy-UDP）"></a>3. 发现-四层发现（Scapy-UDP）</h4><ul>
<li>UDP–UDP Port–ICMP</li>
<li>Scapy<ul>
<li>i=IP()</li>
<li>u=UDP()</li>
<li>i.dst=”IP地址”</li>
<li>u.dport=33333</li>
<li>r=(i/u)</li>
<li>a=sr1(r,timeout=1,verbose=1)</li>
<li>a.display()</li>
</ul>
</li>
<li><strong><code>🔺命令：./UDP_Ping.py IP网段</code></strong>（UDP发现不可靠）</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python</span><br><span class="line">import logging</span><br><span class="line">import subprocess</span><br><span class="line">logging.getLogger(&quot;scapy.runtime&quot;).setLevel(logging.ERROR)</span><br><span class="line">from scapy.all import *</span><br><span class="line"></span><br><span class="line">if len(sys.argv)!=2:</span><br><span class="line">    print &quot;Usage - ./UDP_Ping.py [/24 network address]&quot;</span><br><span class="line">    print &quot;Example - ./UDP_Ping.py 192.168.100.0&quot;</span><br><span class="line">    print &quot;Example will perform a UDP ICMP scan of the 192.168.100.0/24 range&quot;</span><br><span class="line">    sys.exit()</span><br><span class="line"></span><br><span class="line">address=str(sys.argv[1])</span><br><span class="line">prefix=address.split(&quot;.&quot;)[0]+&quot;.&quot;+address.split(&quot;.&quot;)[1]+&quot;.&quot;+address.split(&quot;.&quot;)[2]+&quot;.&quot;</span><br><span class="line"></span><br><span class="line">for addr in range(1,254):</span><br><span class="line">    response=sr1(IP(dst=prefix+str(addr))/UDP(dport=33333),timeout=0.1,verbose=0)</span><br><span class="line">    try:</span><br><span class="line">      if int(response[IP].proto)==1:</span><br><span class="line">        print prefix+str(addr)</span><br><span class="line">    except:</span><br><span class="line">        pass</span><br></pre></td></tr></table></figure>

<h4 id="4-发现-四层发现（Nmap）"><a href="#4-发现-四层发现（Nmap）" class="headerlink" title="4. 发现-四层发现（Nmap）"></a>4. 发现-四层发现（Nmap）</h4><ul>
<li><strong><code>🔺命令：nmap IP地址-254 -PU53（对于UDP53端口）-sn</code></strong></li>
<li><strong><code>🔺命令：nmap IP地址-254 -PA80（对于TCP80端口）-sn</code></strong></li>
<li><strong><code>🔺命令：nmap -iL iplist.txt -PA80 -sn</code></strong></li>
</ul>
<p>▲ 2019.12.3 Nmap局域网，无论是TCP还是UDP，发送的都是DNS的包，局域网内是发给网关<br>▲ 2019.12.3 Nmap外网，UDP查询时发送DNS包，TCP发送TCP包</p>
<blockquote>
<pre><code>nmap IP地址 -P0 -sn Ping层的发现
nmap IP地址 -PS -sn SCTP发现
nmap IP地址 -PE -sn ICMP echo
nmap IP地址 -PP -sn 时间戳
namp IP地址 -PM -sn 子网掩码发现
nmap 192.168.100.1-254 -PA80 -sn | grep &quot;Nmap&quot; | grep -v &quot;Starting&quot; | grep -v &quot;done&quot;| cut -d &quot; &quot; -f 6 | cut -d &quot;(&quot; -f 2| cut -d &quot;)&quot; -f 1 &gt; iplist.txt</code></pre></blockquote>
<h4 id="5-发现-四层发现（hping3）"><a href="#5-发现-四层发现（hping3）" class="headerlink" title="5. 发现-四层发现（hping3）"></a>5. 发现-四层发现（hping3）</h4><ul>
<li><strong><code>🔺命令：hping3 --udp IP地址 -c 1</code></strong></li>
<li><strong><code>🔺命令：for addr in $(seq 1 254);do hping3 --udp 1.1.1.$addr -c 1 &gt;&gt;r.txt;done</code></strong><ul>
<li><strong><code>🔺命令：grep Unreachable r.txt | cut -d &quot;&quot; -f 5 | cut -d &quot;=&quot; -f 2</code></strong></li>
<li><strong><code>🔺命令：./udp_hping.sh IP网段</code></strong></li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">#！/bin/bash</span><br><span class="line">if [ &quot;$#&quot; -ne 1 ];then</span><br><span class="line">    echo &quot;USAGE - ./udp_hping.sh [/24 network address]&quot;</span><br><span class="line">    echo &quot;Example - ./udp_hping.sh 192.168.100.0&quot;</span><br><span class="line">    echo &quot;Example will perform an UDP scan of the 192.168.100.0/24 network and output.txt file&quot;</span><br><span class="line">    exit</span><br><span class="line">fi</span><br><span class="line">prefix=$(echo $1 | cut -d &quot;.&quot; -f 1-3)</span><br><span class="line">for addr in $(seq 1 254);do</span><br><span class="line">    hping3 $prefix.$addr --udp -c 1 &gt;&gt; r.txt;</span><br><span class="line">done</span><br><span class="line">grep Unreachable r.txt | cut -d &quot;&quot; -f 5 | cut -d &quot;=&quot; -f 2 &gt;&gt; output.txt</span><br><span class="line">rm r.txt</span><br></pre></td></tr></table></figure>

<ul>
<li><strong><code>🔺命令：hping3 IP地址 -c 1</code></strong>（TCP，Flag 0–ACK、RST）<ul>
<li><strong><code>🔺命令：hping3 IP地址</code></strong></li>
<li><strong><code>🔺命令：./tcp_hping.sh IP网段</code></strong></li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">#！/bin/bash</span><br><span class="line">if [ &quot;$#&quot; -ne 1 ];then</span><br><span class="line">    echo &quot;USAGE - ./tcp_hping.sh [/24 network address]&quot;</span><br><span class="line">    echo &quot;Example - ./tcp_hping.sh 192.168.100.0&quot;</span><br><span class="line">    echo &quot;Example will perform an TCP scan of the 192.168.100.0/24 network and output.txt file&quot;</span><br><span class="line">    exit</span><br><span class="line">fi</span><br><span class="line">prefix=$(echo $1 | cut -d &quot;.&quot; -f 1-3)</span><br><span class="line">for addr in $(seq 1 254);do</span><br><span class="line">    hping3 $prefix.$addr -c 1 &gt;&gt; r.txt;</span><br><span class="line">done</span><br><span class="line">grep Unreachable r.txt | cut -d &quot;&quot; -f 5 | cut -d &quot;=&quot; -f 2 &gt;&gt; output.txt</span><br><span class="line">rm r.txt</span><br></pre></td></tr></table></figure>


<blockquote>
<pre><code>hping3不是发ACK的TCP包，是flag0的TCP包，需要收回ACK、RST的TCP包
nmap和Scapy发的是ACK的TCP包，是flag16的TCP包，需要收回RST的TCP包</code></pre></blockquote>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/12/10/Kali%20Linux%E7%AC%94%E8%AE%B0(%E5%8D%81%E4%B9%9D)%EF%BC%9A%E6%9C%8D%E5%8A%A1%E6%89%AB%E6%8F%8F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Tomas">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/photo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tomas'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/12/10/Kali%20Linux%E7%AC%94%E8%AE%B0(%E5%8D%81%E4%B9%9D)%EF%BC%9A%E6%9C%8D%E5%8A%A1%E6%89%AB%E6%8F%8F/" itemprop="url">Kali Linux笔记(十九)：服务扫描</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-12-10T08:13:38+08:00">
                2019-12-10
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Kali/" itemprop="url" rel="index">
                    <span itemprop="name">Kali</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1.5k 字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  6 分钟
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <hr>
<h4 id="1-服务扫描（不能简单通过端口号来判断端口上的服务）"><a href="#1-服务扫描（不能简单通过端口号来判断端口上的服务）" class="headerlink" title="1. 服务扫描（不能简单通过端口号来判断端口上的服务）"></a>1. 服务扫描（不能简单通过端口号来判断端口上的服务）</h4><ul>
<li>识别开放端口上运行的应用</li>
<li>识别目标操作系统</li>
<li>提高攻击效率<ul>
<li>Banner捕获（最主要，最简单，准确性不高）</li>
<li>服务识别</li>
<li>操作系统识别</li>
<li>SNMP分析（通过系统内部信息来进行探索）</li>
<li>防火墙识别（识别边界防火墙，过滤机制，进行绕过）</li>
</ul>
</li>
<li>Banner<ul>
<li>软件开发商</li>
<li>软件名称</li>
<li>服务类型</li>
<li>版本号（直接发现已知的漏洞和弱点）</li>
</ul>
</li>
<li>连接建立后直接获取banner</li>
<li>另类服务识别方法<ul>
<li>特征行为和响应字段（指纹信息）</li>
<li>不用的响应可用于识别底层操作系统</li>
</ul>
</li>
<li>SNMP（默认就是public，可读可写private，public可查看交换机信息）<ul>
<li>简单网络管理协议</li>
<li>Community strings</li>
<li>信息查询或重新配置</li>
</ul>
</li>
<li>识别和绕过防火墙筛选</li>
</ul>
<h4 id="2-服务扫描-Banner"><a href="#2-服务扫描-Banner" class="headerlink" title="2. 服务扫描-Banner"></a>2. 服务扫描-Banner</h4><ul>
<li><strong><code>🔺命令：nc -nv IP地址 端口号</code></strong>（查看端口banner信息）</li>
</ul>
<h4 id="3-服务扫描-Banner"><a href="#3-服务扫描-Banner" class="headerlink" title="3. 服务扫描-Banner"></a>3. 服务扫描-Banner</h4><ul>
<li>Python socket（socket缺乏对应用层数据包的定义，无法建立完整会话）<ul>
<li>socket模块用于连接网络服务</li>
</ul>
</li>
<li>python</li>
<li>import socket</li>
<li>banner=socket.socket(socket.AF_INET,socket.SOCK_STREAM)</li>
<li>banner.connet((“IP地址”,端口号))</li>
<li>banner.recv(4096)  （’220(vsftp 2.3.4)\r\n’） </li>
<li>banner.close()</li>
<li>exit()</li>
<li>Banner不允许抓取，recv函数无返回将挂起！！</li>
<li><strong><code>🔺命令：./ban_grab.py IP地址 起始端口 结束端口</code></strong>  ▲2019.12.6 暂时扫不出服务</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python</span><br><span class="line">import socket</span><br><span class="line">import select</span><br><span class="line">import sys</span><br><span class="line"></span><br><span class="line">if len(sys.argv)!=4:</span><br><span class="line">    print &quot;Usage - ./ban_grab.py [Target IP] [First Port] [Last Port] &quot;</span><br><span class="line">    print &quot;Example - ./ban_grab.py 192.168.100.1 1 200&quot;</span><br><span class="line">    print &quot;Example will grab banners for TCP ports 1 through 100 on 192.168.100.1&quot;</span><br><span class="line">    sys.exit()</span><br><span class="line"></span><br><span class="line">ip=sys.argv[1]</span><br><span class="line">start=int(sys.argv[2])</span><br><span class="line">end=int(sys.argv[3])</span><br><span class="line"></span><br><span class="line">for port in range(start,end):</span><br><span class="line">    try:</span><br><span class="line">      bangrab=socket.socket(socket.AF_INET,socket.SOCK_STREAM)</span><br><span class="line">      bangrab.connect((ip,port))</span><br><span class="line">      ready=select.select((bangrab),[],[],1)</span><br><span class="line">      if ready[0]:</span><br><span class="line">        print &quot;TCP Port &quot;+str[port]+&quot;-&quot;+bangrab.recv[4096]</span><br><span class="line">        bangrab.close()</span><br><span class="line">    except:</span><br><span class="line">      pass</span><br></pre></td></tr></table></figure>

<h4 id="4-服务扫描-Banner"><a href="#4-服务扫描-Banner" class="headerlink" title="4. 服务扫描-Banner"></a>4. 服务扫描-Banner</h4><ul>
<li><strong><code>🔺命令：dmitry -p（TCP扫描）IP地址</code></strong></li>
<li><strong><code>🔺命令：dmitry -pb（TCP扫描banner信息） IP地址</code></strong></li>
</ul>
<h4 id="5-服务扫描-Banner"><a href="#5-服务扫描-Banner" class="headerlink" title="5. 服务扫描-Banner"></a>5. 服务扫描-Banner</h4><ul>
<li><strong><code>🔺命令：nmap -sT（完整的TCP连接） IP地址 -p 端口 --script=banner.nse</code></strong></li>
</ul>
<blockquote>
<pre><code>nmap扫描脚本：/usr/share/nmap/script</code></pre></blockquote>
<h4 id="6-服务扫描-Banner"><a href="#6-服务扫描-Banner" class="headerlink" title="6. 服务扫描-Banner"></a>6. 服务扫描-Banner</h4><ul>
<li><strong><code>🔺命令：amap -B（专门发现指定端口上的banner信息） IP地址 端口</code></strong></li>
</ul>
<h4 id="7-服务扫描-服务识别"><a href="#7-服务扫描-服务识别" class="headerlink" title="7. 服务扫描-服务识别"></a>7. 服务扫描-服务识别</h4><ul>
<li>Banner信息抓取能力有限</li>
<li>nmap响应特征分析识别服务<ul>
<li>发现系列复杂的探测</li>
<li>依据响应特征signature</li>
</ul>
</li>
<li><strong><code>🔺命令：nv -nv IP地址 端口</code></strong></li>
<li><strong><code>🔺命令：nmap IP地址 -p 端口</code></strong>-sV（识别端口后面服务，通过指纹匹配的方式，不单是banner信息）</li>
</ul>
<h4 id="8-服务扫描-服务识别"><a href="#8-服务扫描-服务识别" class="headerlink" title="8. 服务扫描-服务识别"></a>8. 服务扫描-服务识别</h4><ul>
<li><strong><code>🔺命令：Amap</code></strong>（还是基于banner信息进行识别）</li>
<li><strong><code>🔺命令：amap IP地址</code></strong></li>
<li><strong><code>🔺命令：amap IP地址 端口号</code></strong></li>
<li><strong><code>🔺命令：amap IP地址 端口号 -q</code></strong></li>
<li><strong><code>🔺命令：amap IP地址 端口号 -qb</code></strong></li>
</ul>
<h4 id="9-SNMP扫描（通信：101和102，被查询的服务端：161，客户端：162-→-udp）"><a href="#9-SNMP扫描（通信：101和102，被查询的服务端：161，客户端：162-→-udp）" class="headerlink" title="9. SNMP扫描（通信：101和102，被查询的服务端：161，客户端：162 → udp）"></a>9. SNMP扫描（通信：101和102，被查询的服务端：161，客户端：162 → udp）</h4><ul>
<li>snmp（明文传输，可被嗅探到）<ul>
<li>信息的金矿（设备的详细内容）</li>
<li>经常被错误配置（特征字符，community）</li>
<li>public/private/mnager</li>
</ul>
</li>
<li>MIB Tree<ul>
<li>SNMP Management Information Base（MIB）</li>
<li>树形的网络设备管理功能数据库</li>
<li>1.3.6.1.4.1.77.1.2.25（OID）</li>
</ul>
</li>
<li><strong><code>🔺命令：onesixtyone IP地址 public</code></strong></li>
<li><strong><code>🔺命令：onesixtyone -c（字典） dict.txt -i（多个主机列表） host -o my.log -w 100</code></strong></li>
</ul>
<blockquote>
<pre><code>Window XP安装 → 程序软件安装 → 添加组件 → 管理和监视（有可能需要安装光盘）
services.msc snmp服务，可添加代理，陷阱（snmp作为客户端），默认安装public作为commuity，然后接受来自任何主机的SNMP查询包</code></pre></blockquote>
<h4 id="10-SNMP扫描"><a href="#10-SNMP扫描" class="headerlink" title="10. SNMP扫描"></a>10. SNMP扫描</h4><ul>
<li><strong><code>🔺命令：snmpwalk IP地址 -c public -v（snmp版本） 2c</code></strong></li>
<li>用户<ul>
<li><strong><code>🔺命令：snmp -c publuc -v 2c IP地址 1.3.6.1.4.1.77.1.2.25</code></strong>（MIB All ID）</li>
</ul>
</li>
<li><strong><code>🔺命令：snmpcheck -t</code></strong>（目标主机） IP地址（默认情况下是public，可以用-c去修改community）</li>
<li><strong><code>🔺命令：snmpcheck -t IP地址 -c private -v 2</code></strong></li>
<li><strong><code>🔺命令：snmpcheck -t IP地址 -p agent w</code></strong>（检测是否有可写权限）</li>
</ul>
<blockquote>
<pre><code>SNMP版本：v1，v2c，v3（大量安全机制）</code></pre></blockquote>
<h4 id="11-SMB扫描"><a href="#11-SMB扫描" class="headerlink" title="11. SMB扫描"></a>11. SMB扫描</h4><ul>
<li><p>Server Message Block 协议</p>
<ul>
<li>微软历史上出现安全问题最多的协议</li>
<li>实现复杂</li>
<li>默认开放</li>
<li>文件共享</li>
<li>空会话未身份认证访问（SMB1）</li>
</ul>
<ol>
<li>密码策略</li>
<li>用户名</li>
<li>组名</li>
<li>机器名</li>
<li>用户、组SID（Adminastrator在window中SID默认为500）</li>
</ol>
</li>
<li><p><strong><code>🔺命令：nmap -v（详细结果） -p 139,445 IP地址</code></strong>（较粗糙扫描，还不能判断win还是linux）</p>
</li>
<li><p><strong><code>🔺命令：nmap IP地址 -p139,445 --script=smb-os-discovery.nse</code></strong></p>
</li>
<li><p><strong><code>🔺命令：nmap -v -p 139,445 --script=smb-check-vulns --script-args=unsafe=1（进行不安全的扫描，快，准确，可能会宕机） IP地址</code></strong> ▲2019.12.6 script无smb-check-vulns脚本</p>
</li>
<li><p><strong><code>🔺命令：nbtscan -r IP网段/24（可以扫出其他网段的MAC地址）</code></strong>▲2019.12.6测试暂不可扫出</p>
</li>
<li><p><strong><code>🔺命令：enum4linux -a IP地址</code></strong></p>
</li>
</ul>
<blockquote>
<pre><code>SMB Vulns（针对的是Window系统）
MS08-067，a windpws RPC vulnerability
Conficker，an infection by the Conficker worm
Unnamed regsc Dos，a denial-of-service vulnerability I accidentally found in windows 2000
SMBv2 exploit（CVE-2009-3103，Microsoft Security Advisory 975497）
MS06-025，a windows Ras RPC service vulnerability
MS07-029，a windows Dns Server RPC Service vulnerability
MS09-001，a windows Code execution from remote</code></pre></blockquote>
<blockquote>
<pre><code>SMB服务：
&lt;00&gt;   Workstation Service（共享别人的文件）
&lt;03&gt;   Messenger Service
&lt;20&gt;   File Server Service（对别人的文件共享）
&lt;1e&gt;   Browser Service Elections（浏览器服务）
▲ window下主机的SID  用户的RID
▲ linux下主机 uid，gid，groups</code></pre></blockquote>
<h4 id="12-SMTP扫描（发现目标系统的邮件账号，也可以通过被动信息收集）"><a href="#12-SMTP扫描（发现目标系统的邮件账号，也可以通过被动信息收集）" class="headerlink" title="12. SMTP扫描（发现目标系统的邮件账号，也可以通过被动信息收集）"></a>12. SMTP扫描（发现目标系统的邮件账号，也可以通过被动信息收集）</h4><ul>
<li><strong><code>🔺命令：nc -nv IP地址 端口</code></strong><ul>
<li>VRFY root（确认有无root账号）</li>
</ul>
</li>
<li><strong><code>🔺命令：nmap smtp.163.com -p 25 --script=smtp-enum-users.nse --script-args=smtp-enum-users.methods=VRFY</code></strong>（后面可加参数指定字典文件）</li>
<li><strong><code>🔺命令：nmap smtp.163.com -p 25 --script=smtp-open-relay.nse --script=smtp-user-enum -M VRFY -U（指定字典） user.txt -t IP地址</code></strong></li>
<li><strong><code>🔺命令：./smtp.py &lt;username&gt;</code></strong></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python</span><br><span class="line"></span><br><span class="line">import socket</span><br><span class="line">import sys</span><br><span class="line"></span><br><span class="line">if len(sys.argv)!=2:</span><br><span class="line">    print &quot;Usage: smtp.py &lt;username&gt;&quot;</span><br><span class="line">    sys.exit(0)</span><br><span class="line"></span><br><span class="line">s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)</span><br><span class="line">connect=s.connect((&quot;IP地址&quot;,端口))</span><br><span class="line">banner=s.recv(4096)</span><br><span class="line">print banner+&quot;aaaaa&quot;</span><br><span class="line">s.send(&apos;VRFY&apos;+sys.argv[1]+&apos;\r\n&apos;)</span><br><span class="line">result=s.recv(4096)</span><br><span class="line">print result</span><br><span class="line">s.close</span><br></pre></td></tr></table></figure>

<blockquote>
<pre><code>邮件服务器开放中继，允许其他人用邮件服务器对其他人发邮件，成为肉鸡</code></pre></blockquote>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/12/10/Kali%20Linux%E7%AC%94%E8%AE%B0(%E5%8D%81%E5%85%AB)%EF%BC%9A%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F--TCP/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Tomas">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/photo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tomas'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/12/10/Kali%20Linux%E7%AC%94%E8%AE%B0(%E5%8D%81%E5%85%AB)%EF%BC%9A%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F--TCP/" itemprop="url">Kali Linux笔记(十八)：端口扫描--TCP</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-12-10T08:13:38+08:00">
                2019-12-10
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Kali/" itemprop="url" rel="index">
                    <span itemprop="name">Kali</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1.6k 字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  8 分钟
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <hr>
<h4 id="1-端口扫描（TCP）"><a href="#1-端口扫描（TCP）" class="headerlink" title="1. 端口扫描（TCP）"></a>1. 端口扫描（TCP）</h4><ul>
<li><p>TCP端口扫描（SYN–SYN/ACK–ACK）</p>
<ul>
<li>基于连接的协议</li>
<li>三次握手（ACK包连接）</li>
<li>隐蔽扫描（隐藏与目标进程的会话）–SYN（开放 →SYN/ACK，不开放 → RST）</li>
</ul>
<ol>
<li>不建立完整连接（SYN（开放 →SYN/ACK，不开放 → RST））</li>
<li>应用日志不记录扫描行为–隐蔽（但审计网络层，还是可以发现）</li>
</ol>
<ul>
<li>僵尸扫描（几乎不和目标进程尝试会话）</li>
</ul>
<ol>
<li>极度隐蔽</li>
<li>实施条件苛刻</li>
<li>可伪造源地址（▲扫描者与目标主机必须可以实现地址伪造）</li>
<li>选择僵尸机（▲必须要有，网络中闲置的机子，不同于僵尸网络的机子）<ul>
<li>闲置系统</li>
<li>系统使用递增的IPID：（1）不能为0 （2）不能为随机</li>
</ul>
</li>
</ol>
<ul>
<li>全连接扫描（三次握手连接）</li>
<li>所有的TCP扫描方式都是基于三次握手的变化来判断目标端口状态</li>
</ul>
</li>
</ul>
<blockquote>
<pre><code>IPID:IP报头里面的Identification字段
1.僵尸扫描过程（端口开放）：
（1）Scanner【SYN/ACK】 -- Zombie【RST IPID=X】
（2）Scanner【SYN IPSRC=zombie】 -- target【SYN/ACK】 -- Zombie【RST IPID=x+1,(僵尸机需要足够空闲)】
（3）Scanner【SYN/ACK】 -- Zombie【RST IPID=x+2】
2.僵尸扫描进程（端口未开放）：
（1）Scanner【SYN/ACK】 -- Zombie【RST IPID=X】
（2）Scanner【SYN IPSRC=zombie】 -- target【RST】 -- Zombie
（3）Scanner【SYN/ACK】 -- Zombie【RST IPID=x+1】</code></pre></blockquote>
<h4 id="2-隐蔽端口扫描"><a href="#2-隐蔽端口扫描" class="headerlink" title="2. 隐蔽端口扫描"></a>2. 隐蔽端口扫描</h4><ul>
<li>syn–syn/ack–rst（本机操作系统内核产生的）</li>
<li>Scapy<ul>
<li>sr1(IP(dst=”IP地址”)/TCP(dport=80,flags=”S”),timeout=1,verbose=0)</li>
<li><strong><code>🔺命令：./syn_scan.py 目标IP地址 起始端口 结束端口</code></strong></li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python</span><br><span class="line">import logging</span><br><span class="line">logging.getLogger(&quot;scapy.runtime&quot;).setLevel(logging.ERROR)</span><br><span class="line">from scapy.all import *</span><br><span class="line">import time</span><br><span class="line">import sys</span><br><span class="line"></span><br><span class="line">if len(sys.argv)!=4:</span><br><span class="line">    print &quot;Usage - ./syn_scan.py [Target IP] [First IP] [Last IP] &quot;</span><br><span class="line">    print &quot;Example - ./syn_scan.py 192.168.100.1 1 200&quot;</span><br><span class="line">    print &quot;Example will perform a TCP SYN scan of the 192.168.100.0/24 range&quot;</span><br><span class="line">    sys.exit()</span><br><span class="line"></span><br><span class="line">ip=sys.argv[1]</span><br><span class="line">start=int(sys.argv[2])</span><br><span class="line">end=int(sys.argv[3])</span><br><span class="line"></span><br><span class="line">for port in range(start,end):</span><br><span class="line">    a=sr1(IP(dst=ip)/TCP(dport=port),timeout=1,verbose=0)</span><br><span class="line">    if a==None:</span><br><span class="line">      pass</span><br><span class="line">    else:</span><br><span class="line">      if int(a[TCP].flags)==18:</span><br><span class="line">        print port</span><br><span class="line">      else:</span><br><span class="line">        pass</span><br></pre></td></tr></table></figure>

<blockquote>
<pre><code>正常情况下：
端口开放：syn--syn/ack
端口未开放：syn--rst/ack</code></pre></blockquote>
<h4 id="3-隐蔽端口扫描"><a href="#3-隐蔽端口扫描" class="headerlink" title="3. 隐蔽端口扫描"></a>3. 隐蔽端口扫描</h4><ul>
<li><strong><code>🔺命令：nmap -sS IP地址 -p 80,21,25,110,443</code></strong></li>
<li><strong><code>🔺命令：nmap -sS IP地址 -p 1-65535 --open</code></strong></li>
<li><strong><code>🔺命令：nmap -sS IP地址 --open</code></strong></li>
<li><strong><code>🔺命令：nmap -sS -iL iplist.txt -p 80,21,22,23</code></strong></li>
</ul>
<h4 id="4-隐蔽端口扫描"><a href="#4-隐蔽端口扫描" class="headerlink" title="4. 隐蔽端口扫描"></a>4. 隐蔽端口扫描</h4><ul>
<li>hping3（发包习惯是顺序端口）</li>
<li><strong><code>🔺命令：hping3 IP地址 --scan 80 -S</code></strong></li>
<li><strong><code>🔺命令：hping3 IP地址 --scan 80,21,25,443 -S</code></strong>（syn包）</li>
<li><strong><code>🔺命令：hping3 IP地址 --scan 0-65535 -S</code></strong></li>
<li><strong><code>🔺命令：hping3 -c 10 -S --spoof（伪造源地址） IP地址 -p ++1（端口递增） IP地址</code></strong></li>
</ul>
<h4 id="5-全连接端口扫描"><a href="#5-全连接端口扫描" class="headerlink" title="5. 全连接端口扫描"></a>5. 全连接端口扫描</h4><ul>
<li>Scapy（容易触发目标主机的报警系统）<ul>
<li>syn扫描不需要raw packets</li>
<li>内核认为syn/ack是非法包，直接发rst终断连接</li>
<li>全连接扫描对scapy比较困难</li>
</ul>
</li>
<li>sr1(IP(dst=”IP地址”)/TCP(dport=22,flags=”S”))</li>
<li><strong><code>🔺命令：./tcp_scan1.py（代码内指定IP地址）</code></strong></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python</span><br><span class="line">import logging</span><br><span class="line">logging.getLogger(&quot;scapy,runtime&quot;).setLevel(logging.ERROR)</span><br><span class="line">from scapy.all import*</span><br><span class="line"></span><br><span class="line">response=sr1(IP(dst=&quot;IP地址&quot;)/TCP(dport=80,flags=&quot;S&quot;))</span><br><span class="line">reply=sr1(IP(dst=&quot;IP地址&quot;)/TCP(dport=80,flags=&quot;A&quot;,ack=(response[TCP].seq+1)))</span><br></pre></td></tr></table></figure>

<ul>
<li><strong><code>🔺命令：./tcp_scan2.py（代码内指定IP地址）</code></strong></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python</span><br><span class="line">import logging</span><br><span class="line">logging.getLogger(&quot;scapy,runtime&quot;).setLevel(logging.ERROR)</span><br><span class="line">from scapy.all import*</span><br><span class="line"></span><br><span class="line">SYN=IP(dst=&quot;IP地址&quot;)/TCP(dport=25,flags=&quot;S&quot;)</span><br><span class="line"></span><br><span class="line">print &quot;--SENT--&quot;</span><br><span class="line">SYN.display()</span><br><span class="line"></span><br><span class="line">print &quot;\n\n--RECEIVED--&quot;</span><br><span class="line">response=sr1(SYN,timeout=1,verbose=0)</span><br><span class="line">response.display()</span><br><span class="line"></span><br><span class="line">if int(response[TCP].flags)==18:</span><br><span class="line">    print &quot;\n\n--SENT--&quot;</span><br><span class="line">    A=IP(dst=&quot;IP地址&quot;)/TCP(dport=25,flags=&quot;A&quot;,ack=(response[TCP].seq+1))</span><br><span class="line">    A.display()</span><br><span class="line">    print &quot;\n\n--RECEIVED--&quot;</span><br><span class="line">    response2=sr1(A,timeout=1,verbose=0)</span><br><span class="line">    response2.display()</span><br><span class="line">else:</span><br><span class="line">    print &quot;SYN-ACK not returned&quot;</span><br></pre></td></tr></table></figure>

<ul>
<li><strong><code>🔺命令：iptables -A OUTPUT -p tcp --tcp-flags RST RST -d 目标IP地址 -j DROP</code></strong></li>
</ul>
<blockquote>
<pre><code>iptables是工作在底层的防火墙，在内核之前过滤数据
iptables -L查看当前防火墙规则</code></pre></blockquote>
<h4 id="6-全连接端口扫描"><a href="#6-全连接端口扫描" class="headerlink" title="6. 全连接端口扫描"></a>6. 全连接端口扫描</h4><ul>
<li><strong><code>🔺命令：nmap IP地址 -sT -p 80</code></strong></li>
<li><strong><code>🔺命令：nmap IP地址 -sT -p 80,21,25</code></strong></li>
<li><strong><code>🔺命令：nmap IP地址 -sT -p 1-65535</code></strong></li>
<li><strong><code>🔺命令：nmap -sT -iL iplist.txt -p 80</code></strong></li>
<li>默认1000个常用端口</li>
</ul>
<h4 id="7-全连接端口扫描"><a href="#7-全连接端口扫描" class="headerlink" title="7. 全连接端口扫描"></a>7. 全连接端口扫描</h4><ul>
<li>dmitry<ul>
<li>功能简单，但使用简便</li>
<li>默认150个常用端口</li>
</ul>
</li>
<li><strong><code>🔺命令：dmitry -p IP地址</code></strong></li>
<li><strong><code>🔺命令：dmitry -p IP地址 -o output</code></strong></li>
</ul>
<h4 id="8-全连接端口扫描"><a href="#8-全连接端口扫描" class="headerlink" title="8. 全连接端口扫描"></a>8. 全连接端口扫描</h4><ul>
<li><strong><code>🔺命令：nc -nv -w（连接的超时时间）1 -z IP地址 1-65535</code></strong>（倒序发送）</li>
<li><strong><code>🔺命令：for x in $(seq 20 30);do nc -nv -w 1 -z IP地址 $x;done | grep open</code></strong></li>
<li><strong><code>🔺命令：for x in $(seq 1 254);do nc -nv -w 1 -z 1.1.1.$x 80;done</code></strong></li>
</ul>
<h4 id="9-僵尸扫描"><a href="#9-僵尸扫描" class="headerlink" title="9. 僵尸扫描"></a>9. 僵尸扫描</h4><blockquote>
<pre><code>早期的Window系统，包括XP,2003,98系统的IPID是递增的</code></pre></blockquote>
<ul>
<li>Scapy–zomebie.py<ul>
<li>i=IP()</li>
<li>t=TCP()</li>
<li>rz=(i/t)</li>
<li>rt=(i/t)</li>
<li>rz[IP].dst=”zombie IP地址”</li>
<li>rz[TCP].dport=445</li>
<li>rz[TCP].flags=”SA”</li>
<li>rt[IP].src=”zombie IP地址”</li>
<li>rt[IP].dst=”target IP地址”</li>
<li>rt[TCP].dport=22</li>
<li>rt[TCP].flags=”S”</li>
<li>az1=sr1(rz) / at=sr1(rt,timeout=1) / az2=sr1(rz)</li>
<li>az1.display() / az2.display()</li>
</ul>
</li>
<li><strong><code>🔺命令：./zombie.py</code></strong></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python</span><br><span class="line">import logging</span><br><span class="line">logging.getLogger(&quot;scapy,runtime&quot;).setLevel(logging.ERROR)</span><br><span class="line">from scapy.all import*</span><br><span class="line"></span><br><span class="line">def ipid(zombie):</span><br><span class="line">    reply1=sr1(IP(dst=zombie)/TCP(flags=&quot;SA&quot;),timeout=2,verbose=0)</span><br><span class="line">    send(IP(dst=zombie)/TCP(flags=&quot;SA&quot;),verbose=0)</span><br><span class="line">    reply2=sr1(IP(dst=zombie)/TCP(flags=&quot;SA&quot;),timeout=2,verbose=0)</span><br><span class="line">    if reply2[IP].id==(reply1[IP].id+2):</span><br><span class="line">      print &quot;IPID sequence is incremental and target appears to be idle.ZOMBIE LOCATED&quot;</span><br><span class="line">      response=raw_input(&quot;DO you want to use this zombie to perfore scan?(Y or N):&quot;)</span><br><span class="line">      if response==&quot;Y&quot;:</span><br><span class="line">        target=raw_input(&quot;Enter the IP Address of the target system:&quot;)</span><br><span class="line">        zombiescant(target,zombie)</span><br><span class="line">    else:</span><br><span class="line">      print &quot;Either the IPID sequence is not incremental or the target is not idle.NOT A GOOD ZOMBIE&quot;</span><br><span class="line"></span><br><span class="line">def zombiescan(target,zombie):</span><br><span class="line">    print &quot;\nScanning target &quot;+target+&quot; with zombie &quot;+zombie</span><br><span class="line">    print &quot;\n-----------Open Ports On Target-------------\n &quot;</span><br><span class="line">    for port in range(1,100):</span><br><span class="line">      try:</span><br><span class="line">        start_val=sr1(IP(dst=zombie)/TCP(flags=&quot;SA&quot;,dport=port),timeout=2,verbose=0)</span><br><span class="line">        send(IP(src=zombie,dst=target)/TCP(flags=&quot;S&quot;,dport=port),verbose=0)</span><br><span class="line">        end_val=sr1(IP(dst=zombie)/TCP(flags=&quot;SA&quot;,dport=port),timeout=2,verbose=0)</span><br><span class="line">        if end_val[IP].id==(start_val[IP].id+2):</span><br><span class="line">          print port</span><br><span class="line">      except:</span><br><span class="line">        pass</span><br><span class="line"></span><br><span class="line">print &quot;----------------Zombie Scan Suite-----------\n&quot;</span><br><span class="line">print &quot;1 - Identify Zombie Host\n&quot;</span><br><span class="line">print &quot;2 - Perform Zombie Scan\n&quot;</span><br><span class="line">ans=raw_input(&quot;Select an Option (1 or 2):&quot;)</span><br><span class="line">if ans==&quot;1&quot;:</span><br><span class="line">    zombie=raw_input(&quot;Enter IP Address to test IPID sequence&quot;)</span><br><span class="line">    ipid(zombie)</span><br><span class="line">else:</span><br><span class="line">    if ans==&quot;2&quot;:</span><br><span class="line">      zombie=raw_input(&quot;Enter IP Address for zombie sysytem:&quot;)</span><br><span class="line">      target=raw_input(&quot;Enter IP Address for scan target:&quot;)</span><br><span class="line">      zombiescan(target,zombie)</span><br></pre></td></tr></table></figure>

<blockquote>
<pre><code>sr1 发包只收一个数据包
send 发包不收数据包</code></pre></blockquote>
<h4 id="10-僵尸扫描"><a href="#10-僵尸扫描" class="headerlink" title="10. 僵尸扫描"></a>10. 僵尸扫描</h4><ul>
<li>发现僵尸机<ul>
<li><strong><code>🔺命令：nmap -p445 IP地址 --script=ipidseq.nse</code></strong></li>
</ul>
</li>
<li>扫描目标<ul>
<li><strong><code>🔺命令：nmap target的IP地址 -sI（指定zombie） zomboe的IP地址 -Pn -p 0-100</code></strong></li>
</ul>
</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/12/10/Kali%20Linux%E7%AC%94%E8%AE%B0(%E4%BA%8C%E5%8D%81%E4%B8%80)%EF%BC%9ANAMP/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Tomas">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/photo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tomas'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/12/10/Kali%20Linux%E7%AC%94%E8%AE%B0(%E4%BA%8C%E5%8D%81%E4%B8%80)%EF%BC%9ANAMP/" itemprop="url">Kali Linux笔记(二十一)：NMAP</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-12-10T08:13:38+08:00">
                2019-12-10
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Kali/" itemprop="url" rel="index">
                    <span itemprop="name">Kali</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  681 字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  2 分钟
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <hr>
<h4 id="1-NMAP"><a href="#1-NMAP" class="headerlink" title="1. NMAP"></a>1. NMAP</h4><ul>
<li>所有参数</li>
<li>目标发现<ul>
<li>-iL <inputfilename>（列表文件作为输入）</li>
<li>-iR <num hosts>（随机选择目标进行扫描）</li>
<li>–exclude &lt;host1[,host2]&gt;（扫描网址段不包含）</li>
<li>–excludefile <exclude_file>（排除文件）</li>
</ul>
</li>
<li>主机发现<ul>
<li>-sL（不做扫描，列出地址段）</li>
<li>-sn（ping扫描，不做端口扫描）</li>
<li>-Pn（彻底扫描地址段，不回包也进行扫描）</li>
<li>-PS/PA/PU/PY （TCP SYN/ACK，UDP or SCTP发现）</li>
<li>-P0/PS/PE/PP/PM （Ping层的发现/SCTP发现/ICMP echo/时间戳/子网掩码发现）</li>
<li>-n/-R （不做DNS解析/自动做反向解析）</li>
<li>–dns-servers &lt;serv1[,serv2]&gt;（指定DNS解析服务器）</li>
<li>–system-dns（操作系统默认的DNS解析服务器）</li>
<li>–traceroute（扫描进行路由追踪）</li>
</ul>
</li>
<li>端口发现<ul>
<li>sS/sT/sA/sW/sM （TCP SYN/Connect()/ACK/Window/Maimon scans）</li>
<li>sU （UDP扫描）</li>
<li>sN/sF/sX （TCP Null，Fin and xmas scans）</li>
<li>–scanflags <flags> （选择要扫描的flags）</li>
<li>-sI &lt;zombie host[:probeport]&gt;（僵尸扫描）</li>
<li>-sY/sZ （SCTP协议参数）</li>
<li>-s0（IP扫描）</li>
<li>-b <FTP relay host>（FTP中继扫描）</li>
</ul>
</li>
<li>指定扫描端口<ul>
<li>-p <port number> U → UDP T → TCP</li>
<li>–exclude-ports <port ranges> （排除端口）</li>
<li>-F （快速模式，比较少数量端口）</li>
<li>-r （连续扫描端口，少于1000个端口）</li>
<li>–top-ports <number> （扫描1000端口的前面端口）</li>
<li>–port-ratio <ratio> （扫描更常见的端口）</li>
</ul>
</li>
<li>服务/版本识别<ul>
<li>-sV （服务特征库匹配）</li>
<li>-sV –version-intensity <level> （扫描的深度、强度）</li>
<li>-sV –version-light （intensity=2）</li>
<li>-sV –version-all （intensity=9）</li>
<li>-sV –version-trace（扫描过程进行跟踪）</li>
</ul>
</li>
<li>脚本扫描<ul>
<li>-sC （脚本扫描，一般是–script=default）</li>
<li>–script=<Lua script> （使用Lua脚本）</li>
<li>–script-args=&lt;n1=v1[,n2=v2]&gt; （修改参数）</li>
<li>–script-update （脚本库更新）</li>
<li>–script-trace （进行路由追踪）</li>
<li>–script-help=<Lua scripts> （脚本使用教程帮助）</li>
</ul>
</li>
<li>OS 扫描<ul>
<li>-O （检测OS）</li>
<li>–osscan-limit （OS检测限制）</li>
<li>–osscan-guess （OS猜测）</li>
</ul>
</li>
<li>时间和性能<ul>
<li>-‘s’,’m’,’h’,’ms’ （秒、分、时、毫秒）</li>
<li>–min-hostgroup/max-hostgroup <size> （并行扫描主机组的数量）</li>
<li>–min-parallelism/max-parallelism <numprobes> （并行探测数量）</li>
<li>–min-rtt-timeout/max-rtt-timeout/initial-rtt-timeout <time> （rtt时间）</li>
<li>–max-retries <tries> （最大回包时间）</li>
<li>–host-timeout <time> （主机超时时间）</li>
<li>–scan-delay/–max-scan-delay <time> （主机延迟发包时间）</li>
<li>–min-rate <number> （最小发包速率）</li>
<li>–max-rate <number> （最大发包速率）</li>
</ul>
</li>
<li>防火墙/IDS躲避、欺骗<ul>
<li>-f –mtu <val> （设置传输单元）</li>
<li>-D &lt;decoy1,decoy2[,ME]&gt; （伪造源地址，增加噪声IP）</li>
<li>-S <IP Address> （欺骗源地址）</li>
<li>-e <iface> （指定使用的网卡）</li>
<li>-g/–source-port <portnum> （指定源端口进行发包）</li>
<li>–proxies &lt;url1,[url2]&gt; （指定代理服务器）</li>
<li>–data <hex string> （指定十六进制字符串，在包的后面增加）</li>
<li>–data-string <string> （增加ACSII码字符串）</li>
<li>–data-length <num> （数据的长度）</li>
<li>–ip-options <options> （修改IP的选项）</li>
<li>–ttl <val> （设置IP的TTL值）</li>
<li>–spoof-mac &lt;mac address/prefix/vendor name&gt; （欺骗MAC地址）</li>
<li>–badsum （发送错误的TCP/UDP/SCTP 校验和）</li>
</ul>
</li>
<li>MISC<ul>
<li>-6 （可以扫IPv6地址）</li>
<li>-A （OS，version，script，traceroute的组合命令）</li>
</ul>
</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/12/10/Kali%20Linux%E7%AC%94%E8%AE%B0(%E4%BA%8C%E5%8D%81%E4%BA%94)%EF%BC%9ANEXPOSE/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Tomas">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/photo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tomas'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/12/10/Kali%20Linux%E7%AC%94%E8%AE%B0(%E4%BA%8C%E5%8D%81%E4%BA%94)%EF%BC%9ANEXPOSE/" itemprop="url">Kali Linux笔记(二十五)：NEXPOSE</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-12-10T08:13:38+08:00">
                2019-12-10
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Kali/" itemprop="url" rel="index">
                    <span itemprop="name">Kali</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  410 字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  1 分钟
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <hr>
<h4 id="1-NEXPOSE"><a href="#1-NEXPOSE" class="headerlink" title="1. NEXPOSE"></a>1. NEXPOSE</h4><ul>
<li>Rapid7<ul>
<li>Nexpose</li>
<li>完整的漏洞管理实现</li>
</ul>
</li>
<li>环境准备<ul>
<li>建议VM 4G内存</li>
<li><a href="https://www.rapid7.com/products/nexpose/download/" target="_blank" rel="noopener">https://www.rapid7.com/products/nexpose/download/</a></li>
<li><a href="https://IP_ADDR:3780（nxadmin/nxpassword,后改为Rapid7@mazhentao）" target="_blank" rel="noopener">https://IP_ADDR:3780（nxadmin/nxpassword,后改为Rapid7@mazhentao）</a></li>
<li>操作系统账号密码：nexpose</li>
<li><a href="https://www.rapid7.com/try/nexpose/" target="_blank" rel="noopener">https://www.rapid7.com/try/nexpose/</a></li>
<li>QHWT-72GT-BHDS-FQLH（激活码进行注册，30天有效期）</li>
<li>service nexposeconsole.cc restart（重启命令，但初始化时间非常长）</li>
</ul>
</li>
</ul>
<blockquote>
<pre><code>概念：用扫描器去发现漏洞，用渗透框架去验证漏洞
▲ 2019.12.8可以注册一个企业邮箱，可申请多个（腾讯。网易等）
▲ 2019.12.8需要修改密码，至少一个数字，一个大写字母，一个字符，长度大于14位，多次不成功会锁账号 Rapid7@mazhentao
▲ 2019.12.8只有注册后，才可下载到ova文件</code></pre></blockquote>
<h4 id="2-Administrator"><a href="#2-Administrator" class="headerlink" title="2. Administrator"></a>2. Administrator</h4><ul>
<li>Scan Templates<ul>
<li>Exhaustive → Copy</li>
<li>General → Name → Types of Checks（Assert Discovery、Vulnerability、WebSpldering、Policies）</li>
<li>Asset Discovery（主机发现）</li>
<li>Service Discovery（服务发现）</li>
<li>Discovery Performance（发现选项）</li>
<li>Vulnerability Checks（unsafe or safe，<strong>！Select Checks！</strong>）</li>
<li>File Searching（文件搜索）</li>
<li>Spam Relaying（垃圾邮件）</li>
<li>Database Servers（数据库）</li>
<li>Mail Server（邮件服务器）</li>
<li>CVS Serverr（版本管理服务器）</li>
<li>DHCP Server</li>
<li>Telnet Server</li>
<li>Web Spldering（网页爬网，有可能造成CC攻击）</li>
<li>Oracle Policy（Oracle 策略）</li>
<li>Lotus Domino Policy（Lotus Domino 策略）</li>
<li>Windows Group Policy（window 组策略）</li>
<li>CIFS/SMB Account Policy（CIFS/SMB 账号策略）</li>
<li>AS/400 Policy（AS/400 机型策略）</li>
<li>Unix Policy（Unix 策略）</li>
</ul>
</li>
</ul>
<blockquote>
<pre><code>企业在美国上市需要过塞班思发案，也即404法案，Sarbans-Oxley compliance
支付行业要过PCI ASV Extemal Audit/PCI Internal Aduit</code></pre></blockquote>
<ul>
<li>Sites（在home）<ul>
<li>Create sites</li>
<li>INFO &amp; SECURITY</li>
<li>ASSETS</li>
<li>AUTHENTICATION（Web Application → HTML FORM/HTTP HEADERS（SEESIONID））</li>
<li>TEMPLATES</li>
<li>ENGINES（扫描引擎）</li>
<li>ALERTS（到点，可以用于发送mail）</li>
<li>SCHEDULE</li>
</ul>
</li>
</ul>
<h4 id="3-扫描结果分析"><a href="#3-扫描结果分析" class="headerlink" title="3. 扫描结果分析"></a>3. 扫描结果分析</h4><ul>
<li>False Positive：误报</li>
<li>False negative：漏报</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/12/10/Kali%20Linux%E7%AC%94%E8%AE%B0(%E4%BA%8C%E5%8D%81%E5%9B%9B)%EF%BC%9ANESSUS/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Tomas">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/photo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tomas'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/12/10/Kali%20Linux%E7%AC%94%E8%AE%B0(%E4%BA%8C%E5%8D%81%E5%9B%9B)%EF%BC%9ANESSUS/" itemprop="url">Kali Linux笔记(二十四)：NESSUS</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-12-10T08:13:38+08:00">
                2019-12-10
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Kali/" itemprop="url" rel="index">
                    <span itemprop="name">Kali</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  401 字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  1 分钟
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <hr>
<h4 id="1-NESSUS"><a href="#1-NESSUS" class="headerlink" title="1. NESSUS"></a>1. NESSUS</h4><ul>
<li>家庭版<ul>
<li>免费</li>
</ul>
</li>
<li>专业版<ul>
<li>收费，无限的并发连接</li>
</ul>
</li>
<li>下载<ul>
<li><a href="https://www.tenable.com/downloads/nessus" target="_blank" rel="noopener">https://www.tenable.com/downloads/nessus</a></li>
</ul>
</li>
<li>安装<ul>
<li><strong><code>🔺命令：dpkg -i 文件dbg</code></strong></li>
<li>安装路径：/opt/nessus</li>
</ul>
</li>
<li>启动服务<ul>
<li><strong><code>🔺命令：/etc/init.d/nessusd start</code></strong></li>
<li><strong><code>🔺命令：/etc/init.d/nessusd status</code></strong>（查看状态）</li>
</ul>
</li>
<li>管理地址<ul>
<li><a href="https://127.0.0.1:8834" target="_blank" rel="noopener">https://127.0.0.1:8834</a></li>
</ul>
</li>
<li>注册激活码<ul>
<li><a href="https://www.tenable.com/products/nessus/nessus-essentials" target="_blank" rel="noopener">https://www.tenable.com/products/nessus/nessus-essentials</a></li>
</ul>
</li>
<li>管理账号<ul>
<li>更新插件</li>
</ul>
</li>
<li>基本配置（setting）<ul>
<li>升级</li>
<li>账号</li>
<li>SMTP</li>
<li>代理</li>
</ul>
</li>
<li>Policy Library<ul>
<li>Advanced Scan（高级扫描）</li>
<li>Basic Shellshock Detection（检测破壳漏洞，系统的环境变量）</li>
<li>Basic Network Scan（基本网络扫描，for any host）</li>
<li>Credentialed Patch Audit（身份验证补丁）</li>
<li>GHOST（glibc）Detection（底层C语言模块漏洞）</li>
<li>Host Discovery（主机发现）</li>
<li>Web Applicattion Test（针对Web的漏洞，XSS,CSRF,SQL注入等）</li>
<li>Windows Mainware Scan（扫描恶意软件，计算恶意程序的哈希值，生成列表，来匹配）</li>
</ul>
</li>
</ul>
<h4 id="2-NESSUS扫描（window）"><a href="#2-NESSUS扫描（window）" class="headerlink" title="2. NESSUS扫描（window）"></a>2. NESSUS扫描（window）</h4><ul>
<li>Advanced Scan → Setting<ul>
<li>Basic → General（Name → window_vuln_scan_policy）</li>
<li>Basic → Permissions</li>
<li>Discovery → Host Discovery（Use fast network discovery，Add File（添加MAC地址））</li>
<li>Discovery → Prot Scanning（Ports → defult，TCP → SYN）</li>
<li>Discovery → Service Discovery（All Ports，Enable all SSL ciphers，Enable CRL checking）</li>
<li>Assessment → Web Application（open）</li>
<li>Advanced（not safe）</li>
</ul>
</li>
<li>Advanced Scan → Credentials（证书，证明提高）</li>
<li>Advanced Scan → Compliance（合规性）</li>
<li>Advanced Scan → Plugins（类似于openvas的family，插件）</li>
<li>New Scan → window_vuln_scan_policy  ▲ 2019.12.8 SMTP 25端口无法连接socket<ul>
<li>setting → send Email（SMTP Server）</li>
<li>Host：<a href="mailto:smtp@163.com" target="_blank" rel="noopener">smtp@163.com</a></li>
<li>Port：25</li>
<li>From：<a href="mailto:nessus@163.com" target="_blank" rel="noopener">nessus@163.com</a></li>
<li>Encryption：Use TLS if available</li>
<li>Hostname：localhost：8834</li>
<li>Auth Method：PLAIN</li>
<li>Username/Password   </li>
</ul>
</li>
</ul>
<blockquote>
<pre><code>windows增加用户密码：net user 用户 -
可添加一个针对Linux系统的Advabced Scan（linux_vuln_scan_policy）
可通过设置User Profile → API Keys来设置Access Key和Secret Key</code></pre></blockquote>
<h4 id="3-NESSUS"><a href="#3-NESSUS" class="headerlink" title="3. NESSUS"></a>3. NESSUS</h4><ul>
<li>策略</li>
<li>扫描</li>
<li>扫描本机</li>
<li>扫描windows</li>
<li>扫描Linux</li>
<li>扫描网络设备</li>
<li>扫描web server</li>
<li>报告</li>
<li>调度</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/12/10/Kali%20Linux%E7%AC%94%E8%AE%B0(%E4%BA%8C%E5%8D%81%E4%B8%89)%EF%BC%9AOPENVAS/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Tomas">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/photo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tomas'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/12/10/Kali%20Linux%E7%AC%94%E8%AE%B0(%E4%BA%8C%E5%8D%81%E4%B8%89)%EF%BC%9AOPENVAS/" itemprop="url">Kali Linux笔记(二十三)：OPENVAS</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-12-10T08:13:38+08:00">
                2019-12-10
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Kali/" itemprop="url" rel="index">
                    <span itemprop="name">Kali</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  638 字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  2 分钟
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <hr>
<h4 id="1-OPENVAS"><a href="#1-OPENVAS" class="headerlink" title="1. OPENVAS"></a>1. OPENVAS</h4><ul>
<li>Openvas<ul>
<li>Nessus项目分支</li>
<li>管理目标系统的漏洞</li>
<li>免费开源</li>
<li>Kali默认安装，但未配置和启动</li>
</ul>
</li>
</ul>
<h4 id="2-OPENVAS"><a href="#2-OPENVAS" class="headerlink" title="2. OPENVAS"></a>2. OPENVAS</h4><ul>
<li>安装</li>
<li>创建证书</li>
<li>同步弱点数据库NVT</li>
<li>创建客户端证书</li>
<li>重建数据库</li>
<li>备份数据库</li>
<li>启动服务装入插件</li>
<li>创建管理员账户</li>
<li>创建普通用户账号</li>
<li>配置服务侦听端口</li>
<li>安装验证</li>
</ul>
<blockquote>
<pre><code>Kali Linux配置OPENVAS，openvas-setup，现在一条命令即可
OPENVAS每天会发布feed，里面包含由一个或多个NVT</code></pre></blockquote>
<h4 id="3-OPENVAS"><a href="#3-OPENVAS" class="headerlink" title="3. OPENVAS"></a>3. OPENVAS</h4><ul>
<li>OpenVAS Manager（负责把其他的组件连接）<ul>
<li>控制Scanner和其他Manager的中心组件</li>
<li>控制中心数据库，保存用户配置及扫描结果</li>
<li>客户端使用基于XML的无状态OMP协议与其通信</li>
<li>集中排序筛选，使客户端获得一致展现</li>
</ul>
</li>
<li>OpenVAS Scanner（扫描器，可以多个scanner，多级部署）<ul>
<li>具体执行Network Vulnerability Tests（NVTs）</li>
<li>NVTs 每天通过更新Feed更新</li>
<li>受Manager控制</li>
</ul>
</li>
<li>OSP Scanner（scanner扫描器组）<ul>
<li>可以统一管理多个Scanner</li>
<li>将一组Scanner作为一个对象交给manager管理</li>
</ul>
</li>
<li>Greenbone Security Assistant（相当于一个服务器端，访问OpenVASManage）<ul>
<li>提高Web Service</li>
</ul>
</li>
<li>OMP Clients（支持通过API的方式去调用OpenVAS Manager）</li>
<li>Web Browser（通过GreenBone去访问OpenVAS Manager）</li>
<li>Feed（NVTS，SCAP CERT,User Data） </li>
<li>Target System</li>
<li>OpenVAS CLI<ul>
<li>omp命令行工具，可实现批处理控制manager</li>
</ul>
</li>
<li>更新很快<ul>
<li>所有找得到的资料几乎都已不同程度的过时了</li>
</ul>
</li>
</ul>
<h4 id="4-OPENVAS"><a href="#4-OPENVAS" class="headerlink" title="4. OPENVAS"></a>4. OPENVAS</h4><ul>
<li>初始化安装<ul>
<li><strong><code>🔺命令：openvas-setup</code></strong></li>
</ul>
</li>
<li>检查安装结果<ul>
<li><strong><code>🔺命令：openvas-check-setup</code></strong>（出问题会出现FIX错误项）</li>
</ul>
</li>
<li>查看当前账号<ul>
<li><strong><code>🔺命令：openvasmd --list-users</code></strong> ▲2019.12.7 无此参数</li>
</ul>
</li>
<li>修改账户密码<ul>
<li><strong><code>🔺命令：openvas --user=admin --new-password=Password</code></strong></li>
</ul>
</li>
<li>升级<ul>
<li><strong><code>🔺命令：openvas-feed-update</code></strong></li>
</ul>
</li>
</ul>
<blockquote>
<pre><code>openvasmd -h 可修改账户密码，可增加账户
9390端口：openvas manager
9391端口：默认第一scanner
9392端口：web登陆（https）
openvas-check-setup | grep Fix 可查看报错的组件
证书报错的原因：（1）名称与URL地址不一致（2）证书为自签名证书</code></pre></blockquote>
<h4 id="5-OPENVAS"><a href="#5-OPENVAS" class="headerlink" title="5. OPENVAS"></a>5. OPENVAS</h4><ul>
<li><strong><code>🔺命令：vi /usr/bin/openvas-start</code></strong>（调整启动服务顺序，对于kali2.0版本以下）<ul>
<li>Starting OpenVas Services</li>
<li>3\Starting OpenVas Manager.openvasmd</li>
<li>2\Starting OpenVas Scanner.openvassd</li>
<li>1\Starting Greenbone Security Assistant:gsad</li>
</ul>
</li>
<li>openvas-start</li>
</ul>
<h4 id="6-OPENVAS"><a href="#6-OPENVAS" class="headerlink" title="6. OPENVAS"></a>6. OPENVAS</h4><ul>
<li>Configration<ul>
<li>scan configs → windows_server_scan_configration</li>
<li>target → windows_xp（Alive Test → Consider Alive，Port List）</li>
<li>Port List → windows_xp_ports （or OpenVAS Default）</li>
<li>Schedules → weekly_scan（Period，Duration）</li>
</ul>
</li>
<li>Scan Management<ul>
<li>Tasks → weekly_windows_scan_task（Scan Target，Schedule，Add results to Asset Management，OpenVAS Scanner，Scan config，Slave，Network Sourece Interface，Order for target hosts，Maximum concurrently executed NVTs per host，Maximum concurrently scanner host）</li>
</ul>
</li>
<li>Configration<ul>
<li>scan configs → linux_unix_scan_configration</li>
</ul>
</li>
<li>start a short scan（full and fast，需要一个IP） ▲2019.12.7新版在Task Wizard中</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/10/">Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/10/">10</a><span class="page-number current">11</span><a class="page-number" href="/page/12/">12</a><span class="space">&hellip;</span><a class="page-number" href="/page/14/">14</a><a class="extend next" rel="next" href="/page/12/">Next</a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/photo.jpg"
                alt="Tomas" />
            
              <p class="site-author-name" itemprop="name">Tomas</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">131</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">5</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">7</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/Tomassky" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:tomassky7@gmail.com" target="_blank" title="Gmail邮箱">
                      
                        <i class="fa fa-fw fa-envelope"></i>Gmail邮箱</a>
                  </span>
                
            </div>
          

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-block">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                Links
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="https://ylsword-cheat.top" title="LengSword" target="_blank">LengSword</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://neigeshoufu.github.io/ljy.github.io" title="neigeshoufu" target="_blank">neigeshoufu</a>
                  </li>
                
              </ul>
            </div>
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Tomas</span>

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
      <span class="post-meta-item-text">Site words total count&#58;</span>
    
    <span title="Site words total count">116.5k</span>
  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
