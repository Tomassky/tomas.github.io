<!DOCTYPE html>
<html lang="zh-CN">





<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/apple-touch-icon.png">
  <link rel="icon" type="image/png" href="/img/default.png">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="">
  <meta name="author" content="Tomas">
  <meta name="keywords" content="">
  <title>XSS靶场--xss-labs - Tomas&#39;Blog</title>

  <link  rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/5.12.1/css/all.min.css" />
<link  rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/css/bootstrap.min.css" />
<link  rel="stylesheet" href="https://cdn.staticfile.org/mdbootstrap/4.13.0/css/mdb.min.css" />
<link  rel="stylesheet" href="https://cdn.staticfile.org/github-markdown-css/3.0.1/github-markdown.min.css" />
<link rel="stylesheet" href="//at.alicdn.com/t/font_1067060_qzomjdt8bmp.css">


  <link  rel="stylesheet" href="/lib/prettify/tomorrow.min.css" />

<link  rel="stylesheet" href="/css/main.css" />


  <link defer rel="stylesheet" href="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.css" />


<!-- 自定义样式保持在最底部 -->


</head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>Tomas'Blog</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/about/">首页</a>
          </li>
        
          
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/archives/">归档</a>
          </li>
        
          
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/categories/">分类</a>
          </li>
        
          
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/tags/">标签</a>
          </li>
        
          
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/links/">友链</a>
          </li>
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="view intro-2" id="background" parallax=true
         style="background: url('/img/default.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask rgba-black-light flex-center">
          <div class="container text-center white-text fadeInUp">
            <span class="h2" id="subtitle">
              
            </span>

            
              
                <p class="mt-3 post-meta">
                  <i class="fas fa-calendar-alt" aria-hidden="true"></i>
                  星期一, 三月 30日 2020, 10:54 晚上
                </p>
              

              <p class="mt-1">
                
                  
                  <span class="post-meta">
                    <i class="far fa-chart-bar"></i>
                    6.9k 字
                  </span>
                

                
                  
                  <span class="post-meta">
                      <i class="far fa-clock"></i>
                      35 分钟
                  </span>
                

                
                  <!-- 不蒜子统计文章PV -->
                  
                  <span id="busuanzi_container_page_pv" class="post-meta" style="display: none">
                    <i class="far fa-eye" aria-hidden="true"></i>
                    <span id="busuanzi_value_page_pv"></span> 次
                  </span>
                
              </p>
            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid">
  <div class="row">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-md">
      <div class="container nopadding-md" id="board-ctn">
        <div class="py-5 z-depth-3" id="board">
          <div class="post-content mx-auto" id="post">
            
              <p
                class="note note-warning">本文最后更新于：星期一, 三月 30日 2020, 10:54 晚上</p>
            
            <div class="markdown-body">
              <hr>
<h4 id="1-level-1"><a href="#1-level-1" class="headerlink" title="1. level-1"></a>1. level-1</h4><ul>
<li>没有输入框，但url地址栏可以进行输入</li>
<li>插入特殊字段尝试<code>&#39;&quot;&lt;&gt;6666</code>，发现页面也出现了相应的内容</li>
<li>F12查看源代码，没有过滤和转义</li>
<li>直接插入弹窗尝试：<code>&lt;script&gt;alert(1)&lt;/script&gt;</code></li>
<li>⭐ 成功弹窗</li>
<li>源码分析<ul>
<li>没有任何过滤</li>
</ul>
</li>
</ul>
<pre><code>&lt;!DOCTYPE html&gt;&lt;!--STATUS OK--&gt;&lt;html&gt;
&lt;head&gt;
&lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html;charset=utf-8&quot;&gt;
&lt;script&gt;
window.alert = function()  
{     
confirm(&quot;完成的不错！&quot;);
 window.location.href=&quot;level2.php?keyword=test&quot;; 
}
&lt;/script&gt;
&lt;title&gt;欢迎来到level1&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h1 align=center&gt;欢迎来到level1&lt;/h1&gt;
&lt;?php 
ini_set(&quot;display_errors&quot;, 0);
$str = $_GET[&quot;name&quot;];
echo &quot;&lt;h2 align=center&gt;欢迎用户&quot;.$str.&quot;&lt;/h2&gt;&quot;;
?&gt;
&lt;center&gt;&lt;img src=level1.png&gt;&lt;/center&gt;
&lt;?php 
echo &quot;&lt;h3 align=center&gt;payload的长度:&quot;.strlen($str).&quot;&lt;/h3&gt;&quot;;
?&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre><h4 id="2-level-2"><a href="#2-level-2" class="headerlink" title="2. level-2"></a>2. level-2</h4><ul>
<li>插入特殊字段尝试<code>&#39;&quot;&lt;&gt;6666</code></li>
<li>F12查看源代码，发现是在input标签，value属性中的，也没有进行过滤和转义</li>
<li>插入Onclick事件：<code>q&quot; onclick=&quot;alert(1)</code></li>
<li>⭐ 点击q，成功弹窗</li>
<li>源码分析<ul>
<li>htmlspecialchars()函数，但是只是对输出校验，未对输入校验</li>
</ul>
</li>
</ul>
<pre><code>&lt;!DOCTYPE html&gt;&lt;!--STATUS OK--&gt;&lt;html&gt;
&lt;head&gt;
&lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html;charset=utf-8&quot;&gt;
&lt;script&gt;
window.alert = function()  
{     
confirm(&quot;完成的不错！&quot;);
 window.location.href=&quot;level3.php?writing=wait&quot;; 
}
&lt;/script&gt;
&lt;title&gt;欢迎来到level2&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h1 align=center&gt;欢迎来到level2&lt;/h1&gt;
&lt;?php 
ini_set(&quot;display_errors&quot;, 0);
$str = $_GET[&quot;keyword&quot;];
echo &quot;&lt;h2 align=center&gt;没有找到和&quot;.htmlspecialchars($str).&quot;相关的结果.&lt;/h2&gt;&quot;.&#39;&lt;center&gt;
&lt;form action=level2.php method=GET&gt;
&lt;input name=keyword  value=&quot;&#39;.$str.&#39;&quot;&gt;
&lt;input type=submit name=submit value=&quot;搜索&quot;/&gt;
&lt;/form&gt;
&lt;/center&gt;&#39;;
?&gt;
&lt;center&gt;&lt;img src=level2.png&gt;&lt;/center&gt;
&lt;?php 
echo &quot;&lt;h3 align=center&gt;payload的长度:&quot;.strlen($str).&quot;&lt;/h3&gt;&quot;;
?&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre><h4 id="3-level-3"><a href="#3-level-3" class="headerlink" title="3. level-3"></a>3. level-3</h4><ul>
<li>插入特殊字段尝试<code>&#39;&quot;&lt;&gt;6666</code></li>
<li>F12查看源代码，发现是在input标签，value属性中的，除了单引号，其他的都进行了转义</li>
</ul>
<p><img src="/images/xss/xss-lab/level-3--%E8%BD%AC%E4%B9%89.png" srcset="/img/loading.gif" alt="level-3--转义"></p>
<ul>
<li>level-2的payload能用，双引号改单引号就可以</li>
<li>插入Onclick事件：<code>q&#39; onclick=&#39;alert(1)</code></li>
<li>⭐ 点击q，成功弹窗</li>
<li>源码分析<ul>
<li>htmlspecialchars()函数，但默认的第二个参数是不对单引号进行转义</li>
</ul>
</li>
</ul>
<pre><code>&lt;!DOCTYPE html&gt;&lt;!--STATUS OK--&gt;&lt;html&gt;
&lt;head&gt;
&lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html;charset=utf-8&quot;&gt;
&lt;script&gt;
window.alert = function()  
{     
confirm(&quot;完成的不错！&quot;);
 window.location.href=&quot;level4.php?keyword=try harder!&quot;; 
}
&lt;/script&gt;
&lt;title&gt;欢迎来到level3&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h1 align=center&gt;欢迎来到level3&lt;/h1&gt;
&lt;?php 
ini_set(&quot;display_errors&quot;, 0);
$str = $_GET[&quot;keyword&quot;];
echo &quot;&lt;h2 align=center&gt;没有找到和&quot;.htmlspecialchars($str).&quot;相关的结果.&lt;/h2&gt;&quot;.&quot;&lt;center&gt;
&lt;form action=level3.php method=GET&gt;
&lt;input name=keyword  value=&#39;&quot;.htmlspecialchars($str).&quot;&#39;&gt;
&lt;input type=submit name=submit value=搜索 /&gt;
&lt;/form&gt;
&lt;/center&gt;&quot;;
?&gt;
&lt;center&gt;&lt;img src=level3.png&gt;&lt;/center&gt;
&lt;?php 
echo &quot;&lt;h3 align=center&gt;payload的长度:&quot;.strlen($str).&quot;&lt;/h3&gt;&quot;;
?&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre><h4 id="4-level-4"><a href="#4-level-4" class="headerlink" title="4. level-4"></a>4. level-4</h4><ul>
<li>插入特殊字段尝试<code>&#39;&quot;&lt;&gt;6666</code></li>
<li>F12查看源代码，发现是在input标签，value属性中的，对<code>&lt;&gt;</code>进行了过滤</li>
</ul>
<p><img src="/images/xss/xss-lab/level-4-%E8%BF%87%E6%BB%A4.png" srcset="/img/loading.gif" alt="level-4-过滤"></p>
<ul>
<li>那继续插入level-2的payload，插入Onclick事件：<code>q&quot; onclick=&quot;alert(1)</code></li>
<li>⭐ 点击q，成功弹窗</li>
<li>源码分析<ul>
<li>字符串匹配函数str_replace()，匹配掉<code>&lt;&gt;</code>符号</li>
</ul>
</li>
</ul>
<pre><code>&lt;!DOCTYPE html&gt;&lt;!--STATUS OK--&gt;&lt;html&gt;
&lt;head&gt;
&lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html;charset=utf-8&quot;&gt;
&lt;script&gt;
window.alert = function()  
{     
confirm(&quot;完成的不错！&quot;);
 window.location.href=&quot;level5.php?keyword=find a way out!&quot;; 
}
&lt;/script&gt;
&lt;title&gt;欢迎来到level4&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h1 align=center&gt;欢迎来到level4&lt;/h1&gt;
&lt;?php 
ini_set(&quot;display_errors&quot;, 0);
$str = $_GET[&quot;keyword&quot;];
$str2=str_replace(&quot;&gt;&quot;,&quot;&quot;,$str);
$str3=str_replace(&quot;&lt;&quot;,&quot;&quot;,$str2);
echo &quot;&lt;h2 align=center&gt;没有找到和&quot;.htmlspecialchars($str).&quot;相关的结果.&lt;/h2&gt;&quot;.&#39;&lt;center&gt;
&lt;form action=level4.php method=GET&gt;
&lt;input name=keyword  value=&quot;&#39;.$str3.&#39;&quot;&gt;
&lt;input type=submit name=submit value=搜索 /&gt;
&lt;/form&gt;
&lt;/center&gt;&#39;;
?&gt;
&lt;center&gt;&lt;img src=level4.png&gt;&lt;/center&gt;
&lt;?php 
echo &quot;&lt;h3 align=center&gt;payload的长度:&quot;.strlen($str3).&quot;&lt;/h3&gt;&quot;;
?&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre><h4 id="5-level-5"><a href="#5-level-5" class="headerlink" title="5. level-5"></a>5. level-5</h4><ul>
<li>插入特殊字段尝试<code>&#39;&quot;&lt;&gt;6666</code></li>
<li>F12查看源代码，发现无过滤和转义</li>
<li>那继续插入level-2的payload，插入Onclick事件：<code>q&quot; onclick=&quot;alert(1)</code></li>
<li>发现对onclick这个单词进行了修改</li>
</ul>
<p><img src="/images/xss/xss-lab/level-5--%E4%BF%AE%E6%94%B9.png" srcset="/img/loading.gif" alt="level-5--修改"></p>
<ul>
<li>通过伪协议触发：<code>&quot;&gt;&lt;a href=&quot;javascript:alert(1)&quot;&gt;</code></li>
<li>⭐ 点击 <code>&#39;&gt;</code>，成功弹窗</li>
<li>源码分析<ul>
<li>strtolower()函数，将字符串转为小写</li>
<li>字符串匹配函数str_replace()，将<code>&lt;script</code>转换为<code>&lt;scr_ipt</code>，将<code>on</code>转换为<code>o_n</code></li>
</ul>
</li>
</ul>
<pre><code>&lt;!DOCTYPE html&gt;&lt;!--STATUS OK--&gt;&lt;html&gt;
&lt;head&gt;
&lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html;charset=utf-8&quot;&gt;
&lt;script&gt;
window.alert = function()  
{     
confirm(&quot;完成的不错！&quot;);
 window.location.href=&quot;level6.php?keyword=break it out!&quot;; 
}
&lt;/script&gt;
&lt;title&gt;欢迎来到level5&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h1 align=center&gt;欢迎来到level5&lt;/h1&gt;
&lt;?php 
ini_set(&quot;display_errors&quot;, 0);
$str = strtolower($_GET[&quot;keyword&quot;]);
$str2=str_replace(&quot;&lt;script&quot;,&quot;&lt;scr_ipt&quot;,$str);
$str3=str_replace(&quot;on&quot;,&quot;o_n&quot;,$str2);
echo &quot;&lt;h2 align=center&gt;没有找到和&quot;.htmlspecialchars($str).&quot;相关的结果.&lt;/h2&gt;&quot;.&#39;&lt;center&gt;
&lt;form action=level5.php method=GET&gt;
&lt;input name=keyword  value=&quot;&#39;.$str3.&#39;&quot;&gt;
&lt;input type=submit name=submit value=搜索 /&gt;
&lt;/form&gt;
&lt;/center&gt;&#39;;
?&gt;
&lt;center&gt;&lt;img src=level5.png&gt;&lt;/center&gt;
&lt;?php 
echo &quot;&lt;h3 align=center&gt;payload的长度:&quot;.strlen($str3).&quot;&lt;/h3&gt;&quot;;
?&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre><h4 id="6-level-6"><a href="#6-level-6" class="headerlink" title="6. level-6"></a>6. level-6</h4><ul>
<li>插入特殊字段尝试<code>&#39;&quot;&lt;&gt;6666</code></li>
<li>F12查看源代码，发现无过滤和转义</li>
<li>那继续插入level-2的payload，插入Onclick事件：<code>q&quot; onclick=&quot;alert(1)</code></li>
<li>发现对onclick这个单词进行了修改</li>
</ul>
<p><img src="/images/xss/xss-lab/level-6--%E4%BF%AE%E6%94%B91.png" srcset="/img/loading.gif" alt="level-6--修改1"></p>
<ul>
<li>使用level-5的payload，通过伪协议触发：<code>&quot;&gt;&lt;a href=&quot;javascript:alert(1)&quot;&gt;</code></li>
<li>发现对href这个单词进行了修改</li>
</ul>
<p><img src="/images/xss/xss-lab/level-6--%E4%BF%AE%E6%94%B92.png" srcset="/img/loading.gif" alt="level-6--修改2"></p>
<ul>
<li>大小写：<code>&quot;&gt;&lt;a hRef=&quot;javascript:alert(1)&quot;&gt;</code></li>
<li>⭐ 点击 <code>&#39;&gt;</code>，成功弹窗</li>
<li>源码分析<ul>
<li>字符串匹配函数str_replace()，将<code>&lt;script</code>转换为<code>&lt;scr_ipt</code>，将<code>on</code>转换为<code>o_n</code>，将<code>src</code>转换为<code>sr_c</code>，将<code>data</code>转换为<code>da_ta</code>，将<code>href</code>转换为<code>hr_ef</code></li>
</ul>
</li>
</ul>
<pre><code>&lt;!DOCTYPE html&gt;&lt;!--STATUS OK--&gt;&lt;html&gt;
&lt;head&gt;
&lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html;charset=utf-8&quot;&gt;
&lt;script&gt;
window.alert = function()  
{     
confirm(&quot;完成的不错！&quot;);
 window.location.href=&quot;level7.php?keyword=move up!&quot;; 
}
&lt;/script&gt;
&lt;title&gt;欢迎来到level6&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h1 align=center&gt;欢迎来到level6&lt;/h1&gt;
&lt;?php 
ini_set(&quot;display_errors&quot;, 0);
$str = $_GET[&quot;keyword&quot;];
$str2=str_replace(&quot;&lt;script&quot;,&quot;&lt;scr_ipt&quot;,$str);
$str3=str_replace(&quot;on&quot;,&quot;o_n&quot;,$str2);
$str4=str_replace(&quot;src&quot;,&quot;sr_c&quot;,$str3);
$str5=str_replace(&quot;data&quot;,&quot;da_ta&quot;,$str4);
$str6=str_replace(&quot;href&quot;,&quot;hr_ef&quot;,$str5);
echo &quot;&lt;h2 align=center&gt;没有找到和&quot;.htmlspecialchars($str).&quot;相关的结果.&lt;/h2&gt;&quot;.&#39;&lt;center&gt;
&lt;form action=level6.php method=GET&gt;
&lt;input name=keyword  value=&quot;&#39;.$str6.&#39;&quot;&gt;
&lt;input type=submit name=submit value=搜索 /&gt;
&lt;/form&gt;
&lt;/center&gt;&#39;;
?&gt;
&lt;center&gt;&lt;img src=level6.png&gt;&lt;/center&gt;
&lt;?php 
echo &quot;&lt;h3 align=center&gt;payload的长度:&quot;.strlen($str6).&quot;&lt;/h3&gt;&quot;;
?&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre><h4 id="7-level-7"><a href="#7-level-7" class="headerlink" title="7. level-7"></a>7. level-7</h4><ul>
<li>插入特殊字段尝试<code>&#39;&quot;&lt;&gt;6666</code></li>
<li>F12查看源代码，发现无过滤和转义</li>
<li>那继续插入level-2的payload，插入Onclick事件：<code>q&quot; onclick=&quot;alert(1)</code></li>
<li>发现onclick的on被过滤</li>
</ul>
<p><img src="/images/xss/xss-lab/level-7-%E8%BF%87%E6%BB%A4.png" srcset="/img/loading.gif" alt="level-7-过滤"></p>
<ul>
<li>重复字符：<code>q&quot; oonnclick=&quot;alert(1)</code></li>
<li>⭐ 点击q，成功弹窗</li>
<li>源码分析<ul>
<li>strtolower()函数，将字符串转为小写</li>
<li>字符串匹配函数str_replace()，将script、on、src、data、href转换为空</li>
</ul>
</li>
</ul>
<pre><code>&lt;!DOCTYPE html&gt;&lt;!--STATUS OK--&gt;&lt;html&gt;
&lt;head&gt;
&lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html;charset=utf-8&quot;&gt;
&lt;script&gt;
window.alert = function()  
{     
confirm(&quot;完成的不错！&quot;);
 window.location.href=&quot;level8.php?keyword=nice try!&quot;; 
}
&lt;/script&gt;
&lt;title&gt;欢迎来到level7&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h1 align=center&gt;欢迎来到level7&lt;/h1&gt;
&lt;?php 
ini_set(&quot;display_errors&quot;, 0);
$str =strtolower( $_GET[&quot;keyword&quot;]);
$str2=str_replace(&quot;script&quot;,&quot;&quot;,$str);
$str3=str_replace(&quot;on&quot;,&quot;&quot;,$str2);
$str4=str_replace(&quot;src&quot;,&quot;&quot;,$str3);
$str5=str_replace(&quot;data&quot;,&quot;&quot;,$str4);
$str6=str_replace(&quot;href&quot;,&quot;&quot;,$str5);
echo &quot;&lt;h2 align=center&gt;没有找到和&quot;.htmlspecialchars($str).&quot;相关的结果.&lt;/h2&gt;&quot;.&#39;&lt;center&gt;
&lt;form action=level7.php method=GET&gt;
&lt;input name=keyword  value=&quot;&#39;.$str6.&#39;&quot;&gt;
&lt;input type=submit name=submit value=搜索 /&gt;
&lt;/form&gt;
&lt;/center&gt;&#39;;
?&gt;
&lt;center&gt;&lt;img src=level7.png&gt;&lt;/center&gt;
&lt;?php 
echo &quot;&lt;h3 align=center&gt;payload的长度:&quot;.strlen($str6).&quot;&lt;/h3&gt;&quot;;
?&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre><h4 id="8-level-8"><a href="#8-level-8" class="headerlink" title="8. level-8"></a>8. level-8</h4><ul>
<li>插入特殊字段尝试<code>&#39;&quot;&lt;&gt;6666</code></li>
<li>F12查看源代码，发现对双引号进行了转义</li>
</ul>
<p><img src="/images/xss/xss-lab/level-8-%E8%BD%AC%E4%B9%89.png" srcset="/img/loading.gif" alt="level-8-转义"></p>
<ul>
<li>看到既然是href，就想到了javascript伪协议</li>
<li>伪协议：<code>javascript:alert(1)</code></li>
<li>发现javascript的script被修改</li>
</ul>
<p><img src="/images/xss/xss-lab/level-8-%E4%BF%AE%E6%94%B9.png" srcset="/img/loading.gif" alt="level-8-修改"></p>
<ul>
<li>进行HTML实体编码：<code>&amp;#x6A;&amp;#x61;&amp;#x76;&amp;#x61;&amp;#x73;&amp;#x63;&amp;#x72;&amp;#x69;&amp;#x70;&amp;#x74;&amp;#x3A;&amp;#x61;&amp;#x6C;&amp;#x65;&amp;#x72;&amp;#x74;&amp;#x28;&amp;#x31;&amp;#x29;</code></li>
<li>⭐ 点击友情链接，成功弹窗</li>
<li>源码分析<ul>
<li>strtolower()函数，将字符串转为小写</li>
<li>字符串匹配函数str_replace()，将<code>&lt;script</code>转换为<code>&lt;scr_ipt</code>，将<code>on</code>转换为<code>o_n</code>，将<code>src</code>转换为<code>sr_c</code>，将<code>data</code>转换为<code>da_ta</code>，将<code>href</code>转换为<code>hr_ef</code>，将双引号转义</li>
<li>htmlspecialchars()函数，但默认的第二个参数是不对单引号进行转义</li>
</ul>
</li>
</ul>
<pre><code>&lt;!DOCTYPE html&gt;&lt;!--STATUS OK--&gt;&lt;html&gt;
&lt;head&gt;
&lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html;charset=utf-8&quot;&gt;
&lt;script&gt;
window.alert = function()  
{     
confirm(&quot;完成的不错！&quot;);
 window.location.href=&quot;level9.php?keyword=not bad!&quot;; 
}
&lt;/script&gt;
&lt;title&gt;欢迎来到level8&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h1 align=center&gt;欢迎来到level8&lt;/h1&gt;
&lt;?php 
ini_set(&quot;display_errors&quot;, 0);
$str = strtolower($_GET[&quot;keyword&quot;]);
$str2=str_replace(&quot;script&quot;,&quot;scr_ipt&quot;,$str);
$str3=str_replace(&quot;on&quot;,&quot;o_n&quot;,$str2);
$str4=str_replace(&quot;src&quot;,&quot;sr_c&quot;,$str3);
$str5=str_replace(&quot;data&quot;,&quot;da_ta&quot;,$str4);
$str6=str_replace(&quot;href&quot;,&quot;hr_ef&quot;,$str5);
$str7=str_replace(&#39;&quot;&#39;,&#39;&amp;quot&#39;,$str6);
echo &#39;&lt;center&gt;
&lt;form action=level8.php method=GET&gt;
&lt;input name=keyword  value=&quot;&#39;.htmlspecialchars($str).&#39;&quot;&gt;
&lt;input type=submit name=submit value=添加友情链接 /&gt;
&lt;/form&gt;
&lt;/center&gt;&#39;;
?&gt;
&lt;?php
 echo &#39;&lt;center&gt;&lt;BR&gt;&lt;a href=&quot;&#39;.$str7.&#39;&quot;&gt;友情链接&lt;/a&gt;&lt;/center&gt;&#39;;
?&gt;
&lt;center&gt;&lt;img src=level8.jpg&gt;&lt;/center&gt;
&lt;?php 
echo &quot;&lt;h3 align=center&gt;payload的长度:&quot;.strlen($str7).&quot;&lt;/h3&gt;&quot;;
?&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre><h4 id="9-level-9"><a href="#9-level-9" class="headerlink" title="9. level-9"></a>9. level-9</h4><ul>
<li>跟level-8一样，插入level-8的payload</li>
<li>发现只有弹出提示”您的链接不合法?有没有”</li>
</ul>
<p><img src="/images/xss/xss-lab/level-9-%E9%93%BE%E6%8E%A51.png" srcset="/img/loading.gif" alt="level-9-链接1"></p>
<ul>
<li>输入正常的链接<code>http://www.baidu.com</code></li>
<li>发现可以正常显示</li>
</ul>
<p><img src="/images/xss/xss-lab/level-9-%E9%93%BE%E6%8E%A52.png" srcset="/img/loading.gif" alt="level-9-链接2"></p>
<ul>
<li>根据level-8的payload进行构造：<code>javascrip&amp;#x74;:alert(1)//http://</code><ul>
<li>http://用于绕过后台对http://的检测</li>
<li>//用于注释后面的http</li>
</ul>
</li>
<li>⭐ 点击友情链接，成功弹窗</li>
<li>源码分析<ul>
<li>strtolower()函数，将字符串转为小写</li>
<li>字符串匹配函数str_replace()，将<code>&lt;script</code>转换为<code>&lt;scr_ipt</code>，将<code>on</code>转换为<code>o_n</code>，将<code>src</code>转换为<code>sr_c</code>，将<code>data</code>转换为<code>da_ta</code>，将<code>href</code>转换为<code>hr_ef</code>，将双引号转义</li>
<li>htmlspecialchars()函数，但默认的第二个参数是不对单引号进行转义</li>
<li>strpos()函数，找寻字符串中是否有<code>http://</code></li>
</ul>
</li>
</ul>
<pre><code>&lt;!DOCTYPE html&gt;&lt;!--STATUS OK--&gt;&lt;html&gt;
&lt;head&gt;
&lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html;charset=utf-8&quot;&gt;
&lt;script&gt;
window.alert = function()  
{     
confirm(&quot;完成的不错！&quot;);
 window.location.href=&quot;level10.php?keyword=well done!&quot;; 
}
&lt;/script&gt;
&lt;title&gt;欢迎来到level9&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h1 align=center&gt;欢迎来到level9&lt;/h1&gt;
&lt;?php 
ini_set(&quot;display_errors&quot;, 0);
$str = strtolower($_GET[&quot;keyword&quot;]);
$str2=str_replace(&quot;script&quot;,&quot;scr_ipt&quot;,$str);
$str3=str_replace(&quot;on&quot;,&quot;o_n&quot;,$str2);
$str4=str_replace(&quot;src&quot;,&quot;sr_c&quot;,$str3);
$str5=str_replace(&quot;data&quot;,&quot;da_ta&quot;,$str4);
$str6=str_replace(&quot;href&quot;,&quot;hr_ef&quot;,$str5);
$str7=str_replace(&#39;&quot;&#39;,&#39;&amp;quot&#39;,$str6);
echo &#39;&lt;center&gt;
&lt;form action=level9.php method=GET&gt;
&lt;input name=keyword  value=&quot;&#39;.htmlspecialchars($str).&#39;&quot;&gt;
&lt;input type=submit name=submit value=添加友情链接 /&gt;
&lt;/form&gt;
&lt;/center&gt;&#39;;
?&gt;
&lt;?php
if(false===strpos($str7,&#39;http://&#39;))
{
  echo &#39;&lt;center&gt;&lt;BR&gt;&lt;a href=&quot;您的链接不合法？有没有！&quot;&gt;友情链接&lt;/a&gt;&lt;/center&gt;&#39;;
        }
else
{
  echo &#39;&lt;center&gt;&lt;BR&gt;&lt;a href=&quot;&#39;.$str7.&#39;&quot;&gt;友情链接&lt;/a&gt;&lt;/center&gt;&#39;;
}
?&gt;
&lt;center&gt;&lt;img src=level9.png&gt;&lt;/center&gt;
&lt;?php 
echo &quot;&lt;h3 align=center&gt;payload的长度:&quot;.strlen($str7).&quot;&lt;/h3&gt;&quot;;
?&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre><h4 id="10-level-10"><a href="#10-level-10" class="headerlink" title="10. level-10"></a>10. level-10</h4><ul>
<li>没有输入框，但url地址栏可以进行输入</li>
<li>插入特殊字段尝试<code>&#39;&quot;&lt;&gt;6666</code>，发现页面也出现了相应的内容</li>
<li>F12查看源代码，发现有隐藏的表单，对表单的内容插入特殊字段尝试<code>&#39;&quot;&lt;&gt;6666</code></li>
</ul>
<p><img src="/images/xss/xss-lab/level-10-%E8%A1%A8%E5%8D%95.png" srcset="/img/loading.gif" alt="level-10-表单"></p>
<ul>
<li>发现只有t_sort字段读取到插入到内容，但过滤了<code>&lt;&gt;</code></li>
<li>又因为是input标签，value属性，又因为需要出现相关的内容来进行触发，插入修改Onclick事件尝试：<code>&quot; type=&quot;txt&quot; value=&quot;q&quot; onclick=&quot;alert(1)</code></li>
<li>⭐ 界面出现了文本框，点击弹出</li>
<li>源码分析<ul>
<li>字符串匹配函数str_replace()，匹配掉<code>&lt;&gt;</code>符号</li>
<li>以hidden表的形式存在，看不到输出</li>
</ul>
</li>
</ul>
<pre><code>&lt;!DOCTYPE html&gt;&lt;!--STATUS OK--&gt;&lt;html&gt;
&lt;head&gt;
&lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html;charset=utf-8&quot;&gt;
&lt;script&gt;
window.alert = function()  
{     
confirm(&quot;完成的不错！&quot;);
 window.location.href=&quot;level11.php?keyword=good job!&quot;; 
}
&lt;/script&gt;
&lt;title&gt;欢迎来到level10&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h1 align=center&gt;欢迎来到level10&lt;/h1&gt;
&lt;?php 
ini_set(&quot;display_errors&quot;, 0);
$str = $_GET[&quot;keyword&quot;];
$str11 = $_GET[&quot;t_sort&quot;];
$str22=str_replace(&quot;&gt;&quot;,&quot;&quot;,$str11);
$str33=str_replace(&quot;&lt;&quot;,&quot;&quot;,$str22);
echo &quot;&lt;h2 align=center&gt;没有找到和&quot;.htmlspecialchars($str).&quot;相关的结果.&lt;/h2&gt;&quot;.&#39;&lt;center&gt;
&lt;form id=search&gt;
&lt;input name=&quot;t_link&quot;  value=&quot;&#39;.&#39;&quot; type=&quot;hidden&quot;&gt;
&lt;input name=&quot;t_history&quot;  value=&quot;&#39;.&#39;&quot; type=&quot;hidden&quot;&gt;
&lt;input name=&quot;t_sort&quot;  value=&quot;&#39;.$str33.&#39;&quot; type=&quot;hidden&quot;&gt;
&lt;/form&gt;
&lt;/center&gt;&#39;;
?&gt;
&lt;center&gt;&lt;img src=level10.png&gt;&lt;/center&gt;
&lt;?php 
echo &quot;&lt;h3 align=center&gt;payload的长度:&quot;.strlen($str).&quot;&lt;/h3&gt;&quot;;
?&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre><h4 id="11-level-11"><a href="#11-level-11" class="headerlink" title="11. level-11"></a>11. level-11</h4><ul>
<li>跟level-10一样，只有url输入</li>
<li>直接F12查看源代码，果然有隐藏的表单，且t_ref字段跟refer字段内容一样</li>
</ul>
<p><img src="/images/xss/xss-lab/level-11-ref.png" srcset="/img/loading.gif" alt="level-11-ref"></p>
<ul>
<li>使用level-10的payload，但是使用的是referer头进行传值<ul>
<li>F12使用hackbar</li>
<li>Load URL</li>
<li>勾选Referer</li>
<li>填入level-10的payload：<code>&quot; type=&quot;txt&quot; value=&quot;q&quot; onclick=&quot;alert(1)</code></li>
<li>Execute</li>
</ul>
</li>
</ul>
<p><img src="/images/xss/xss-lab/level-11-refer%E4%BC%A0%E5%80%BC.png" srcset="/img/loading.gif" alt="level-11-refer传值"></p>
<ul>
<li>⭐ 界面出现了文本框，点击弹出</li>
<li>源码分析<ul>
<li>字符串匹配函数str_replace()，匹配掉<code>&lt;&gt;</code>符号</li>
<li>以hidden表的形式存在，看不到输出</li>
<li>▲ Referer泄露，以Referer值来进行数据提交，且没有过滤</li>
<li>htmlspecialchars()函数，但默认的第二个参数是不对单引号进行转义，也不对t_ref值进行转义处理</li>
</ul>
</li>
</ul>
<pre><code>&lt;!DOCTYPE html&gt;&lt;!--STATUS OK--&gt;&lt;html&gt;
&lt;head&gt;
&lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html;charset=utf-8&quot;&gt;
&lt;script&gt;
window.alert = function()  
{     
confirm(&quot;完成的不错！&quot;);
 window.location.href=&quot;level12.php?keyword=good job!&quot;; 
}
&lt;/script&gt;
&lt;title&gt;欢迎来到level11&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h1 align=center&gt;欢迎来到level11&lt;/h1&gt;
&lt;?php 
ini_set(&quot;display_errors&quot;, 0);
$str = $_GET[&quot;keyword&quot;];
$str00 = $_GET[&quot;t_sort&quot;];
$str11=$_SERVER[&#39;HTTP_REFERER&#39;];
$str22=str_replace(&quot;&gt;&quot;,&quot;&quot;,$str11);
$str33=str_replace(&quot;&lt;&quot;,&quot;&quot;,$str22);
echo &quot;&lt;h2 align=center&gt;没有找到和&quot;.htmlspecialchars($str).&quot;相关的结果.&lt;/h2&gt;&quot;.&#39;&lt;center&gt;
&lt;form id=search&gt;
&lt;input name=&quot;t_link&quot;  value=&quot;&#39;.&#39;&quot; type=&quot;hidden&quot;&gt;
&lt;input name=&quot;t_history&quot;  value=&quot;&#39;.&#39;&quot; type=&quot;hidden&quot;&gt;
&lt;input name=&quot;t_sort&quot;  value=&quot;&#39;.htmlspecialchars($str00).&#39;&quot; type=&quot;hidden&quot;&gt;
&lt;input name=&quot;t_ref&quot;  value=&quot;&#39;.$str33.&#39;&quot; type=&quot;hidden&quot;&gt;
&lt;/form&gt;
&lt;/center&gt;&#39;;
?&gt;
&lt;center&gt;&lt;img src=level11.png&gt;&lt;/center&gt;
&lt;?php 
echo &quot;&lt;h3 align=center&gt;payload的长度:&quot;.strlen($str).&quot;&lt;/h3&gt;&quot;;
?&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre><h4 id="12-level-12"><a href="#12-level-12" class="headerlink" title="12. level-12"></a>12. level-12</h4><ul>
<li>跟level-10一样，只有url输入</li>
<li>直接F12查看源代码，果然有隐藏的表单，且t_ua字段跟user-agent字段内容一样</li>
</ul>
<p><img src="/images/xss/xss-lab/level-12-ua.png" srcset="/img/loading.gif" alt="level-12-ua"></p>
<ul>
<li>使用level-10的payload，但是使用的是user-agent头进行传值<ul>
<li>F12使用hackbar</li>
<li>Load URL</li>
<li>勾选user-agnet</li>
<li>填入level-10的payload：<code>&quot; type=&quot;txt&quot; value=&quot;q&quot; onclick=&quot;alert(1)</code></li>
<li>Execute<ul>
<li>⭐ 界面出现了文本框，点击弹出</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><img src="/images/xss/xss-lab/level-12-ua%E4%BC%A0%E5%80%BC.png" srcset="/img/loading.gif" alt="level-12-ua传值"></p>
<ul>
<li>源码分析<ul>
<li>字符串匹配函数str_replace()，匹配掉<code>&lt;&gt;</code>符号</li>
<li>以hidden表的形式存在，看不到输出</li>
<li>▲ User-Agent泄露，以User-Agent值来进行数据提交，且没有过滤</li>
<li>htmlspecialchars()函数，但默认的第二个参数是不对单引号进行转义，也不对t_ua值进行转义处理</li>
</ul>
</li>
</ul>
<pre><code>&lt;!DOCTYPE html&gt;&lt;!--STATUS OK--&gt;&lt;html&gt;
&lt;head&gt;
&lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html;charset=utf-8&quot;&gt;
&lt;script&gt;
window.alert = function()  
{     
confirm(&quot;完成的不错！&quot;);
 window.location.href=&quot;level13.php?keyword=good job!&quot;; 
}
&lt;/script&gt;
&lt;title&gt;欢迎来到level12&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h1 align=center&gt;欢迎来到level12&lt;/h1&gt;
&lt;?php 
ini_set(&quot;display_errors&quot;, 0);
$str = $_GET[&quot;keyword&quot;];
$str00 = $_GET[&quot;t_sort&quot;];
$str11=$_SERVER[&#39;HTTP_USER_AGENT&#39;];
$str22=str_replace(&quot;&gt;&quot;,&quot;&quot;,$str11);
$str33=str_replace(&quot;&lt;&quot;,&quot;&quot;,$str22);
echo &quot;&lt;h2 align=center&gt;没有找到和&quot;.htmlspecialchars($str).&quot;相关的结果.&lt;/h2&gt;&quot;.&#39;&lt;center&gt;
&lt;form id=search&gt;
&lt;input name=&quot;t_link&quot;  value=&quot;&#39;.&#39;&quot; type=&quot;hidden&quot;&gt;
&lt;input name=&quot;t_history&quot;  value=&quot;&#39;.&#39;&quot; type=&quot;hidden&quot;&gt;
&lt;input name=&quot;t_sort&quot;  value=&quot;&#39;.htmlspecialchars($str00).&#39;&quot; type=&quot;hidden&quot;&gt;
&lt;input name=&quot;t_ua&quot;  value=&quot;&#39;.$str33.&#39;&quot; type=&quot;hidden&quot;&gt;
&lt;/form&gt;
&lt;/center&gt;&#39;;
?&gt;
&lt;center&gt;&lt;img src=level12.png&gt;&lt;/center&gt;
&lt;?php 
echo &quot;&lt;h3 align=center&gt;payload的长度:&quot;.strlen($str).&quot;&lt;/h3&gt;&quot;;
?&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre><h4 id="13-level-13"><a href="#13-level-13" class="headerlink" title="13. level-13"></a>13. level-13</h4><ul>
<li>同样的操作，那这次应该是cookie了</li>
<li>填入level-10的payload：<code>user=&quot; type=&quot;txt&quot; value=&quot;q&quot; onclick=&quot;alert(1)</code><ul>
<li>▲ 注意cookie前头有一个user字段，需填入</li>
</ul>
</li>
<li>⭐ 界面出现了文本框，点击弹出</li>
</ul>
<p><img src="/images/xss/xss-lab/level-13-cookie%E4%BC%A0%E5%80%BC.png" srcset="/img/loading.gif" alt="level-13-cookie传值"></p>
<ul>
<li>源码分析<ul>
<li>字符串匹配函数str_replace()，匹配掉<code>&lt;&gt;</code>符号</li>
<li>以hidden表的形式存在，看不到输出</li>
<li>▲ Cookie泄露，以Cookie值来进行数据提交，且没有过滤</li>
<li>htmlspecialchars()函数，但默认的第二个参数是不对单引号进行转义，也不对t_cook值进行转义处理</li>
</ul>
</li>
</ul>
<pre><code>&lt;!DOCTYPE html&gt;&lt;!--STATUS OK--&gt;&lt;html&gt;
&lt;head&gt;
&lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html;charset=utf-8&quot;&gt;
&lt;script&gt;
window.alert = function()  
{     
confirm(&quot;完成的不错！&quot;);
 window.location.href=&quot;level14.php&quot;; 
}
&lt;/script&gt;
&lt;title&gt;欢迎来到level13&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h1 align=center&gt;欢迎来到level13&lt;/h1&gt;
&lt;?php 
setcookie(&quot;user&quot;, &quot;call me maybe?&quot;, time()+3600);
ini_set(&quot;display_errors&quot;, 0);
$str = $_GET[&quot;keyword&quot;];
$str00 = $_GET[&quot;t_sort&quot;];
$str11=$_COOKIE[&quot;user&quot;];
$str22=str_replace(&quot;&gt;&quot;,&quot;&quot;,$str11);
$str33=str_replace(&quot;&lt;&quot;,&quot;&quot;,$str22);
echo &quot;&lt;h2 align=center&gt;没有找到和&quot;.htmlspecialchars($str).&quot;相关的结果.&lt;/h2&gt;&quot;.&#39;&lt;center&gt;
&lt;form id=search&gt;
&lt;input name=&quot;t_link&quot;  value=&quot;&#39;.&#39;&quot; type=&quot;hidden&quot;&gt;
&lt;input name=&quot;t_history&quot;  value=&quot;&#39;.&#39;&quot; type=&quot;hidden&quot;&gt;
&lt;input name=&quot;t_sort&quot;  value=&quot;&#39;.htmlspecialchars($str00).&#39;&quot; type=&quot;hidden&quot;&gt;
&lt;input name=&quot;t_cook&quot;  value=&quot;&#39;.$str33.&#39;&quot; type=&quot;hidden&quot;&gt;
&lt;/form&gt;
&lt;/center&gt;&#39;;
?&gt;
&lt;center&gt;&lt;img src=level13.png&gt;&lt;/center&gt;
&lt;?php 
echo &quot;&lt;h3 align=center&gt;payload的长度:&quot;.strlen($str).&quot;&lt;/h3&gt;&quot;;
?&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre><h4 id="14-level-14"><a href="#14-level-14" class="headerlink" title="14. level-14"></a>14. level-14</h4><ul>
<li>因为文件一直不加载，所以F12查看一下源代码，发现应该是iframe相关的</li>
<li>直接进入level-15</li>
<li>▲ 2020.03.28 因为iframe加载问题，暂不实验</li>
</ul>
<p><img src="/images/xss/xss-lab/level-14-iframe.png" srcset="/img/loading.gif" alt="level-14-iframe"></p>
<ul>
<li>源码<ul>
<li>▲ 2020.03.28 暂不知道那里存在注入点</li>
<li>猜测iframe中的src来实现XSS注入</li>
</ul>
</li>
</ul>
<pre><code>&lt;html&gt;
&lt;head&gt;
&lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html;charset=utf-8&quot;&gt;
&lt;title&gt;欢迎来到level14&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h1 align=center&gt;欢迎来到level14&lt;/h1&gt;
&lt;center&gt;&lt;iframe name=&quot;leftframe&quot; marginwidth=10 marginheight=10 src=&quot;http://www.exifviewer.org/&quot; frameborder=no width=&quot;80%&quot; scrolling=&quot;no&quot; height=80%&gt;&lt;/iframe&gt;&lt;/center&gt;&lt;center&gt;这关成功后不会自动跳转。成功者&lt;a href=/xsschallenge/level15.php?src=1.gif&gt;点我进level15&lt;/a&gt;&lt;/center&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre><h4 id="15-level-15"><a href="#15-level-15" class="headerlink" title="15. level-15"></a>15. level-15</h4><ul>
<li>▲ 此处有个坑，因为level-14不会自动跳转，需要点击按钮，但在level14.php中，跳转的href不是有效的链接，需要自己在url地址栏指定跳转的有效链接</li>
<li>▲ 因找不到注入点，网上寻求结果，发现我的xss-lab存在一定问题，后面的level就按网上的答案继续编写<ul>
<li>根据返回的源代码判断，变量src存在注入点</li>
<li>构造poc，并未触发xss，ng-include属性一直未生效，原来是调用的js文件中有地址被墙了，需要源代码中修改js源文件路径 <a href="https://cdn.staticfile.org/angular.js/1.4.6/angular.min.js，触发xss" target="_blank" rel="noopener">https://cdn.staticfile.org/angular.js/1.4.6/angular.min.js，触发xss</a></li>
</ul>
</li>
<li>源码<ul>
<li>ng-include本地文件包含，调用本地有xss漏洞的文件，触发xss</li>
<li>简单的一个htmlspecialchars()函数，但第二个参数默认不对单引号进行过滤</li>
</ul>
</li>
</ul>
<pre><code>&lt;html ng-app&gt;
&lt;head&gt;
        &lt;meta charset=&quot;utf-8&quot;&gt;
        &lt;script src=&quot;https://ajax.googleapis.com/ajax/libs/angularjs/1.2.0/angular.min.js&quot;&gt;&lt;/script&gt;
&lt;script&gt;
window.alert = function()  
{     
confirm(&quot;完成的不错！&quot;);
 window.location.href=&quot;level16.php?keyword=test&quot;; 
}
&lt;/script&gt;
&lt;title&gt;欢迎来到level15&lt;/title&gt;
&lt;/head&gt;
&lt;h1 align=center&gt;欢迎来到第15关，自己想个办法走出去吧！&lt;/h1&gt;
&lt;p align=center&gt;&lt;img src=level15.png&gt;&lt;/p&gt;
&lt;?php 
ini_set(&quot;display_errors&quot;, 0);
$str = $_GET[&quot;src&quot;];
echo &#39;&lt;body&gt;&lt;span class=&quot;ng-include:&#39;.htmlspecialchars($str).&#39;&quot;&gt;&lt;/span&gt;&lt;/body&gt;&#39;;
?&gt;</code></pre><h4 id="16-level-16"><a href="#16-level-16" class="headerlink" title="16. level-16"></a>16. level-16</h4><ul>
<li>没有输入框，但url地址栏可以进行输入</li>
<li>插入特殊字段尝试<code>&#39;&quot;&lt;&gt;6666</code>，发现页面也出现了相应的内容</li>
<li>F12查看源代码，没有过滤和转义</li>
<li>插入弹窗尝试<code>&lt;script&gt;alert(1)&lt;/script&gt;</code></li>
<li>发现对script以及/进行了转义</li>
</ul>
<p><img src="/images/xss/xss-lab/level-16-%E8%BD%AC%E4%B9%89.png" srcset="/img/loading.gif" alt="level-16-转义"></p>
<ul>
<li>采用回车符%0a进行绕过：<code>&lt;a%0atype=&quot;text&quot;%0aonclick=&quot;alert(1)&quot;&gt;</code></li>
<li>源码分析<ul>
<li>strtolower()函数，将字符串转为小写</li>
<li>str_replace()函数对script、空格、/转换为字符串实体<code>&amp;nbsp</code></li>
</ul>
</li>
</ul>
<pre><code>&lt;!DOCTYPE html&gt;&lt;!--STATUS OK--&gt;&lt;html&gt;
&lt;head&gt;
&lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html;charset=utf-8&quot;&gt;
&lt;script&gt;
window.alert = function()  
{     
confirm(&quot;完成的不错！&quot;);
 window.location.href=&quot;level17.php?arg01=a&amp;arg02=b&quot;; 
}
&lt;/script&gt;
&lt;title&gt;欢迎来到level16&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h1 align=center&gt;欢迎来到level16&lt;/h1&gt;
&lt;?php 
ini_set(&quot;display_errors&quot;, 0);
$str = strtolower($_GET[&quot;keyword&quot;]);
$str2=str_replace(&quot;script&quot;,&quot;&amp;nbsp;&quot;,$str);
$str3=str_replace(&quot; &quot;,&quot;&amp;nbsp;&quot;,$str2);
$str4=str_replace(&quot;/&quot;,&quot;&amp;nbsp;&quot;,$str3);
$str5=str_replace(&quot; &quot;,&quot;&amp;nbsp;&quot;,$str4);
echo &quot;&lt;center&gt;&quot;.$str5.&quot;&lt;/center&gt;&quot;;
?&gt;
&lt;center&gt;&lt;img src=level16.png&gt;&lt;/center&gt;
&lt;?php 
echo &quot;&lt;h3 align=center&gt;payload的长度:&quot;.strlen($str5).&quot;&lt;/h3&gt;&quot;;
?&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre><h4 id="17-level-17"><a href="#17-level-17" class="headerlink" title="17. level-17"></a>17. level-17</h4><ul>
<li>根据返回的代码判断，arg01和arg02提交的变量存在注入点</li>
<li>进行注入<ul>
<li>一直用的火狐浏览器没成功，最后发现是火狐不支持swf，改成ie浏览器就可以了</li>
</ul>
</li>
<li>▲ swf（来自百度百科）<ul>
<li>swf(shock wave flash)是Macromedia（现已被ADOBE公司收购）公司的动画设计软件Flash的专用格式，被广泛应用于网页设计、动画制作等领域，swf文件通常也被称为Flash文件。swf普及程度很高，现在超过99%的网络使用者都可以读取swf档案。这个档案格式由FutureWave创建，后来伴随着一个主要的目标受到Macromedia支援：创作小档案以播放动画。计划理念是可以在任何操作系统和浏览器中进行，并让网络较慢的人也能顺利浏览。swf 可以用Adobe Flash Player打开，浏览器必须安装Adobe Flash Player插件。</li>
</ul>
</li>
<li>源码</li>
</ul>
<pre><code>&lt;!DOCTYPE html&gt;&lt;!--STATUS OK--&gt;&lt;html&gt;
&lt;head&gt;
&lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html;charset=utf-8&quot;&gt;
&lt;script&gt;
window.alert = function()  
{     
confirm(&quot;完成的不错！&quot;); 
}
&lt;/script&gt;
&lt;title&gt;欢迎来到level17&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h1 align=center&gt;欢迎来到level17&lt;/h1&gt;
&lt;?php
ini_set(&quot;display_errors&quot;, 0);
echo &quot;&lt;embed src=xsf01.swf?&quot;.htmlspecialchars($_GET[&quot;arg01&quot;]).&quot;=&quot;.htmlspecialchars($_GET[&quot;arg02&quot;]).&quot; width=100% heigth=100%&gt;&quot;;
?&gt;
&lt;h2 align=center&gt;成功后，&lt;a href=level18.php?arg01=a&amp;arg02=b&gt;点我进入下一关&lt;/a&gt;&lt;/h2&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre><h4 id="18-level-18"><a href="#18-level-18" class="headerlink" title="18. level-18"></a>18. level-18</h4><ul>
<li>▲ 此题需要ie环境</li>
<li>根据返回的源代码判断，arg01和arg02存在注入点，web服务器对双引号进行了过滤</li>
<li>改为onmouseover=alert(1)，去掉”，触发poc</li>
<li>源码</li>
</ul>
<pre><code>&lt;!DOCTYPE html&gt;&lt;!--STATUS OK--&gt;&lt;html&gt;
&lt;head&gt;
&lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html;charset=utf-8&quot;&gt;
&lt;script&gt;
window.alert = function()  
{     
confirm(&quot;完成的不错！&quot;);
 window.location.href=&quot;level19.php?arg01=a&amp;arg02=b&quot;; 
}
&lt;/script&gt;
&lt;title&gt;欢迎来到level18&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h1 align=center&gt;欢迎来到level18&lt;/h1&gt;
&lt;?php
ini_set(&quot;display_errors&quot;, 0);
echo &quot;&lt;embed src=xsf02.swf?&quot;.htmlspecialchars($_GET[&quot;arg01&quot;]).&quot;=&quot;.htmlspecialchars($_GET[&quot;arg02&quot;]).&quot; width=100% heigth=100%&gt;&quot;;
?&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre><h4 id="19-level-19"><a href="#19-level-19" class="headerlink" title="19. level-19"></a>19. level-19</h4><ul>
<li>flash xss，涉及到反编译</li>
<li>源码</li>
</ul>
<pre><code>&lt;!DOCTYPE html&gt;&lt;!--STATUS OK--&gt;&lt;html&gt;
&lt;head&gt;
&lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html;charset=utf-8&quot;&gt;
&lt;script&gt;
window.alert = function()  
{     
confirm(&quot;完成的不错！&quot;);
 window.location.href=&quot;level20.php?arg01=a&amp;arg02=b&quot;; 
}
&lt;/script&gt;
&lt;title&gt;欢迎来到level19&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h1 align=center&gt;欢迎来到level19&lt;/h1&gt;
&lt;?php
ini_set(&quot;display_errors&quot;, 0);
echo &#39;&lt;embed src=&quot;xsf03.swf?&#39;.htmlspecialchars($_GET[&quot;arg01&quot;]).&quot;=&quot;.htmlspecialchars($_GET[&quot;arg02&quot;]).&#39;&quot; width=100% heigth=100%&gt;&#39;;
?&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre><h4 id="20-level-20"><a href="#20-level-20" class="headerlink" title="20. level-20"></a>20. level-20</h4><ul>
<li>flash xss，涉及到反编译</li>
<li>源码</li>
</ul>
<pre><code>&lt;!DOCTYPE html&gt;&lt;!--STATUS OK--&gt;&lt;html&gt;
&lt;head&gt;
&lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html;charset=utf-8&quot;&gt;
&lt;script&gt;
window.alert = function()  
{     
confirm(&quot;完成的不错！&quot;);
 window.location.href=&quot;level21.php?arg01=a&amp;arg02=b&quot;; 
}
&lt;/script&gt;
&lt;title&gt;欢迎来到level20&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h1 align=center&gt;欢迎来到level20&lt;/h1&gt;
&lt;?php
ini_set(&quot;display_errors&quot;, 0);
echo &#39;&lt;embed src=&quot;xsf04.swf?&#39;.htmlspecialchars($_GET[&quot;arg01&quot;]).&quot;=&quot;.htmlspecialchars($_GET[&quot;arg02&quot;]).&#39;&quot; width=100% heigth=100%&gt;&#39;;
?&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre><h4 id="21-靶场说明"><a href="#21-靶场说明" class="headerlink" title="21.靶场说明"></a>21.靶场说明</h4><ul>
<li>靶场的东西很多，涉及范围很广很全，也学到很多新的东西</li>
<li>ahao2333大佬的靶场链接：<a href="https://www.cnblogs.com/xiaomeng2333/p/11595786.html" target="_blank" rel="noopener">https://www.cnblogs.com/xiaomeng2333/p/11595786.html</a></li>
<li>▲ 从level-15开始，基本上都是看着别人的博客来进行写的<ul>
<li>level-15源代码无法看见对1.gif文件的引用，即使注入也不能显示</li>
<li>level-17-20对swf文件的研究，暂无一点头绪</li>
</ul>
</li>
</ul>

            </div>
            <hr>
            <div>
              <p>
                
                  <span>
                <i class="iconfont icon-inbox"></i>
                    
                      <a class="hover-with-bg" href="/categories/XSS/">XSS</a>
                      &nbsp;
                    
                  </span>&nbsp;&nbsp;
                
                
                  <span>
                <i class="iconfont icon-tag"></i>
                    
                      <a class="hover-with-bg" href="/tags/XSS/">XSS</a>
                    
                  </span>
                
              </p>
              
                <p class="note note-warning">本博客所有文章除特别声明外，均采用 <a href="https://zh.wikipedia.org/wiki/Wikipedia:CC_BY-SA_3.0%E5%8D%8F%E8%AE%AE%E6%96%87%E6%9C%AC" target="_blank" rel="nofollow noopener noopener">CC BY-SA 3.0协议</a> 。转载请注明出处！</p>
              
              
                <div class="post-prevnext row">
                  <div class="post-prev col-6">
                    
                    
                      <a href="/2020/03/30/XSS%E9%9D%B6%E5%9C%BA--%E5%B0%81%E7%A5%9E%E5%8F%B0/">
                        <i class="fa fa-chevron-left"></i>
                        <span class="hidden-mobile">XSS靶场--封神台</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </div>
                  <div class="post-next col-6">
                    
                    
                      <a href="/2020/03/30/XSS%E9%9D%B6%E5%9C%BA--pikachu/">
                        <span class="hidden-mobile">XSS靶场--pikachu</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="fa fa-chevron-right"></i>
                      </a>
                    
                  </div>
                </div>
              
            </div>

              
          </div>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc-start"></div>
<div id="toc">
  <p class="h5"><i class="far fa-list-alt"></i>&nbsp;目录</p>
  <div id="tocbot"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->

  <div class="col-lg-7 mx-auto nopadding-md">
    <div class="container custom post-content mx-auto">
      <h3>你好，Tomas，生命仍在继续......</h3>
    </div>
  </div>


    
  </main>

  
    <a class="z-depth-1" id="scroll-top-button" href="#" role="button">
      <i class="fa fa-chevron-up scroll-top-arrow" aria-hidden="true"></i>
    </a>
  

  
    <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
  

  

  

  <footer class="mt-5">
  <div class="text-center py-3">
    <div>
      <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><b>Hexo</b></a>
      <i class="iconfont icon-love"></i>
      <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"> <b>Fluid</b></a>
    </div>
    

    

    
  </div>
</footer>

<!-- SCRIPTS -->
<script  src="https://cdn.staticfile.org/jquery/3.4.1/jquery.min.js" ></script>
<script  src="https://cdn.staticfile.org/popper.js/1.16.1/umd/popper.min.js" ></script>
<script  src="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/js/bootstrap.min.js" ></script>
<script  src="https://cdn.staticfile.org/mdbootstrap/4.13.0/js/mdb.min.js" ></script>
<script  src="/js/main.js" ></script>


  <script  src="/js/lazyload.js" ></script>



  
  <script  src="https://cdn.staticfile.org/tocbot/4.10.0/tocbot.min.js" ></script>
  <script>
    $(document).ready(function () {
      var navHeight = $('#navbar').height();
      var toc = $('#toc');
      var boardCtn = $('#board-ctn');
      var boardTop = boardCtn.offset().top;
      var tocLimMax = 2 * boardTop + boardCtn.height();

      $(window).scroll(function () {
        var tocLimMin = $('#toc-start').offset().top - navHeight;
        var scroH = document.body.scrollTop + document.documentElement.scrollTop;

        if (tocLimMin <= scroH && scroH <= tocLimMax) {
          toc.css({
            'display': 'block',
            'position': 'fixed',
            'top': navHeight,
          });
        } else if (scroH <= tocLimMin) {
          toc.css({
            'position': '',
            'top': '',
          });
        } else if (scroH > tocLimMax) {
          toc.css('display', 'none');
        }
      });
      tocbot.init({
        tocSelector: '#tocbot',
        contentSelector: '.post-content',
        headingSelector: 'h1,h2,h3,h4,h5,h6',
        linkClass: 'tocbot-link',
        activeLinkClass: 'tocbot-active-link',
        listClass: 'tocbot-list',
        isCollapsedClass: 'tocbot-is-collapsed',
        collapsibleClass: 'tocbot-is-collapsible',
        scrollSmooth: true,
        headingsOffset: -boardTop
      });
      if ($('.toc-list-item').length > 0) {
        $('#toc > p').css('visibility', 'visible');
      }
      var offset = boardCtn.css('margin-right')
      $('#toc-ctn').css({
        'right': offset
      })
    });
  </script>





  <script defer src="https://cdn.staticfile.org/clipboard.js/2.0.6/clipboard.min.js" ></script>
  <script  src="/js/clipboard-use.js" ></script>





  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>




<!-- Plugins -->



  <script  src="https://cdn.staticfile.org/prettify/188.0.0/prettify.min.js" ></script>
  <script>
    $(document).ready(function () {
      $('pre').addClass('prettyprint  linenums');
      prettyPrint();
    })
  </script>



  <script  src="https://cdn.staticfile.org/typed.js/2.0.11/typed.min.js" ></script>
  <script>
    var typed = new Typed('#subtitle', {
      strings: [
        '  ',
        "XSS靶场--xss-labs&nbsp;",
      ],
      cursorChar: "_",
      typeSpeed: 70,
      loop: false,
    });
    typed.stop();
    $(document).ready(function () {
      $(".typed-cursor").addClass("h2");
      typed.start();
    });
  </script>



  <script  src="https://cdn.staticfile.org/anchor-js/4.2.2/anchor.min.js" ></script>
  <script>
    anchors.options = {
      placement: "right",
      visible: "hover",
      
    };
    var el = "h1,h2,h3,h4,h5,h6".split(",");
    var res = [];
    for (item of el) {
      res.push(".markdown-body > " + item)
    }
    anchors.add(res.join(", "))
  </script>



  <script  src="/js/local-search.js" ></script>
  <script>
    var path = "/local-search.xml";
    var inputArea = document.querySelector("#local-search-input");
    inputArea.onclick = function () {
      getSearchFile(path);
      this.onclick = null
    }
  </script>



  <script defer src="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.js" ></script>
  <script>
    $("#post img:not(.no-zoom img, img[no-zoom])").each(
      function () {
        var element = document.createElement("a");
        $(element).attr("data-fancybox", "images");
        $(element).attr("href", $(this).attr("src"));
        $(this).wrap(element);
      }
    );
  </script>












</body>
</html>
